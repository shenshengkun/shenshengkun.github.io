<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>舒宇的博客</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://shenshengkun.github.io/"/>
  <updated>2018-12-11T07:04:56.953Z</updated>
  <id>https://shenshengkun.github.io/</id>
  
  <author>
    <name>Shu Yu</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>jira-安装及破解</title>
    <link href="https://shenshengkun.github.io/2018/11/21/%E7%89%88%E6%9C%AC%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7/jira-%E5%AE%89%E8%A3%85%E5%8F%8A%E7%A0%B4%E8%A7%A3/"/>
    <id>https://shenshengkun.github.io/2018/11/21/版本管理工具/jira-安装及破解/</id>
    <published>2018-11-20T23:28:40.000Z</published>
    <updated>2018-12-11T07:04:56.953Z</updated>
    
    <content type="html"><![CDATA[<h1 id="安装jira"><a href="#安装jira" class="headerlink" title="安装jira"></a>安装jira</h1><p><img src="https://shenshengkun.github.io/images/jira1.png" alt=""></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">wget https://product-downloads.atlassian.com/software/jira/downloads/atlassian-jira-software-7.13.0-x64.bin</span><br><span class="line">[root@YZSJHL82-204 ~]# chmod +x atlassian-jira-software-7.13.0-x64.bin</span><br><span class="line">[root@YZSJHL82-204 ~]# ./atlassian-jira-software-7.13.0-x64.bin</span><br><span class="line">Unpacking JRE ...</span><br><span class="line">Starting Installer ...</span><br><span class="line">十月 23, 2018 4:38:25 下午 java.util.prefs.FileSystemPreferences$1 run</span><br><span class="line">信息: Created user preferences directory.</span><br><span class="line">十月 23, 2018 4:38:25 下午 java.util.prefs.FileSystemPreferences$2 run</span><br><span class="line">信息: Created system preferences directory in java.home.</span><br><span class="line">This will install JIRA Software 7.4.1 on your computer.</span><br><span class="line">OK [o, Enter], Cancel [c]</span><br><span class="line">o               #按o安装</span><br><span class="line">Choose the appropriate installation or upgrade option.</span><br><span class="line">Please choose one of the following:</span><br><span class="line">Express Install (use default settings) [1], Custom Install (recommended for advanced users) [2, Enter], Upgrade an existing JIRA installation [3]</span><br><span class="line">2               #2为自定义安装</span><br><span class="line">Where should JIRA Software be installed?</span><br><span class="line">[/opt/atlassian/jira]</span><br><span class="line">/usr/local/atlassina/jira       #自定义安装目录</span><br><span class="line">Default location for JIRA Software data</span><br><span class="line">[/var/atlassian/application-data/jira]</span><br><span class="line">/usr/local/atlassina/jira_data          #自定义数据目录</span><br><span class="line">Configure which ports JIRA Software will use.</span><br><span class="line">JIRA requires two TCP ports that are not being used by any other</span><br><span class="line">applications on this machine. The HTTP port is where you will access JIRA</span><br><span class="line">through your browser. The Control port is used to startup and shutdown JIRA.</span><br><span class="line">Use default ports (HTTP: 8080, Control: 8005) - Recommended [1, Enter], Set custom value for HTTP and Control ports [2]</span><br><span class="line">2               #2为自定义端口</span><br><span class="line">HTTP Port Number</span><br><span class="line">[8080]          #8080为默认端口</span><br><span class="line">8050            #http连接端口</span><br><span class="line">Control Port Number</span><br><span class="line">[8005]</span><br><span class="line">8040            #控制端口</span><br><span class="line">JIRA can be run in the background.</span><br><span class="line">You may choose to run JIRA as a service, which means it will start</span><br><span class="line">automatically whenever the computer restarts.</span><br><span class="line">Install JIRA as Service?</span><br><span class="line">Yes [y, Enter], No [n]</span><br><span class="line">y               #是否开机自启</span><br><span class="line">Details on where JIRA Software will be installed and the settings that will be used.</span><br><span class="line">Installation Directory: /usr/local/atlassina/jira </span><br><span class="line">Home Directory: /usr/local/atlassina/jira_data </span><br><span class="line">HTTP Port: 8050 </span><br><span class="line">RMI Port: 8040 </span><br><span class="line">Install as service: Yes </span><br><span class="line">Install [i, Enter], Exit [e]</span><br><span class="line">i               #确认已选配置</span><br><span class="line">Extracting files ...</span><br><span class="line">Please wait a few moments while JIRA Software is configured.</span><br><span class="line">Installation of JIRA Software 7.4.1 is complete</span><br><span class="line">Start JIRA Software 7.4.1 now?</span><br><span class="line">Yes [y, Enter], No [n]</span><br><span class="line">y               #启动</span><br><span class="line">Please wait a few moments while JIRA Software starts up.</span><br><span class="line">Launching JIRA Software ...</span><br><span class="line">Installation of JIRA Software 7.4.1 is complete</span><br><span class="line">Your installation of JIRA Software 7.4.1 is now ready and can be accessed</span><br><span class="line">via your browser.</span><br><span class="line">JIRA Software 7.4.1 can be accessed at http://localhost:8050</span><br><span class="line">Finishing installation ...</span><br></pre></td></tr></table></figure><p><img src="https://shenshengkun.github.io/images/jira2.png" alt=""></p><p>浏览器访问jira，地址为：<a href="http://IP:8050" target="_blank" rel="noopener">http://IP:8050</a> 请自行修改IP和端口。如果可以访问，说明安装成功。</p><p><img src="https://shenshengkun.github.io/images/jira3.png" alt=""></p><h1 id="配置数据库及密码"><a href="#配置数据库及密码" class="headerlink" title="配置数据库及密码"></a>配置数据库及密码</h1><p><img src="https://shenshengkun.github.io/images/jira4.png" alt=""><br>在mySQL上创建用户及库做授权<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">create database jira_new;</span><br><span class="line">grant all privileges on *.* to jira@&apos;10.4.82.204&apos; identified by &apos;jira&apos;;</span><br><span class="line">flush privileges;</span><br></pre></td></tr></table></figure></p><p>在授权完用户我们不可以马上填写信息，需要添加MySQL的一个jra包，否则下一步会提示找不到mysql的驱动</p><p>wget <a href="https://dev.mysql.com/get/Downloads/Connector-J/mysql-connector-java-5.1.46.zip" target="_blank" rel="noopener">https://dev.mysql.com/get/Downloads/Connector-J/mysql-connector-java-5.1.46.zip</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">停止jira</span><br><span class="line">[root@YZSJHL82-204 ~]# /etc/init.d/jira stop</span><br><span class="line">上传软件包</span><br><span class="line">[root@YZSJHL82-204 ~]# cp mysql-connector-java-5.1.46-bin.jar /opt/atlassian/jira/atlassian-jira/WEB-INF/lib/</span><br><span class="line">启动jira</span><br><span class="line">[root@YZSJHL82-204 ~]# /etc/init.d/jira start</span><br><span class="line">注意防火墙</span><br></pre></td></tr></table></figure></p><p>安装完数据库插件即可下一步:</p><p><img src="https://shenshengkun.github.io/images/jira5.png" alt=""></p><h1 id="设置jira主题"><a href="#设置jira主题" class="headerlink" title="设置jira主题"></a>设置jira主题</h1><p><img src="https://shenshengkun.github.io/images/jira6.png" alt=""> </p><p>因为第一次安装，我们需要去jira官网注册用户，获取授权码 (免费30天，安装后更换破解即可) </p><p><img src="https://shenshengkun.github.io/images/jira7.png" alt=""></p><p>保存好服务器ID，进入atlassian官网获取试用许可证，下边附上注册地址： </p><p>注册官网：<a href="https://my.atlassian.com" target="_blank" rel="noopener">https://my.atlassian.com</a> </p><p>或使用以下地址： </p><p><a href="https://id.atlassian.com/signup?application=mac&amp;continue=https://my.atlassian.com" target="_blank" rel="noopener">https://id.atlassian.com/signup?application=mac&amp;continue=https://my.atlassian.com</a> </p><p>登陆账号后，选择New Evaluation License</p><p><img src="https://shenshengkun.github.io/images/jira8.png" alt=""> </p><h1 id="设置管理员用户"><a href="#设置管理员用户" class="headerlink" title="设置管理员用户:"></a>设置管理员用户:</h1><p><img src="https://shenshengkun.github.io/images/jira9.png" alt=""><br>官网注册的账号只可以免费试用30天，所以当我们安装完需要尽快进行破解<br><img src="https://shenshengkun.github.io/images/jira10.png" alt=""></p><p><img src="https://shenshengkun.github.io/images/jira11.png" alt=""></p><h1 id="破解jira"><a href="#破解jira" class="headerlink" title="破解jira"></a>破解jira</h1><p><a href="https://download.csdn.net/download/lbwahoo/10030807" target="_blank" rel="noopener">https://download.csdn.net/download/lbwahoo/10030807</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">停止jira</span><br><span class="line">[root@YZSJHL82-204 ~]# /etc/init.d/jira stop</span><br><span class="line">进入安装目录下的atlassian-jira/WEB-INF/lib/目录下，用破解包atlassian-extras-3.2.jar替换原来的包。并将mysql连接驱动复制到此目录下。</span><br><span class="line">[root@YZSJHL82-204 ~]# cp atlassian-extras-3.2.jar /opt/atlassian/jira/atlassian-jira/WEB-INF/lib/</span><br><span class="line">启动jira</span><br><span class="line">[root@YZSJHL82-204 ~]# /etc/init.d/jira start</span><br><span class="line">注意防火墙</span><br></pre></td></tr></table></figure></p><p><img src="https://shenshengkun.github.io/images/jira12.png" alt=""></p><h1 id="配置数据库连接地址"><a href="#配置数据库连接地址" class="headerlink" title="配置数据库连接地址"></a>配置数据库连接地址</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/var/atlassian/application-data/jira/dbconfig.xml</span><br><span class="line">#此路径为默认路径</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;安装jira&quot;&gt;&lt;a href=&quot;#安装jira&quot; class=&quot;headerlink&quot; title=&quot;安装jira&quot;&gt;&lt;/a&gt;安装jira&lt;/h1&gt;&lt;p&gt;&lt;img src=&quot;https://shenshengkun.github.io/images/jira1.
      
    
    </summary>
    
      <category term="版本管理工具" scheme="https://shenshengkun.github.io/categories/%E7%89%88%E6%9C%AC%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7/"/>
    
    
  </entry>
  
  <entry>
    <title>k8s基本命令</title>
    <link href="https://shenshengkun.github.io/2018/05/10/k8s/k8s%E5%9F%BA%E6%9C%AC%E5%91%BD%E4%BB%A4/"/>
    <id>https://shenshengkun.github.io/2018/05/10/k8s/k8s基本命令/</id>
    <published>2018-05-10T02:10:01.000Z</published>
    <updated>2018-11-28T07:12:16.277Z</updated>
    
    <content type="html"><![CDATA[<h1 id="pods"><a href="#pods" class="headerlink" title="pods"></a>pods</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ kubectl get pods -n pro</span><br><span class="line">$ kubectl get pods --all-namespaces -n pro</span><br><span class="line">$ kubectl get pod aa -o wide -n pro</span><br><span class="line">$ kubectl get pod aa -o yaml -n pro</span><br><span class="line">$ kubectl describe pod aa -n pro</span><br></pre></td></tr></table></figure><h2 id="POD升级和历史"><a href="#POD升级和历史" class="headerlink" title="POD升级和历史"></a>POD升级和历史</h2><p>列出部署历史记录<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ kubectl rollout history deployment/DEPLOYMENT_NAME</span><br></pre></td></tr></table></figure></p><p>跳转到特定修订版<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ kubectl rollout undo deployment/DEPLOYMENT_NAME --to-revision=N</span><br></pre></td></tr></table></figure></p><h1 id="service"><a href="#service" class="headerlink" title="service"></a>service</h1><p>查看服务<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ kubectl get services</span><br></pre></td></tr></table></figure></p><p>将POD作为服务公开（创建端点）<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ kubectl expose deployment/aa --port=2000 --type=NodePort</span><br></pre></td></tr></table></figure></p><h1 id="login"><a href="#login" class="headerlink" title="login"></a>login</h1><p>$ kubectl exec -ti $1 bash -n product</p><h1 id="log"><a href="#log" class="headerlink" title="log"></a>log</h1><p>$ kubectl logs -f $1 -n product </p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;pods&quot;&gt;&lt;a href=&quot;#pods&quot; class=&quot;headerlink&quot; title=&quot;pods&quot;&gt;&lt;/a&gt;pods&lt;/h1&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pr
      
    
    </summary>
    
      <category term="k8s" scheme="https://shenshengkun.github.io/categories/k8s/"/>
    
    
  </entry>
  
  <entry>
    <title>gitlab-ci自动部署（二）</title>
    <link href="https://shenshengkun.github.io/2017/05/21/gitlab/gitlab-ci(%E4%BA%8C)/"/>
    <id>https://shenshengkun.github.io/2017/05/21/gitlab/gitlab-ci(二)/</id>
    <published>2017-05-21T01:10:30.000Z</published>
    <updated>2018-11-08T06:42:03.702Z</updated>
    
    <content type="html"><![CDATA[<p>下面来说说CI/CD是怎么实现的：</p><h1 id="登录gitlab-runner机器"><a href="#登录gitlab-runner机器" class="headerlink" title="登录gitlab-runner机器"></a>登录gitlab-runner机器</h1><p>切换runner普通用户</p><blockquote><p>[root@localhost ~]# su - gitlab-runner</p></blockquote><h1 id="编写-gitlab-ci-yml文件"><a href="#编写-gitlab-ci-yml文件" class="headerlink" title="编写.gitlab-ci.yml文件"></a>编写.gitlab-ci.yml文件</h1><p>随便创建一个目录，叫什么无所谓</p><blockquote><p>[gitlab-runner@localhost ~]$ mkdir git</p></blockquote><p>将gitlab上想要发布的项目克隆到这个目录里</p><blockquote><p>[gitlab-runner@localhost git]$ git clone <a href="mailto:git@gitlab.xxx.com" target="_blank" rel="noopener">git@gitlab.xxx.com</a>:xxx/xxx.git</p></blockquote><p>因为我们的项目是大工程，里面带着很多子工程，所以就需要通过yml文件，将项目分离出去</p><p>比方说我们想发布bb项目，但是bb项目属于aa这个大项目的子项目，所以就进aa大工程目录下</p><p>在项目目录里面创建一个.gitlab-ci.yml文件，如下<br><img src="https://shenshengkun.github.io/images/2.png" alt=""></p><blockquote><p>[gitlab-runner@localhost ~]$ cat .gitlab-ci.yml<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">job 1:</span><br><span class="line">  stage: test</span><br><span class="line">  script: </span><br><span class="line">    - git subtree push -q --prefix=bb git@gitlab.xx.com:bb1/bb.git dev</span><br><span class="line">  only:</span><br><span class="line">    - dev</span><br><span class="line">  tags:</span><br><span class="line">    - shell</span><br></pre></td></tr></table></figure></p></blockquote><p>这样就可以将bb项目分离出去，相当于创建了一个新的项目</p><p>进入bb目录，也编写.gitlab-ci.yml文件，这个就是我们需要编译的脚本，中间可以穿插maven、node和shell的一系列命令</p><blockquote><p>[gitlab-runner@localhost bb]$ cat .gitlab-ci.yml<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">job 1:</span><br><span class="line">  stage: build</span><br><span class="line">  script: </span><br><span class="line">    - rm -rf /opt/M2_REPO/com/bb/*</span><br><span class="line">    - mvn clean package -P test -Dmaven.test.skip</span><br><span class="line">    - bash -x /opt/bb/shell/bb.sh</span><br><span class="line">  only:</span><br><span class="line">    - dev</span><br><span class="line">  tags:</span><br><span class="line">    - shell</span><br></pre></td></tr></table></figure></p></blockquote><p>编写完yml文件后都需要提交下</p><p>git add .</p><p>git commit -m “add gitlab-ci.yml”</p><p>git push origin dev</p><p>另外包括传包，启动等命令都可以在yml文件里面体现，这样只要dev分支有commit的改变了，gitlab-ci就会自动创建job来自动发布<br><img src="https://shenshengkun.github.io/images/3.png" alt=""></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;下面来说说CI/CD是怎么实现的：&lt;/p&gt;
&lt;h1 id=&quot;登录gitlab-runner机器&quot;&gt;&lt;a href=&quot;#登录gitlab-runner机器&quot; class=&quot;headerlink&quot; title=&quot;登录gitlab-runner机器&quot;&gt;&lt;/a&gt;登录gitlab-r
      
    
    </summary>
    
      <category term="gitlab" scheme="https://shenshengkun.github.io/categories/gitlab/"/>
    
    
  </entry>
  
  <entry>
    <title>gitlab-ci自动部署（一）</title>
    <link href="https://shenshengkun.github.io/2017/05/20/gitlab/gitlab-ci(%E4%B8%80)/"/>
    <id>https://shenshengkun.github.io/2017/05/20/gitlab/gitlab-ci(一)/</id>
    <published>2017-05-20T01:05:08.000Z</published>
    <updated>2018-11-08T06:26:44.106Z</updated>
    
    <content type="html"><![CDATA[<p>目前GitLab已经有了CI功能，即持续集成的功能。可以实现代码提交后自动测试、编译、发布、部署等自动化工作</p><p>下面是我总结的实现内容：</p><h1 id="安装runner"><a href="#安装runner" class="headerlink" title="安装runner"></a>安装runner</h1><p>在root下执行</p><h3 id="下载gitlab-runner"><a href="#下载gitlab-runner" class="headerlink" title="下载gitlab-runner"></a>下载gitlab-runner</h3><blockquote><p>wget <a href="https://mirrors.tuna.tsinghua.edu.cn/gitlab-runner/yum/el7/gitlab-runner-10.5.0-1.x86_64.rpm" target="_blank" rel="noopener">https://mirrors.tuna.tsinghua.edu.cn/gitlab-runner/yum/el7/gitlab-runner-10.5.0-1.x86_64.rpm</a></p></blockquote><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><blockquote><p>rpm -ivh gitlab-runner-10.5.0-1.x86_64.rpm</p></blockquote><h3 id="配置Runner"><a href="#配置Runner" class="headerlink" title="配置Runner"></a>配置Runner</h3><p>默认情况，Runner是通过gitlab-runner的这个用户来执行一系列操作，其工作目录也是在gitlab-runner的用户目录下面。如果使用默认gitlab-runner用户操作一些文件时经常会遇到权限问题，就需要给gitlab-runner赋权。我们通过以下方式修改。</p><p>#在root下执行</p><p>#删除服务</p><blockquote><p>gitlab-runner uninstall</p></blockquote><p>#添加服务</p><blockquote><p>gitlab-runner install –working-directory /home/builds –user gitlab-ci</p></blockquote><p>#重启服务</p><blockquote><p>gitlab-runner restart</p></blockquote><p>#查看状态</p><blockquote><p>gitlab-runner status 输出：gitlab-runner: Service is running!</p></blockquote><p>#查看是否生效</p><blockquote><p>ps -ef | grep gitlab-runner</p></blockquote><h1 id="注册Runner"><a href="#注册Runner" class="headerlink" title="注册Runner"></a>注册Runner</h1><p>先打开GitLab上需要自动部署的项目界面，找到该项目的Settings –&gt; CI/CD –&gt; Runners settings 在gitlab上可以看到自己的token信息，用来注册runner</p><p>#在root下执行<br>gitlab-runner register (会出现注册信息，填url，token，runner的名字)</p><p>成功之后会如下图：<br><img src="https://shenshengkun.github.io/images/1.png" alt=""></p><p>至此安装部分就完成了</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;目前GitLab已经有了CI功能，即持续集成的功能。可以实现代码提交后自动测试、编译、发布、部署等自动化工作&lt;/p&gt;
&lt;p&gt;下面是我总结的实现内容：&lt;/p&gt;
&lt;h1 id=&quot;安装runner&quot;&gt;&lt;a href=&quot;#安装runner&quot; class=&quot;headerlink&quot; t
      
    
    </summary>
    
      <category term="gitlab" scheme="https://shenshengkun.github.io/categories/gitlab/"/>
    
    
  </entry>
  
  <entry>
    <title>centos7搭建shadowsock实现vpn翻墙</title>
    <link href="https://shenshengkun.github.io/2017/04/22/vpn/centos7%E6%90%AD%E5%BB%BAshadowsock%E5%AE%9E%E7%8E%B0vpn%E7%BF%BB%E5%A2%99/"/>
    <id>https://shenshengkun.github.io/2017/04/22/vpn/centos7搭建shadowsock实现vpn翻墙/</id>
    <published>2017-04-22T12:10:20.000Z</published>
    <updated>2018-11-08T02:59:07.077Z</updated>
    
    <content type="html"><![CDATA[<h1 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h1><p>使用root用户登录，运行以下命令：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">wget --no-check-certificate -O shadowsocks.sh https://cyh.abcdocker.com/vpn/shadowsocks.sh</span><br><span class="line">  chmod +x shadowsocks.sh</span><br><span class="line">  ./shadowsocks.sh 2&gt;&amp;1 | tee shadowsocks.log</span><br></pre></td></tr></table></figure></p><p>安装完成后，脚本提示如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"> Congratulations, Shadowsocks-python server install completed!</span><br><span class="line">Your Server IP        :your_server_ip</span><br><span class="line">Your Server Port      :your_server_port</span><br><span class="line">Your Password         :your_password</span><br><span class="line">Your Encryption Method:your_encryption_method</span><br><span class="line">Welcome to visit:https://teddysun.com/342.html</span><br><span class="line">Enjoy it!</span><br></pre></td></tr></table></figure><h1 id="卸载方法"><a href="#卸载方法" class="headerlink" title="卸载方法"></a>卸载方法</h1><p>使用root用户登录，运行以下命令：</p><blockquote><p>./shadowsocks.sh uninstall</p></blockquote><p>配置文件路径：/etc/shadowsocks.json</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;server&quot;:&quot;0.0.0.0&quot;,</span><br><span class="line">    &quot;server_port&quot;:your_server_port,</span><br><span class="line">    &quot;local_address&quot;:&quot;127.0.0.1&quot;,</span><br><span class="line">    &quot;local_port&quot;:1080,</span><br><span class="line">    &quot;password&quot;:&quot;your_password&quot;,</span><br><span class="line">    &quot;timeout&quot;:300,</span><br><span class="line">    &quot;method&quot;:&quot;your_encryption_method&quot;,</span><br><span class="line">    &quot;fast_open&quot;: false</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="多用户多端口配置文件"><a href="#多用户多端口配置文件" class="headerlink" title="多用户多端口配置文件"></a>多用户多端口配置文件</h1><p>配置文件路径：/etc/shadowsocks.json</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"> &#123;</span><br><span class="line">    &quot;server&quot;:&quot;0.0.0.0&quot;,</span><br><span class="line">    &quot;local_address&quot;:&quot;127.0.0.1&quot;,</span><br><span class="line">    &quot;local_port&quot;:1080,</span><br><span class="line">    &quot;port_password&quot;:&#123;</span><br><span class="line">         &quot;8989&quot;:&quot;password0&quot;,</span><br><span class="line">         &quot;9001&quot;:&quot;password1&quot;,</span><br><span class="line">         &quot;9002&quot;:&quot;password2&quot;,</span><br><span class="line">         &quot;9003&quot;:&quot;password3&quot;,</span><br><span class="line">         &quot;9004&quot;:&quot;password4&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;timeout&quot;:300,</span><br><span class="line">    &quot;method&quot;:&quot;your_encryption_method&quot;,</span><br><span class="line">    &quot;fast_open&quot;: false</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">启动：/etc/init.d/shadowsocks start</span><br><span class="line">停止：/etc/init.d/shadowsocks stop</span><br><span class="line">重启：/etc/init.d/shadowsocks restart</span><br><span class="line">状态：/etc/init.d/shadowsocks status</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;安装&quot;&gt;&lt;a href=&quot;#安装&quot; class=&quot;headerlink&quot; title=&quot;安装&quot;&gt;&lt;/a&gt;安装&lt;/h1&gt;&lt;p&gt;使用root用户登录，运行以下命令：&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td c
      
    
    </summary>
    
      <category term="vpn" scheme="https://shenshengkun.github.io/categories/vpn/"/>
    
    
  </entry>
  
  <entry>
    <title>pptp</title>
    <link href="https://shenshengkun.github.io/2017/04/20/vpn/pptp/"/>
    <id>https://shenshengkun.github.io/2017/04/20/vpn/pptp/</id>
    <published>2017-04-20T05:10:01.000Z</published>
    <updated>2018-11-07T05:58:16.356Z</updated>
    
    <content type="html"><![CDATA[<h1 id="安装pptpd"><a href="#安装pptpd" class="headerlink" title="安装pptpd"></a>安装pptpd</h1><p>$ yum install pptpd </p><h1 id="配置本地及远程IP地址"><a href="#配置本地及远程IP地址" class="headerlink" title="配置本地及远程IP地址"></a>配置本地及远程IP地址</h1><p>$ vi /etc/pptpd.conf<br>  localip 192.168.100.1<br>  remoteip 192.168.100.2-245 </p><h1 id="配置DNS"><a href="#配置DNS" class="headerlink" title="配置DNS"></a>配置DNS</h1><p>$ vi /etc/ppp/options.pptpd<br>  ms-dns 223.5.5.5<br>  ms-dns 223.6.6.6 </p><h1 id="修改MTU"><a href="#修改MTU" class="headerlink" title="修改MTU"></a>修改MTU</h1><p>$ vi / etc / ppp / ip-up<br>  /sbin/ifconfig $ 1 mtu 1500 </p><h1 id="用户和密码配置"><a href="#用户和密码配置" class="headerlink" title="用户和密码配置"></a>用户和密码配置</h1><p>$ vi /etc/ppp/chap-secrets<br> client server secret IP address 注释掉 </p><p> testin_user1 pptpd testin_user1 * </p><h1 id="配置防火墙"><a href="#配置防火墙" class="headerlink" title="配置防火墙"></a>配置防火墙</h1><p>$ vi /etc/sysctl.conf </p><p>  net.ipv4.ip_forward = 1＃开启IP转发</p><p>$ iptables -t nat -A POSTROUTING -s 192.168.100.0/24 -o eth1 -j MASQUERADE＃允许外网连接</p><h1 id="开启服务"><a href="#开启服务" class="headerlink" title="开启服务"></a>开启服务</h1><p>$ service pptpd start </p><p>$ service iptables start</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;安装pptpd&quot;&gt;&lt;a href=&quot;#安装pptpd&quot; class=&quot;headerlink&quot; title=&quot;安装pptpd&quot;&gt;&lt;/a&gt;安装pptpd&lt;/h1&gt;&lt;p&gt;$ yum install pptpd &lt;/p&gt;
&lt;h1 id=&quot;配置本地及远程IP地址&quot;&gt;&lt;a h
      
    
    </summary>
    
      <category term="vpn" scheme="https://shenshengkun.github.io/categories/vpn/"/>
    
    
  </entry>
  
  <entry>
    <title>redmine</title>
    <link href="https://shenshengkun.github.io/2017/03/21/%E7%89%88%E6%9C%AC%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7/redmine/"/>
    <id>https://shenshengkun.github.io/2017/03/21/版本管理工具/redmine/</id>
    <published>2017-03-21T10:20:44.000Z</published>
    <updated>2018-11-07T06:13:25.101Z</updated>
    
    <content type="html"><![CDATA[<p>版本： redmine 3.1.1<br>官方文档地址： <a href="http://www.redmine.org.cn/category/install" target="_blank" rel="noopener">http://www.redmine.org.cn/category/install</a></p><p>Redmine实战<br>下列描述均以操作系统 Centos7 为例部署。</p><h1 id="环境介绍"><a href="#环境介绍" class="headerlink" title="环境介绍"></a>环境介绍</h1><p>OS    IP    HostName    Role<br>CentOS7 x64    192.168.10.10    node1    Redmine恢复机器<br>CentOS7 x64    10.10.1.17    localhost    Redmine机器</p><h1 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h1><p>关闭Iptables和SELinux<br>[root@node1 ~]# systemctl stop firewalld<br>[root@node1 ~]# systemctl disable firewalld<br>[root@node1 ~]# setenforce 0<br>[root@node1 ~]# sed -i ‘/^SELINUX=/{ s/enforcing/disabled/ }’ /etc/selinux/config</p><p>调整服务器时间<br>[root@node1 ~]# yum -y install ntp<br>[root@node1 ~]# ntpdate -u 202.120.2.101</p><h1 id="安装配置-Redmine"><a href="#安装配置-Redmine" class="headerlink" title="安装配置 Redmine"></a>安装配置 Redmine</h1><p>安装依赖环境<br>[root@node1 ~]# yum install -y zlib-devel openssl-devel ImageMagick-devel wget curl-devel rubygems mod_fcgid</p><p>安装RVM<br>[root@node1 ~]# gpg –keyserver hkp://keys.gnupg.net –recv-keys 409B6B1796C275462A1703113804BB82D39DC0E3<br>[root@node1 ~]# curl -L <a href="https://get.rvm.io" target="_blank" rel="noopener">https://get.rvm.io</a> | bash -s stable</p><p>载入RVM环境并获取需要的支持安装包<br>[root@node1 ~]# source /etc/profile.d/rvm.sh<br>[root@node1 ~]# rvm requirements</p><p>利用rvm安装 Ruby 2.2.3 并设为默认<br>[root@node1 ~]# sed -i -E ‘s!https?://cache.ruby-lang.org/pub/ruby!<a href="https://ruby.taobao.org/mirrors/ruby!&#39;" target="_blank" rel="noopener">https://ruby.taobao.org/mirrors/ruby!&#39;</a> /usr/local/rvm/config/db<br>[root@node1 ~]# rvm gemset create<br>[root@node1 ~]# rvm install 2.2.3<br>[root@node1 ~]# rvm use 2.2.3 –default</p><p>添加淘宝镜像<br>[root@node1 ~]# gem sources –add <a href="https://gems.ruby-china.org/" target="_blank" rel="noopener">https://gems.ruby-china.org/</a> –remove <a href="https://rubygems.org/" target="_blank" rel="noopener">https://rubygems.org/</a><br>[root@node1 ~]# gem sources -l<br><strong><em> CURRENT SOURCES </em></strong></p><p><a href="https://gems.ruby-china.org" target="_blank" rel="noopener">https://gems.ruby-china.org</a></p><p>安装rails<br>[root@node1 ~]# gem install rails -v=4.2</p><p>安装mysql和httpd<br>[root@node1 ~]# yum install httpd httpd-devel -y</p><p>[root@node1 ~]# wget <a href="http://dev.mysql.com/get/mysql-community-release-el7-5.noarch.rpm" target="_blank" rel="noopener">http://dev.mysql.com/get/mysql-community-release-el7-5.noarch.rpm</a><br>[root@node1 ~]# rpm -ivh mysql-community-release-el7-5.noarch.rpm<br>[root@node1 ~]# yum -y install mysql-community-server mysql-devel<br>[root@node1 ~]# service mysqld restart<br>[root@node1 ~]# mysql -u root<br>mysql&gt; create database redmine character set utf8;<br>mysql&gt; create user ‘redmine‘@’localhost’ identified by ‘redmine’;<br>mysql&gt; grant all privileges on redmine.* to ‘redmine‘@’localhost’;</p><p>安装redmine的apache支持，这样可以通过apache访问<br>[root@node1 ~]# gem install passenger<br>[root@node1 ~]# passenger-install-apache2-module</p><p>[root@node1 ~]# vim /etc/httpd/conf.d/passenger.conf<br>LoadModule passenger_module /usr/local/rvm/gems/ruby-2.2.3/gems/passenger-5.0.30/buildout/apache2/mod_passenger.so<br>   <ifmodule mod_passenger.c=""><br>     PassengerRoot /usr/local/rvm/gems/ruby-2.2.3/gems/passenger-5.0.30<br>     PassengerDefaultRuby /usr/local/rvm/gems/ruby-2.2.3/wrappers/ruby<br>   </ifmodule></p><p>[root@node1 ~]# vim /etc/httpd/conf.d/redmine.conf</p><virtualhost *:80=""><br>      ServerName <a href="http://www.a.com" target="_blank" rel="noopener">www.a.com</a><br>      # !!! Be sure to point DocumentRoot to ‘public’!<br>      DocumentRoot /var/www/html/redmine/public<br>      ErrorLog logs/redmine_error_log<br>      &lt;Directory /var/www/html/redmine/public&gt;<br>        Options Indexes ExecCGI FollowSymLinks<br>        Order allow,deny<br>        Allow from all<br>        # This relaxes Apache security settings.<br>        AllowOverride all<br>        # MultiViews must be turned off.<br>        Options -MultiViews<br>        # Uncomment this if you’re on Apache &gt;= 2.4:<br>        #Require all granted<br>      <br>  </virtualhost><p>安装redmine<br>[root@node1 ~]# cd /var/www/html<br>[root@node1 ~]# wget <a href="http://www.redmine.org/releases/redmine-3.1.1.tar.gz" target="_blank" rel="noopener">http://www.redmine.org/releases/redmine-3.1.1.tar.gz</a><br>[root@node1 ~]# tar -zxvf redmine-3.1.1.tar.gz<br>[root@node1 ~]# mv redmine-3.1.1 redmine<br>[root@node1 ~]# cd /var/www/html/redmine/</p><p>[root@node1 ~]# vim Gemfile  # 修改source<br>source ‘<a href="https://rubygems.org&#39;" target="_blank" rel="noopener">https://rubygems.org&#39;</a> （注释掉）<br>source’<a href="https://ruby.taobao.org&#39;" target="_blank" rel="noopener">https://ruby.taobao.org&#39;</a></p><p>[root@node1 ~]# cp config/configuration.yml.example config/configuration.yml<br>[root@node1 ~]# cp config/database.yml.example config/database.yml<br>[root@node1 ~]# vim config/database.yml  # 修改数据连接<br>production:<br>  adapter: mysql2<br>  database: redmine<br>  host: localhost<br>  username: redmine<br>  password: “redmine”<br>  encoding: utf8</p><p>[root@node1 redmine]# gem install bundler  # 注意是在网站根目录下执行<br>[root@node1 redmine]# gem install rack-cache -v ‘1.4.2’<br>[root@node1 redmine]# bundle install</p><p>为Rails生成cookies密钥<br>[root@node1 redmine]# rake generate_secret_token</p><p>初始化redmine数据库表名<br>[root@node1 redmine]# RAILS_ENV=production rake db:migrate<br>[root@node1 redmine]# RAILS_ENV=production rake redmine:load_default_data</p><p>启动<br>[root@node1 ~]# cd /var/www/html/redmine<br>[root@node1 redmine]# mkdir /var/www/html/logs<br>[root@node1 redmine]# bundle exec rails server webrick -e production -b 0.0.0.0 &amp;&gt;&gt; /var/www/html/logs/redmine.log &amp;<br>访问地址：<a href="http://IP:3000" target="_blank" rel="noopener">http://IP:3000</a></p><h1 id="备份"><a href="#备份" class="headerlink" title="备份"></a>备份</h1><p>[root@node1 ~]# mysqldump -u root redmine &gt; /root/redmine.sql</p><h1 id="恢复"><a href="#恢复" class="headerlink" title="恢复"></a>恢复</h1><p>停止redmine， 步骤：ps -ef | grep rails，找到redmine的进程号，然后kill掉</p><p>恢复数据库<br>[root@node1 ~]# mysql -u redmine -p redmine &lt; /root/redmine.sql</p><p>把10.10.2.120上的/backup/redmine-back/redmine_file目录下的所有文件拷贝到192.168.100.10中的/var/www/html/redmine/files目录<br>[root@node1 ~]# scp -r <a href="mailto:root@10.10.2.120" target="_blank" rel="noopener">root@10.10.2.120</a>:/backup/redmine-back/redmine_file/* /var/www/html/redmine/files<br>[root@node1 ~]# chmod -R 755 /var/www/html/redmine/files</p><p>启动redmine<br>[root@node1 redmine]# bundle exec rails server webrick -e production -b 0.0.0.0 &amp;&gt;&gt; /var/www/html/logs/redmine.log &amp;</p><h1 id="调整配置"><a href="#调整配置" class="headerlink" title="调整配置"></a>调整配置</h1><p>配置邮件发送，空格缩进必须如下，不然redmine无法启动<br>[root@node1 ~]# vim /var/www/html/redmine/config/configuration.yml<br>default:<br>  email_delivery:<br>    delivery_method: :smtp<br>    smtp_settings:<br>      openssl_verify_mode: ‘none’<br>      address: mail.testin.cn<br>      port: 587<br>      domain: testin.cn<br>      authentication: :login<br>      user_name: “<a href="mailto:project@testin.cn" target="_blank" rel="noopener">project@testin.cn</a>“<br>      password: “m12345678”</p><p>重启redmine即可</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;版本： redmine 3.1.1&lt;br&gt;官方文档地址： &lt;a href=&quot;http://www.redmine.org.cn/category/install&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;http://www.redmine.org.c
      
    
    </summary>
    
      <category term="版本管理工具" scheme="https://shenshengkun.github.io/categories/%E7%89%88%E6%9C%AC%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7/"/>
    
    
  </entry>
  
  <entry>
    <title>centos6.4安装kvm</title>
    <link href="https://shenshengkun.github.io/2017/03/20/%E8%99%9A%E6%8B%9F%E5%8C%96/centos6.4%E5%AE%89%E8%A3%85kvm/"/>
    <id>https://shenshengkun.github.io/2017/03/20/虚拟化/centos6.4安装kvm/</id>
    <published>2017-03-20T09:20:50.000Z</published>
    <updated>2018-11-07T08:50:37.905Z</updated>
    
    <content type="html"><![CDATA[<p>首先检查您的CPU是否支持硬件虚拟化</p><p>egrep ‘(vmx|svm)’ –color=always /proc/cpuinfo</p><p>应该显示一些东西，例如：</p><p>[root@server1 ~]# egrep ‘(vmx|svm)’ –color=always /proc/cpuinfo<br>flags           : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush mmx fxsr sse sse2 ht syscall<br> nx mmxext fxsr_opt rdtscp lm 3dnowext 3dnow pni cx16 lahf_lm cmp_legacy svm extapic cr8_legacy misalignsse<br>flags           : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush mmx fxsr sse sse2 ht syscall<br> nx mmxext fxsr_opt rdtscp lm 3dnowext 3dnow pni cx16 lahf_lm cmp_legacy svm extapic cr8_legacy misalignsse<br>[root@server1 ~]#</p><p>现在我们导入软件包的GPG密钥：</p><p>rpm–import /etc/pki/rpm-gpg/RPM-GPG-KEY*</p><p>yum install kvm libvirt python-virtinst qemu-kvm</p><p>/etc/init.d/libvirtd start</p><p>virsh -c qemu:///system list</p><p>导入镜像文件</p><p>xterm-253-1.el6.x86_64.rpm</p><p>之后xmanager开始kvm就可以了</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;首先检查您的CPU是否支持硬件虚拟化&lt;/p&gt;
&lt;p&gt;egrep ‘(vmx|svm)’ –color=always /proc/cpuinfo&lt;/p&gt;
&lt;p&gt;应该显示一些东西，例如：&lt;/p&gt;
&lt;p&gt;[root@server1 ~]# egrep ‘(vmx|svm)’ –c
      
    
    </summary>
    
      <category term="虚拟化" scheme="https://shenshengkun.github.io/categories/%E8%99%9A%E6%8B%9F%E5%8C%96/"/>
    
    
  </entry>
  
</feed>
