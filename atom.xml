<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>舒宇的博客</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://shenshengkun.github.io/"/>
  <updated>2019-08-08T05:40:21.206Z</updated>
  <id>https://shenshengkun.github.io/</id>
  
  <author>
    <name>Shu Yu</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>k8s设置LXCFS</title>
    <link href="https://shenshengkun.github.io/posts/dd6348aa.html"/>
    <id>https://shenshengkun.github.io/posts/dd6348aa.html</id>
    <published>2019-08-07T02:20:01.000Z</published>
    <updated>2019-08-08T05:40:21.206Z</updated>
    
    <content type="html"><![CDATA[<h1 id="LXCFS简介"><a href="#LXCFS简介" class="headerlink" title="LXCFS简介"></a>LXCFS简介</h1><p>社区中常见的做法是利用lxcfs来提供容器中的资源可见性。lxcfs 是一个开源的FUSE（用户态文件系统）实现来支持LXC容器，它也可以支持Docker容器。</p><p>LXCFS通过用户态文件系统，在容器中提供下列 <code>procfs</code> 的文件。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">/proc/cpuinfo</span><br><span class="line">/proc/diskstats</span><br><span class="line">/proc/meminfo</span><br><span class="line">/proc/stat</span><br><span class="line">/proc/swaps</span><br><span class="line">/proc/uptime</span><br></pre></td></tr></table></figure><p> 比如，把宿主机的 <code>/var/lib/lxcfs/proc/memoinfo</code> 文件挂载到Docker容器的<code>/proc/meminfo</code>位置后。容器中进程读取相应文件内容时，LXCFS的FUSE实现会从容器对应的Cgroup中读取正确的内存限制。从而使得应用获得正确的资源约束设定。 </p><h1 id="Docker环境下LXCFS使用"><a href="#Docker环境下LXCFS使用" class="headerlink" title="Docker环境下LXCFS使用"></a>Docker环境下LXCFS使用</h1><p>安装 lxcfs 的RPM包</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget https://copr-be.cloud.fedoraproject.org/results/ganto/lxd/epel-7-x86_64/00486278-lxcfs/lxcfs-2.0.5-3.el7.centos.x86_64.rpm</span><br><span class="line">yum install lxcfs-2.0.5-3.el7.centos.x86_64.rpm</span><br></pre></td></tr></table></figure><p>启动 lxcfs</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lxcfs /var/lib/lxcfs &amp;</span><br></pre></td></tr></table></figure><p>测试</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">docker run -it -m 256m \</span><br><span class="line">      -v /var/lib/lxcfs/proc/cpuinfo:/proc/cpuinfo:rw \</span><br><span class="line">      -v /var/lib/lxcfs/proc/diskstats:/proc/diskstats:rw \</span><br><span class="line">      -v /var/lib/lxcfs/proc/meminfo:/proc/meminfo:rw \</span><br><span class="line">      -v /var/lib/lxcfs/proc/stat:/proc/stat:rw \</span><br><span class="line">      -v /var/lib/lxcfs/proc/swaps:/proc/swaps:rw \</span><br><span class="line">      -v /var/lib/lxcfs/proc/uptime:/proc/uptime:rw \</span><br><span class="line">      ubuntu:16.04 /bin/bash</span><br></pre></td></tr></table></figure><p> 结果</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@node1 ~]# docker run -it -m 256m \</span><br><span class="line">&gt;       -v /var/lib/lxcfs/proc/cpuinfo:/proc/cpuinfo:rw \</span><br><span class="line">&gt;       -v /var/lib/lxcfs/proc/diskstats:/proc/diskstats:rw \</span><br><span class="line">&gt;       -v /var/lib/lxcfs/proc/meminfo:/proc/meminfo:rw \</span><br><span class="line">&gt;       -v /var/lib/lxcfs/proc/stat:/proc/stat:rw \</span><br><span class="line">&gt;       -v /var/lib/lxcfs/proc/swaps:/proc/swaps:rw \</span><br><span class="line">&gt;       -v /var/lib/lxcfs/proc/uptime:/proc/uptime:rw \</span><br><span class="line">&gt;       ubuntu:16.04 /bin/bash</span><br><span class="line">root@6bcd804eef79:/# free -m</span><br><span class="line">              total        used        free      shared  buff/cache   available</span><br><span class="line">Mem:            256           0         254         189           0         254</span><br><span class="line">Swap:           256           0         256</span><br><span class="line">root@6bcd804eef79:/#</span><br></pre></td></tr></table></figure><p> 我们可以看到total的内存为256MB，配置已经生效。 </p><h1 id="lxcfs-的-Kubernetes实践"><a href="#lxcfs-的-Kubernetes实践" class="headerlink" title="lxcfs 的 Kubernetes实践"></a>lxcfs 的 Kubernetes实践</h1><p>在kubernetes中使用lxcfs需要解决两个问题：</p><p>第一个问题是每个node上都要启动lxcfs，这个简单，部署一个daemonset就可以了。</p><p>第二个问题是将lxcfs维护的/proc文件挂载到每个容器中</p><p>在集群节点上安装并启动lxcfs，我们将用Kubernetes的方式，用利用容器和DaemonSet方式来运行 lxcfs FUSE文件系统。 </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/denverdino/lxcfs-initializer</span><br><span class="line">cd lxcfs-initializer</span><br></pre></td></tr></table></figure><h2 id="lxcfs-daemonset"><a href="#lxcfs-daemonset" class="headerlink" title="lxcfs-daemonset"></a>lxcfs-daemonset</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">apiVersion: apps/v1beta2</span><br><span class="line">kind: DaemonSet</span><br><span class="line">metadata:</span><br><span class="line">  name: lxcfs</span><br><span class="line">  labels:</span><br><span class="line">    app: lxcfs</span><br><span class="line">spec:</span><br><span class="line">  selector:</span><br><span class="line">    matchLabels:</span><br><span class="line">      app: lxcfs</span><br><span class="line">  template:</span><br><span class="line">    metadata:</span><br><span class="line">      labels:</span><br><span class="line">        app: lxcfs</span><br><span class="line">    spec:</span><br><span class="line">      hostPID: true</span><br><span class="line">      tolerations:</span><br><span class="line">      - key: node-role.kubernetes.io/master</span><br><span class="line">        effect: NoSchedule</span><br><span class="line">      containers:</span><br><span class="line">      - name: lxcfs</span><br><span class="line">        image: registry.cn-hangzhou.aliyuncs.com/denverdino/lxcfs:3.0.4</span><br><span class="line">        imagePullPolicy: Always</span><br><span class="line">        securityContext:</span><br><span class="line">          privileged: true</span><br><span class="line">        volumeMounts:</span><br><span class="line">        - name: cgroup</span><br><span class="line">          mountPath: /sys/fs/cgroup</span><br><span class="line">        - name: lxcfs</span><br><span class="line">          mountPath: /var/lib/lxcfs</span><br><span class="line">          mountPropagation: Bidirectional</span><br><span class="line">        - name: usr-local</span><br><span class="line">          mountPath: /usr/local</span><br><span class="line">      volumes:</span><br><span class="line">      - name: cgroup</span><br><span class="line">        hostPath:</span><br><span class="line">          path: /sys/fs/cgroup</span><br><span class="line">      - name: usr-local</span><br><span class="line">        hostPath:</span><br><span class="line">          path: /usr/local</span><br><span class="line">      - name: lxcfs</span><br><span class="line">        hostPath:</span><br><span class="line">          path: /var/lib/lxcfs</span><br><span class="line">          type: DirectoryOrCreate</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl apply -f lxcfs-daemonset.yaml</span><br></pre></td></tr></table></figure><p>Kubernetes提供了 Initializer 扩展机制，可以用于对资源创建进行拦截和注入处理，我们可以借助它优雅地完成对lxcfs文件的自动化挂载。 </p><h2 id="lxcfs-initializer"><a href="#lxcfs-initializer" class="headerlink" title="lxcfs-initializer"></a>lxcfs-initializer</h2><h3 id="Initializer功能开启"><a href="#Initializer功能开启" class="headerlink" title="Initializer功能开启"></a>Initializer功能开启</h3><p>在Kubernetes 1.13中<a href="https://kubernetes.io/docs/reference/access-authn-authz/extensible-admission-controllers/#initializers" target="_blank" rel="noopener">initializers</a>还是一个alpha特性，需要在Kube-apiserver中添加参数开启。</p><p>这里使用的是kubernets 1.12，设置方法是一样的：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">--enable-admission-plugins=&quot;Initializers,NamespaceLifecycle,NamespaceExists,LimitRanger,SecurityContextDeny,ServiceAccount,ResourceQuota&quot;</span><br><span class="line">--runtime-config=admissionregistration.k8s.io/v1alpha1</span><br></pre></td></tr></table></figure><p><code>--enable-admission-plugins</code>和<code>--admission-control</code>互斥，如果同时设置，kube-apiserver启动报错：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">error: [admission-control and enable-admission-plugins/disable-admission-plugins flags are mutually exclusive, </span><br><span class="line">enable-admission-plugins plugin &quot;--runtime-config=admissionregistration.k8s.io/v1alpha1&quot; is unknown]</span><br></pre></td></tr></table></figure><h3 id="InitializerConfiguration"><a href="#InitializerConfiguration" class="headerlink" title="InitializerConfiguration"></a>InitializerConfiguration</h3><p><code>InitializerConfiguration</code>资源中定义了一组的<code>initializers</code>。</p><p>每个initializer有一个名字和多个规则，规则中是它要作用的资源，例如下面的initializers中只有一个initializer，名称为<code>podimage.example.com</code>，作用于v1版本的pods。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">apiVersion: admissionregistration.k8s.io/v1alpha1</span><br><span class="line">kind: InitializerConfiguration</span><br><span class="line">metadata:</span><br><span class="line">  name: example-config</span><br><span class="line">initializers:</span><br><span class="line">  # the name needs to be fully qualified, i.e., containing at least two &quot;.&quot;</span><br><span class="line">  - name: podimage.example.com</span><br><span class="line">    rules:</span><br><span class="line">      # apiGroups, apiVersion, resources all support wildcard &quot;*&quot;.</span><br><span class="line">      # &quot;*&quot; cannot be mixed with non-wildcard.</span><br><span class="line">      - apiGroups:</span><br><span class="line">          - &quot;&quot;</span><br><span class="line">        apiVersions:</span><br><span class="line">          - v1</span><br><span class="line">        resources:</span><br><span class="line">          - pods</span><br></pre></td></tr></table></figure><p>在kubernets中创建了上面的initializers之后，新建的pod在pending阶段，metadata中会添加一个initializer列表：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">metadata:</span><br><span class="line">  creationTimestamp: 2019-01-09T08:56:36Z</span><br><span class="line">  generateName: echo-7cfbbd7d49-</span><br><span class="line">  initializers:</span><br><span class="line">    pending:</span><br><span class="line">    - name: podimage.example.com</span><br></pre></td></tr></table></figure><p>注意需要加上参数<code>--include-uninitialized=true</code>才能看到处于这个阶段的Pod:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./kubectl.sh -n demo-echo get pod --include-uninitialized=true -o yaml</span><br></pre></td></tr></table></figure><p>metadata中<code>initializers</code>列表不为空的Pod，处于正在等待初始化状态，需要部署一个<code>initializer controller</code>对处于这个阶段中的pod完成初始化后， pod才能退出pending状态。。</p><p>initializer controller需要自己根据需要实现。</p><h3 id="Initializer-Controller"><a href="#Initializer-Controller" class="headerlink" title="Initializer Controller"></a>Initializer Controller</h3><p>initializer controller监听指定类型的resource，当发现有新创建的resouce创建时，通过检查resource的metadata中的initializer名单，决定是否要对resource进行初始化设置，并且在完成设置之后，需要将对应的initializer名单从resource的metadata中删除，否则resource就一直处于等待初始化设置的状态。</p><p>具体实现可以参考<a href="https://github.com/lijiaocn/lxcfs-initializer" target="_blank" rel="noopener">lxcfs-initializer</a>。</p><p>如果有多个InitializerConfiguration和多个Initializer Controller，会怎样？</p><p>没有在文档中找到具体的说明，k8s的文档中Initializer章节的内容很少，这里通过实验，判断一下。</p><p>创建了两个不同名的但是包含相同rule的InitializerConfiguration：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">apiVersion: admissionregistration.k8s.io/v1alpha1</span><br><span class="line">kind: InitializerConfiguration</span><br><span class="line">metadata:</span><br><span class="line">  name: example-config</span><br><span class="line">initializers:</span><br><span class="line">  # the name needs to be fully qualified, i.e., containing at least two &quot;.&quot;</span><br><span class="line">  - name: podimage.example.com</span><br><span class="line">    rules:</span><br><span class="line">      # apiGroups, apiVersion, resources all support wildcard &quot;*&quot;.</span><br><span class="line">      # &quot;*&quot; cannot be mixed with non-wildcard.</span><br><span class="line">      - apiGroups:</span><br><span class="line">          - &quot;&quot;</span><br><span class="line">        apiVersions:</span><br><span class="line">          - v1</span><br><span class="line">        resources:</span><br><span class="line">          - pods</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">apiVersion: admissionregistration.k8s.io/v1alpha1</span><br><span class="line">kind: InitializerConfiguration</span><br><span class="line">metadata:</span><br><span class="line">  name: example-config-2</span><br><span class="line">initializers:</span><br><span class="line">  # the name needs to be fully qualified, i.e., containing at least two &quot;.&quot;</span><br><span class="line">  - name: podimage-2.example.com rules:</span><br><span class="line">      # apiGroups, apiVersion, resources all support wildcard &quot;*&quot;.</span><br><span class="line">      # &quot;*&quot; cannot be mixed with non-wildcard.</span><br><span class="line">      - apiGroups:</span><br><span class="line">          - &quot;&quot;</span><br><span class="line">        apiVersions:</span><br><span class="line">          - v1</span><br><span class="line">        resources:</span><br><span class="line">          - pods</span><br><span class="line">  - name: podimage.example.com</span><br><span class="line">    rules:</span><br><span class="line">      # apiGroups, apiVersion, resources all support wildcard &quot;*&quot;.</span><br><span class="line">      # &quot;*&quot; cannot be mixed with non-wildcard.</span><br><span class="line">      - apiGroups:</span><br><span class="line">          - &quot;&quot;</span><br><span class="line">        apiVersions:</span><br><span class="line">          - v1</span><br><span class="line">        resources:</span><br><span class="line">          - pods</span><br></pre></td></tr></table></figure><p>Pod中的metadata是这样的：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">metadata:</span><br><span class="line">  creationTimestamp: 2019-01-10T04:03:12Z</span><br><span class="line">  generateName: echo-7cfbbd7d49-</span><br><span class="line">  initializers:</span><br><span class="line">    pending:</span><br><span class="line">    - name: podimage.example.com</span><br><span class="line">    - name: podimage-2.example.com</span><br><span class="line">    - name: podimage.example.com</span><br></pre></td></tr></table></figure><p>之后又通过调整InitializerConfiguration的名称排序、创建的先后顺序、内部的rules的顺序，多次试验之后发现，<code>多个InitializerConfiguration</code>的在metadata中是按照它们的<code>名称排序</code>的，和创建时间无关。</p><p>每个InitializerConfiguration中的<code>rules</code>在metadata中顺序与它们<code>定义的顺序</code>一致。</p><p>根据lxcfs-initializer的实现以及k8s的文档，Initializer Controller对目标Resource完成设置之后，需要从metadata中移除对应的Initializer。</p><p>如果定义了多个Initializer，并且有多个Initializer Controller各自负责不同的Initializer，这时候需要小心设计，既要防止“漏掉”应当处理的Resource，导致Resource长期不落地，又要防止已经被删除的Initializer又被重新写上了，重复处理时出现错误。</p><p>根据现在掌握的信息，目前比较稳妥的做法是，将多个Initializer设计为顺序无关，谁先执行都可以，否则只有创建一个InitializerConfiguration，rules的顺序就是Initiliazer的顺序。只设计一个Initializer Controller,或者将多个Initializer Controller设计成串行执行，让它们监测Resource的创建和变化，不仅仅是刚创建，否则一些Initializer可能被漏掉。</p><p><a href="https://github.com/lijiaocn/lxcfs-initializer" target="_blank" rel="noopener">lxcfs-initializer</a>这个Initializer只关心<code>ADD</code>事件，如果同时有其它的Initializer Controller存在，可能会漏掉一些Resource。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">_, controller := cache.NewInformer(includeUninitializedWatchlist, &amp;v1.Deployment&#123;&#125;, resyncPeriod,</span><br><span class="line">cache.ResourceEventHandlerFuncs&#123;</span><br><span class="line">AddFunc: func(obj interface&#123;&#125;) &#123;</span><br><span class="line">err := initializeDeployment(obj.(*v1.Deployment), c, clientset)</span><br><span class="line">if err != nil &#123;</span><br><span class="line">log.Println(err)</span><br><span class="line">&#125;</span><br><span class="line">&#125;,</span><br><span class="line">&#125;,</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>实例：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">apiVersion: rbac.authorization.k8s.io/v1</span><br><span class="line">kind: ClusterRole</span><br><span class="line">metadata:</span><br><span class="line">  name: lxcfs-initializer-default</span><br><span class="line">  namespace: default</span><br><span class="line">rules:</span><br><span class="line">- apiGroups: [&quot;*&quot;]</span><br><span class="line">  resources: [&quot;pods&quot;]</span><br><span class="line">  verbs: [&quot;initialize&quot;, &quot;update&quot;, &quot;patch&quot;, &quot;watch&quot;, &quot;list&quot;]</span><br><span class="line">---</span><br><span class="line">apiVersion: v1</span><br><span class="line">kind: ServiceAccount</span><br><span class="line">metadata:</span><br><span class="line">  name: lxcfs-initializer-service-account</span><br><span class="line">  namespace: default</span><br><span class="line">---</span><br><span class="line">kind: ClusterRoleBinding</span><br><span class="line">apiVersion: rbac.authorization.k8s.io/v1</span><br><span class="line">metadata:</span><br><span class="line">  name: lxcfs-initializer-role-binding</span><br><span class="line">subjects:</span><br><span class="line">- kind: ServiceAccount</span><br><span class="line">  name: lxcfs-initializer-service-account</span><br><span class="line">  namespace: default</span><br><span class="line">roleRef:</span><br><span class="line">  kind: ClusterRole</span><br><span class="line">  name: lxcfs-initializer-default</span><br><span class="line">  apiGroup: rbac.authorization.k8s.io</span><br><span class="line">---</span><br><span class="line">apiVersion: apps/v1</span><br><span class="line">kind: Deployment</span><br><span class="line">metadata:</span><br><span class="line">  initializers:</span><br><span class="line">    pending: []</span><br><span class="line">  labels:</span><br><span class="line">    app: lxcfs-initializer</span><br><span class="line">  name: lxcfs-initializer</span><br><span class="line">spec:</span><br><span class="line">  replicas: 1</span><br><span class="line">  selector:</span><br><span class="line">    matchLabels:</span><br><span class="line">      app: lxcfs-initializer</span><br><span class="line">  template:</span><br><span class="line">    metadata:</span><br><span class="line">      labels:</span><br><span class="line">        app: lxcfs-initializer</span><br><span class="line">    spec:</span><br><span class="line">      serviceAccountName: lxcfs-initializer-service-account</span><br><span class="line">      containers:</span><br><span class="line">        - name: lxcfs-initializer</span><br><span class="line">          image: registry.cn-hangzhou.aliyuncs.com/denverdino/lxcfs-initializer:0.0.4</span><br><span class="line">          imagePullPolicy: Always</span><br><span class="line">          args:</span><br><span class="line">            - &quot;-annotation=initializer.kubernetes.io/lxcfs&quot;</span><br><span class="line">            - &quot;-require-annotation=true&quot;</span><br><span class="line">---</span><br><span class="line">apiVersion: admissionregistration.k8s.io/v1alpha1</span><br><span class="line">kind: InitializerConfiguration</span><br><span class="line">metadata:</span><br><span class="line">  name: lxcfs.initializer</span><br><span class="line">initializers:</span><br><span class="line">  - name: lxcfs.initializer.kubernetes.io</span><br><span class="line">    rules:</span><br><span class="line">      - apiGroups:</span><br><span class="line">          - &quot;*&quot;</span><br><span class="line">        apiVersions:</span><br><span class="line">          - &quot;*&quot;</span><br><span class="line">        resources:</span><br><span class="line">          - pods</span><br></pre></td></tr></table></figure><p>首先我们创建了service account <code>lxcfs-initializer-service-account</code>，并对其授权了 “pod” 资源的查找、更改等权限。然后我们部署了一个名为 “lxcfs-initializer” 的Initializer，利用上述SA启动一个容器来处理对 “pod” 资源的创建，如果deployment中包含 <code>initializer.kubernetes.io/lxcfs</code>为<code>true</code>的注释，就会对该应用中容器进行文件挂载 </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl apply -f lxcfs-initializer.yaml</span><br></pre></td></tr></table></figure><h2 id="下面我们部署一个简单的Apache应用"><a href="#下面我们部署一个简单的Apache应用" class="headerlink" title="下面我们部署一个简单的Apache应用"></a>下面我们部署一个简单的Apache应用</h2><p>为其分配256MB内存，并且声明了如下注释 <code>&quot;initializer.kubernetes.io/lxcfs&quot;: &quot;true&quot;</code></p><p>web.yaml:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">apiVersion: apps/v1</span><br><span class="line">kind: Deployment</span><br><span class="line">metadata:</span><br><span class="line">  labels:</span><br><span class="line">    app: web</span><br><span class="line">  name: web</span><br><span class="line">spec:</span><br><span class="line">  replicas: 1</span><br><span class="line">  selector:</span><br><span class="line">    matchLabels:</span><br><span class="line">      app: web</span><br><span class="line">  template:</span><br><span class="line">    metadata:</span><br><span class="line">      annotations:</span><br><span class="line">        &quot;initializer.kubernetes.io/lxcfs&quot;: &quot;true&quot;</span><br><span class="line">      labels:</span><br><span class="line">        app: web</span><br><span class="line">    spec:</span><br><span class="line">      containers:</span><br><span class="line">        - name: web</span><br><span class="line">          image: httpd:2.4.32</span><br><span class="line">          imagePullPolicy: Always</span><br><span class="line">          resources:</span><br><span class="line">            requests:</span><br><span class="line">              memory: &quot;256Mi&quot;</span><br><span class="line">              cpu: &quot;500m&quot;</span><br><span class="line">            limits:</span><br><span class="line">              memory: &quot;256Mi&quot;</span><br><span class="line">              cpu: &quot;500m&quot;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl apply -f web.yaml</span><br></pre></td></tr></table></figure><h3 id="验证"><a href="#验证" class="headerlink" title="验证"></a>验证</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">kubectl exec web-7f6bc6797c-rb9sk free</span><br><span class="line">             total       used       free     shared    buffers     cached</span><br><span class="line">Mem:        262144       2876     259268       2292          0        304</span><br><span class="line">-/+ buffers/cache:       2572     259572</span><br><span class="line">Swap:            0          0          0</span><br></pre></td></tr></table></figure><p>注意：</p><p>如果自己的k8s版本跟我的不一样，可以kubectl api-versions看看版本</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;LXCFS简介&quot;&gt;&lt;a href=&quot;#LXCFS简介&quot; class=&quot;headerlink&quot; title=&quot;LXCFS简介&quot;&gt;&lt;/a&gt;LXCFS简介&lt;/h1&gt;&lt;p&gt;社区中常见的做法是利用lxcfs来提供容器中的资源可见性。lxcfs 是一个开源的FUSE（用户态文
      
    
    </summary>
    
      <category term="k8s" scheme="https://shenshengkun.github.io/categories/k8s/"/>
    
    
  </entry>
  
  <entry>
    <title>Kubernetes垃圾回收机制</title>
    <link href="https://shenshengkun.github.io/posts/ladj543a8.html"/>
    <id>https://shenshengkun.github.io/posts/ladj543a8.html</id>
    <published>2019-08-05T05:53:01.000Z</published>
    <updated>2019-08-07T02:42:03.077Z</updated>
    
    <content type="html"><![CDATA[<h1 id="问题发现"><a href="#问题发现" class="headerlink" title="问题发现"></a>问题发现</h1><p>测试环境上，node节点上面镜像，突然被删除，故查明下删除的原理机制</p><h1 id="垃圾回收机制"><a href="#垃圾回收机制" class="headerlink" title="垃圾回收机制"></a>垃圾回收机制</h1><p>Kubelet的GC功能将清理未使用的image和container。Kubelet每分钟对container执行一次GC，每5分钟对image执行一次GC。不建议使用外部垃圾收集工具，因为这些工具可能破坏Kubelet。 </p><h2 id="image"><a href="#image" class="headerlink" title="image"></a>image</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Kubernetes与Cadvisor配合，通过ImageManager管理所有image的生命周期。</span><br><span class="line">image的GC策略包含高阈值和低阈值，高于高阈值的磁盘使用率将触发GC,删除最近最少使用的图像，直到满足低阈值为止。</span><br></pre></td></tr></table></figure><h2 id="container"><a href="#container" class="headerlink" title="container"></a>container</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">container的GC主要有3个用户定义变量：</span><br><span class="line">MinAge：容器被GC的最短时间</span><br><span class="line">MaxPerPodContainer: 允许每个PodContainer中死容器的最大数目,PodContainer指1个Container而非pod</span><br><span class="line">MaxContainers：死容器的最大数目</span><br><span class="line">Minage=0，MaxPerPodContainer和MaxContainers &lt;0, 表示禁用这些变量</span><br><span class="line">GC用于unidentified、deleted或超出边界的容器(3个用户定义变量)。</span><br><span class="line">最旧的container通常首先被移除。</span><br><span class="line">如果MaxPerPodContainer&gt;MaxContainers,maxperpodcontainer会进行调整，直至降级为1，并逐出最旧的容器。</span><br><span class="line">pods所拥有的已删除的容器一旦超过MinAge，就会被删除。</span><br><span class="line">未由Kubelet管理的容器不受容器垃圾收集的约束。</span><br></pre></td></tr></table></figure><h2 id="配置-GC"><a href="#配置-GC" class="headerlink" title="配置 GC"></a>配置 GC</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">通过修改kubelet flags来实现。</span><br><span class="line">image gc参数：</span><br><span class="line">image-gc-high-threshold  image GC 高阈值百分比，缺省为85%</span><br><span class="line">image-gc-low-threshold    image GC 低阈值百分比，缺省为80%</span><br><span class="line">minimum-container-ttl-duration                      MinAge参数，缺省为0</span><br><span class="line">maximum-dead-containers-per-container       MaxPerPodContainer，缺省为1.</span><br><span class="line">maximum-dead-containers       MaxContainers，缺省为-1, 也就是没有限制</span><br><span class="line">Container可能在其到期之前被GC,Container包含日志和其他对故障排除有用的数据。强烈建议MaxPerPodContainer和maximum-dead-containers  足够大。</span><br></pre></td></tr></table></figure><p><img src="https://shenshengkun.github.io/images/kubelet_gc1.png" alt=""></p><h3 id="GC效果"><a href="#GC效果" class="headerlink" title="GC效果"></a>GC效果</h3><p>配置一个10s后会失败的container 配置文件pod-gc.yaml</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">apiVersion: v1</span><br><span class="line">kind: Pod</span><br><span class="line">metadata:</span><br><span class="line">  name: gc-test</span><br><span class="line">spec:</span><br><span class="line">  containers:</span><br><span class="line">  - name: busybox-gc-1</span><br><span class="line">    image: busybox:v1</span><br><span class="line">    command:</span><br><span class="line">    - /bin/sh</span><br><span class="line">    - -c</span><br><span class="line">    - &apos;sleep 10 &amp;&amp; hello&apos;</span><br></pre></td></tr></table></figure><p>使用yaml创建pod</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl apply -f pod-gc.yaml</span><br></pre></td></tr></table></figure><p>查看docker的状态，当出现2个exit的container时，就会出发GC,回收最早的一个container</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># docker ps -a | grep busybox-gc</span><br><span class="line">8ddbfcf4ebee        59788edf1f3e             &quot;/bin/sh -c &apos;sleep 1…&quot;   2 seconds ago        Up 1 second                                           k8s_busybox-gc-1_gc-test_default_3651c167-75f0-11e9-bc74-52540005f38a_5</span><br><span class="line">7d7c1ade82af        59788edf1f3e             &quot;/bin/sh -c &apos;sleep 1…&quot;   About a minute ago   Exited (127) About a minute ago                       k8s_busybox-gc-1_gc-test_default_3651c167-75f0-11e9-bc74-52540005f38a_4</span><br><span class="line"># docker ps -a | grep busybox-gc</span><br><span class="line">8ddbfcf4ebee        59788edf1f3e             &quot;/bin/sh -c &apos;sleep 1…&quot;   10 seconds ago       Up 9 seconds                                          k8s_busybox-gc-1_gc-test_default_3651c167-75f0-11e9-bc74-52540005f38a_5</span><br><span class="line">7d7c1ade82af        59788edf1f3e             &quot;/bin/sh -c &apos;sleep 1…&quot;   About a minute ago   Exited (127) About a minute ago                       k8s_busybox-gc-1_gc-test_default_3651c167-75f0-11e9-bc74-52540005f38a_4</span><br><span class="line"># docker ps -a | grep busybox-gc</span><br><span class="line">8ddbfcf4ebee        59788edf1f3e             &quot;/bin/sh -c &apos;sleep 1…&quot;   11 seconds ago       Exited (127) Less than a second ago                       k8s_busybox-gc-1_gc-test_default_3651c167-75f0-11e9-bc74-52540005f38a_5</span><br><span class="line">7d7c1ade82af        59788edf1f3e             &quot;/bin/sh -c &apos;sleep 1…&quot;   About a minute ago   Exited (127) About a minute ago                           k8s_busybox-gc-1_gc-test_default_3651c167-75f0-11e9-bc74-52540005f38a_4</span><br><span class="line"># docker ps -a | grep busybox-gc</span><br><span class="line">8ddbfcf4ebee        59788edf1f3e             &quot;/bin/sh -c &apos;sleep 1…&quot;   12 seconds ago      Exited (127) 1 second ago                       k8s_busybox-gc-1_gc-test_default_3651c167-75f0-11e9-bc74-52540005f38a_5</span><br></pre></td></tr></table></figure><p>修改配置文件/var/lib/kubelet/kubeadm-flags.env增加参数–maximum-dead-containers-per-container=2</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">KUBELET_KUBEADM_ARGS=--cgroup-driver=systemd --network-plugin=cni --pod-infra-container-image=k8s.gcr.io/pause:3.1 --maximum-dead-containers-per-container=2</span><br></pre></td></tr></table></figure><p>重启kubelet服务</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart kubelet</span><br></pre></td></tr></table></figure><p>删除前面的pod</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl delete -f pod-gc.yaml</span><br></pre></td></tr></table></figure><p>重新添加pod</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl apply -f pod-gc.yaml</span><br></pre></td></tr></table></figure><p>可以看到，当exit的容器达到3个时，才会触发gc</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"># docker ps -a | grep busybox-gc</span><br><span class="line">c8677098e9aa        af2f74c517aa             &quot;/bin/sh -c &apos;sleep 1…&quot;   8 seconds ago       Up 8 seconds                                      k8s_busybox-gc-1_gc-test_default_3425a55b-75f5-11e9-bc74-52540005f38a_2</span><br><span class="line">f0bc1b7893bd        af2f74c517aa             &quot;/bin/sh -c &apos;sleep 1…&quot;   34 seconds ago      Exited (127) 23 seconds ago                       k8s_busybox-gc-1_gc-test_default_3425a55b-75f5-11e9-bc74-52540005f38a_1</span><br><span class="line">9e7fa118b1d3        af2f74c517aa             &quot;/bin/sh -c &apos;sleep 1…&quot;   45 seconds ago      Exited (127) 35 seconds ago                       k8s_busybox-gc-1_gc-test_default_3425a55b-75f5-11e9-bc74-52540005f38a_0</span><br><span class="line"># docker ps -a | grep busybox-gc</span><br><span class="line">c8677098e9aa        af2f74c517aa             &quot;/bin/sh -c &apos;sleep 1…&quot;   9 seconds ago       Up 9 seconds                                      k8s_busybox-gc-1_gc-test_default_3425a55b-75f5-11e9-bc74-52540005f38a_2</span><br><span class="line">f0bc1b7893bd        af2f74c517aa             &quot;/bin/sh -c &apos;sleep 1…&quot;   35 seconds ago      Exited (127) 24 seconds ago                       k8s_busybox-gc-1_gc-test_default_3425a55b-75f5-11e9-bc74-52540005f38a_1</span><br><span class="line">9e7fa118b1d3        af2f74c517aa             &quot;/bin/sh -c &apos;sleep 1…&quot;   46 seconds ago      Exited (127) 36 seconds ago                       k8s_busybox-gc-1_gc-test_default_3425a55b-75f5-11e9-bc74-52540005f38a_0</span><br><span class="line"># docker ps -a | grep busybox-gc</span><br><span class="line">c8677098e9aa        af2f74c517aa             &quot;/bin/sh -c &apos;sleep 1…&quot;   10 seconds ago      Exited (127) Less than a second ago                       k8s_busybox-gc-1_gc-test_default_3425a55b-75f5-11e9-bc74-52540005f38a_2</span><br><span class="line">f0bc1b7893bd        af2f74c517aa             &quot;/bin/sh -c &apos;sleep 1…&quot;   36 seconds ago      Exited (127) 25 seconds ago                               k8s_busybox-gc-1_gc-test_default_3425a55b-75f5-11e9-bc74-52540005f38a_1</span><br><span class="line">9e7fa118b1d3        af2f74c517aa             &quot;/bin/sh -c &apos;sleep 1…&quot;   47 seconds ago      Exited (127) 36 seconds ago                               k8s_busybox-gc-1_gc-test_default_3425a55b-75f5-11e9-bc74-52540005f38a_0</span><br><span class="line"># docker ps -a | grep busybox-gc</span><br><span class="line">c8677098e9aa        af2f74c517aa             &quot;/bin/sh -c &apos;sleep 1…&quot;   11 seconds ago      Exited (127) 1 second ago                         k8s_busybox-gc-1_gc-test_default_3425a55b-75f5-11e9-bc74-52540005f38a_2</span><br><span class="line">f0bc1b7893bd        af2f74c517aa             &quot;/bin/sh -c &apos;sleep 1…&quot;   37 seconds ago      Exited (127) 26 seconds ago                       k8s_busybox-gc-1_gc-test_default_3425a55b-75f5-11e9-bc74-52540005f38a_1</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;问题发现&quot;&gt;&lt;a href=&quot;#问题发现&quot; class=&quot;headerlink&quot; title=&quot;问题发现&quot;&gt;&lt;/a&gt;问题发现&lt;/h1&gt;&lt;p&gt;测试环境上，node节点上面镜像，突然被删除，故查明下删除的原理机制&lt;/p&gt;
&lt;h1 id=&quot;垃圾回收机制&quot;&gt;&lt;a href
      
    
    </summary>
    
      <category term="k8s" scheme="https://shenshengkun.github.io/categories/k8s/"/>
    
    
  </entry>
  
  <entry>
    <title>prometheus监控redis集群</title>
    <link href="https://shenshengkun.github.io/posts/skd32aaa.html"/>
    <id>https://shenshengkun.github.io/posts/skd32aaa.html</id>
    <published>2019-08-02T05:25:01.000Z</published>
    <updated>2019-08-05T01:58:39.214Z</updated>
    
    <content type="html"><![CDATA[<h1 id="安装redis-exporter"><a href="#安装redis-exporter" class="headerlink" title="安装redis_exporter"></a>安装redis_exporter</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local</span><br><span class="line">wget https://github.com/oliver006/redis_exporter/releases/download/v1.0.3/redis_exporter-v1.0.3.linux-amd64.tar.gz</span><br><span class="line">tar -zxvf redis_exporter-v1.0.3.linux-amd64.tar.gz </span><br><span class="line">mv redis_exporter-v1.0.3.linux-amd64 redis_exporter</span><br><span class="line">cd redis_exporter</span><br><span class="line"></span><br><span class="line">启动</span><br><span class="line">nohup ./redis_exporter -redis.addr 192.168.7.21:6379 192.168.7.21:6380 192.168.7.22:6379 192.168.7.22:6380 192.168.7.23:6379 192.168.7.23:6380 &amp;</span><br></pre></td></tr></table></figure><h1 id="prometheus配置"><a href="#prometheus配置" class="headerlink" title="prometheus配置"></a>prometheus配置</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">    - job_name: &apos;redis-cluster&apos;</span><br><span class="line">      static_configs:</span><br><span class="line">      - targets:</span><br><span class="line">        - redis://192.168.7.21:6379</span><br><span class="line">        - redis://192.168.7.21:6380</span><br><span class="line">        - redis://192.168.7.22:6379</span><br><span class="line">        - redis://192.168.7.22:6380</span><br><span class="line">        - redis://192.168.7.23:6379</span><br><span class="line">        - redis://192.168.7.23:6380</span><br><span class="line">      metrics_path: /scrape</span><br><span class="line">      params:</span><br><span class="line">        check-keys: [&quot;metrics:*&quot;]</span><br><span class="line">      relabel_configs:</span><br><span class="line">        - source_labels: [__address__]</span><br><span class="line">          target_label: __param_target</span><br><span class="line">        - source_labels: [__param_target]</span><br><span class="line">          target_label: instance</span><br><span class="line">        - target_label: __address__</span><br><span class="line">          replacement: 192.168.7.21:9121        </span><br><span class="line">          </span><br><span class="line">          </span><br><span class="line">          </span><br><span class="line">          </span><br><span class="line">          </span><br><span class="line">          </span><br><span class="line">          </span><br><span class="line">报警：</span><br><span class="line">############ redis cluster 监控 ############</span><br><span class="line">      - alert: redis连接数超过1000</span><br><span class="line">        expr: redis_connected_clients &gt; 1000</span><br><span class="line">        for: 2m</span><br><span class="line">        labels:</span><br><span class="line">          status: 监控redis连接数</span><br><span class="line">        annotations:</span><br><span class="line">          description: &quot;&#123;&#123;$labels.instance&#125;&#125;: 当前客户端连接数量为&#123;&#123; $value &#125;&#125;&quot;</span><br><span class="line">          summary: &quot;redis连接数超过1000&quot;</span><br></pre></td></tr></table></figure><h1 id="grafana导入模板"><a href="#grafana导入模板" class="headerlink" title="grafana导入模板"></a>grafana导入模板</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br><span class="line">911</span><br><span class="line">912</span><br><span class="line">913</span><br><span class="line">914</span><br><span class="line">915</span><br><span class="line">916</span><br><span class="line">917</span><br><span class="line">918</span><br><span class="line">919</span><br><span class="line">920</span><br><span class="line">921</span><br><span class="line">922</span><br><span class="line">923</span><br><span class="line">924</span><br><span class="line">925</span><br><span class="line">926</span><br><span class="line">927</span><br><span class="line">928</span><br><span class="line">929</span><br><span class="line">930</span><br><span class="line">931</span><br><span class="line">932</span><br><span class="line">933</span><br><span class="line">934</span><br><span class="line">935</span><br><span class="line">936</span><br><span class="line">937</span><br><span class="line">938</span><br><span class="line">939</span><br><span class="line">940</span><br><span class="line">941</span><br><span class="line">942</span><br><span class="line">943</span><br><span class="line">944</span><br><span class="line">945</span><br><span class="line">946</span><br><span class="line">947</span><br><span class="line">948</span><br><span class="line">949</span><br><span class="line">950</span><br><span class="line">951</span><br><span class="line">952</span><br><span class="line">953</span><br><span class="line">954</span><br><span class="line">955</span><br><span class="line">956</span><br><span class="line">957</span><br><span class="line">958</span><br><span class="line">959</span><br><span class="line">960</span><br><span class="line">961</span><br><span class="line">962</span><br><span class="line">963</span><br><span class="line">964</span><br><span class="line">965</span><br><span class="line">966</span><br><span class="line">967</span><br><span class="line">968</span><br><span class="line">969</span><br><span class="line">970</span><br><span class="line">971</span><br><span class="line">972</span><br><span class="line">973</span><br><span class="line">974</span><br><span class="line">975</span><br><span class="line">976</span><br><span class="line">977</span><br><span class="line">978</span><br><span class="line">979</span><br><span class="line">980</span><br><span class="line">981</span><br><span class="line">982</span><br><span class="line">983</span><br><span class="line">984</span><br><span class="line">985</span><br><span class="line">986</span><br><span class="line">987</span><br><span class="line">988</span><br><span class="line">989</span><br><span class="line">990</span><br><span class="line">991</span><br><span class="line">992</span><br><span class="line">993</span><br><span class="line">994</span><br><span class="line">995</span><br><span class="line">996</span><br><span class="line">997</span><br><span class="line">998</span><br><span class="line">999</span><br><span class="line">1000</span><br><span class="line">1001</span><br><span class="line">1002</span><br><span class="line">1003</span><br><span class="line">1004</span><br><span class="line">1005</span><br><span class="line">1006</span><br><span class="line">1007</span><br><span class="line">1008</span><br><span class="line">1009</span><br><span class="line">1010</span><br><span class="line">1011</span><br><span class="line">1012</span><br><span class="line">1013</span><br><span class="line">1014</span><br><span class="line">1015</span><br><span class="line">1016</span><br><span class="line">1017</span><br><span class="line">1018</span><br><span class="line">1019</span><br><span class="line">1020</span><br><span class="line">1021</span><br><span class="line">1022</span><br><span class="line">1023</span><br><span class="line">1024</span><br><span class="line">1025</span><br><span class="line">1026</span><br><span class="line">1027</span><br><span class="line">1028</span><br><span class="line">1029</span><br><span class="line">1030</span><br><span class="line">1031</span><br><span class="line">1032</span><br><span class="line">1033</span><br><span class="line">1034</span><br><span class="line">1035</span><br><span class="line">1036</span><br><span class="line">1037</span><br><span class="line">1038</span><br><span class="line">1039</span><br><span class="line">1040</span><br><span class="line">1041</span><br><span class="line">1042</span><br><span class="line">1043</span><br><span class="line">1044</span><br><span class="line">1045</span><br><span class="line">1046</span><br><span class="line">1047</span><br><span class="line">1048</span><br><span class="line">1049</span><br><span class="line">1050</span><br><span class="line">1051</span><br><span class="line">1052</span><br><span class="line">1053</span><br><span class="line">1054</span><br><span class="line">1055</span><br><span class="line">1056</span><br><span class="line">1057</span><br><span class="line">1058</span><br><span class="line">1059</span><br><span class="line">1060</span><br><span class="line">1061</span><br><span class="line">1062</span><br><span class="line">1063</span><br><span class="line">1064</span><br><span class="line">1065</span><br><span class="line">1066</span><br><span class="line">1067</span><br><span class="line">1068</span><br><span class="line">1069</span><br><span class="line">1070</span><br><span class="line">1071</span><br><span class="line">1072</span><br><span class="line">1073</span><br><span class="line">1074</span><br><span class="line">1075</span><br><span class="line">1076</span><br><span class="line">1077</span><br><span class="line">1078</span><br><span class="line">1079</span><br><span class="line">1080</span><br><span class="line">1081</span><br><span class="line">1082</span><br><span class="line">1083</span><br><span class="line">1084</span><br><span class="line">1085</span><br><span class="line">1086</span><br><span class="line">1087</span><br><span class="line">1088</span><br><span class="line">1089</span><br><span class="line">1090</span><br><span class="line">1091</span><br><span class="line">1092</span><br><span class="line">1093</span><br><span class="line">1094</span><br><span class="line">1095</span><br><span class="line">1096</span><br><span class="line">1097</span><br><span class="line">1098</span><br><span class="line">1099</span><br><span class="line">1100</span><br><span class="line">1101</span><br><span class="line">1102</span><br><span class="line">1103</span><br><span class="line">1104</span><br><span class="line">1105</span><br><span class="line">1106</span><br><span class="line">1107</span><br><span class="line">1108</span><br><span class="line">1109</span><br><span class="line">1110</span><br><span class="line">1111</span><br><span class="line">1112</span><br><span class="line">1113</span><br><span class="line">1114</span><br><span class="line">1115</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;__inputs&quot;: [</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;name&quot;: &quot;DS_PROMETHEUS&quot;,</span><br><span class="line">      &quot;label&quot;: &quot;Prometheus&quot;,</span><br><span class="line">      &quot;description&quot;: &quot;&quot;,</span><br><span class="line">      &quot;type&quot;: &quot;datasource&quot;,</span><br><span class="line">      &quot;pluginId&quot;: &quot;prometheus&quot;,</span><br><span class="line">      &quot;pluginName&quot;: &quot;Prometheus&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  &quot;__requires&quot;: [</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;type&quot;: &quot;grafana&quot;,</span><br><span class="line">      &quot;id&quot;: &quot;grafana&quot;,</span><br><span class="line">      &quot;name&quot;: &quot;Grafana&quot;,</span><br><span class="line">      &quot;version&quot;: &quot;5.4.3&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;type&quot;: &quot;panel&quot;,</span><br><span class="line">      &quot;id&quot;: &quot;graph&quot;,</span><br><span class="line">      &quot;name&quot;: &quot;Graph&quot;,</span><br><span class="line">      &quot;version&quot;: &quot;5.0.0&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;type&quot;: &quot;datasource&quot;,</span><br><span class="line">      &quot;id&quot;: &quot;prometheus&quot;,</span><br><span class="line">      &quot;name&quot;: &quot;Prometheus&quot;,</span><br><span class="line">      &quot;version&quot;: &quot;5.0.0&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;type&quot;: &quot;panel&quot;,</span><br><span class="line">      &quot;id&quot;: &quot;singlestat&quot;,</span><br><span class="line">      &quot;name&quot;: &quot;Singlestat&quot;,</span><br><span class="line">      &quot;version&quot;: &quot;5.0.0&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  &quot;annotations&quot;: &#123;</span><br><span class="line">    &quot;list&quot;: [</span><br><span class="line">      &#123;</span><br><span class="line">        &quot;builtIn&quot;: 1,</span><br><span class="line">        &quot;datasource&quot;: &quot;-- Grafana --&quot;,</span><br><span class="line">        &quot;enable&quot;: true,</span><br><span class="line">        &quot;hide&quot;: true,</span><br><span class="line">        &quot;iconColor&quot;: &quot;rgba(0, 211, 255, 1)&quot;,</span><br><span class="line">        &quot;name&quot;: &quot;Annotations &amp; Alerts&quot;,</span><br><span class="line">        &quot;type&quot;: &quot;dashboard&quot;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;description&quot;: &quot;Prometheus dashboard for Redis servers&quot;,</span><br><span class="line">  &quot;editable&quot;: true,</span><br><span class="line">  &quot;gnetId&quot;: 2751,</span><br><span class="line">  &quot;graphTooltip&quot;: 0,</span><br><span class="line">  &quot;id&quot;: null,</span><br><span class="line">  &quot;iteration&quot;: 1564967488877,</span><br><span class="line">  &quot;links&quot;: [],</span><br><span class="line">  &quot;panels&quot;: [</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;cacheTimeout&quot;: null,</span><br><span class="line">      &quot;colorBackground&quot;: false,</span><br><span class="line">      &quot;colorValue&quot;: false,</span><br><span class="line">      &quot;colors&quot;: [</span><br><span class="line">        &quot;rgba(41, 200, 35, 0.97)&quot;,</span><br><span class="line">        &quot;rgba(237, 129, 40, 0.89)&quot;,</span><br><span class="line">        &quot;rgba(245, 54, 54, 0.9)&quot;</span><br><span class="line">      ],</span><br><span class="line">      &quot;datasource&quot;: &quot;$&#123;DS_PROMETHEUS&#125;&quot;,</span><br><span class="line">      &quot;decimals&quot;: 0,</span><br><span class="line">      &quot;editable&quot;: true,</span><br><span class="line">      &quot;error&quot;: false,</span><br><span class="line">      &quot;format&quot;: &quot;s&quot;,</span><br><span class="line">      &quot;gauge&quot;: &#123;</span><br><span class="line">        &quot;maxValue&quot;: 100,</span><br><span class="line">        &quot;minValue&quot;: 0,</span><br><span class="line">        &quot;show&quot;: false,</span><br><span class="line">        &quot;thresholdLabels&quot;: false,</span><br><span class="line">        &quot;thresholdMarkers&quot;: true</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;gridPos&quot;: &#123;</span><br><span class="line">        &quot;h&quot;: 7,</span><br><span class="line">        &quot;w&quot;: 4,</span><br><span class="line">        &quot;x&quot;: 0,</span><br><span class="line">        &quot;y&quot;: 0</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;id&quot;: 9,</span><br><span class="line">      &quot;interval&quot;: null,</span><br><span class="line">      &quot;isNew&quot;: true,</span><br><span class="line">      &quot;links&quot;: [],</span><br><span class="line">      &quot;mappingType&quot;: 1,</span><br><span class="line">      &quot;mappingTypes&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;name&quot;: &quot;value to text&quot;,</span><br><span class="line">          &quot;value&quot;: 1</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;name&quot;: &quot;range to text&quot;,</span><br><span class="line">          &quot;value&quot;: 2</span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      &quot;maxDataPoints&quot;: 100,</span><br><span class="line">      &quot;nullPointMode&quot;: &quot;connected&quot;,</span><br><span class="line">      &quot;nullText&quot;: null,</span><br><span class="line">      &quot;postfix&quot;: &quot;&quot;,</span><br><span class="line">      &quot;postfixFontSize&quot;: &quot;50%&quot;,</span><br><span class="line">      &quot;prefix&quot;: &quot;&quot;,</span><br><span class="line">      &quot;prefixFontSize&quot;: &quot;50%&quot;,</span><br><span class="line">      &quot;rangeMaps&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;from&quot;: &quot;null&quot;,</span><br><span class="line">          &quot;text&quot;: &quot;N/A&quot;,</span><br><span class="line">          &quot;to&quot;: &quot;null&quot;</span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      &quot;sparkline&quot;: &#123;</span><br><span class="line">        &quot;fillColor&quot;: &quot;rgba(31, 118, 189, 0.18)&quot;,</span><br><span class="line">        &quot;full&quot;: false,</span><br><span class="line">        &quot;lineColor&quot;: &quot;rgb(31, 120, 193)&quot;,</span><br><span class="line">        &quot;show&quot;: false</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;tableColumn&quot;: &quot;__name__&quot;,</span><br><span class="line">      &quot;targets&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;expr&quot;: &quot;redis_uptime_in_seconds&#123;instance=\&quot;$instance\&quot;&#125;&quot;,</span><br><span class="line">          &quot;format&quot;: &quot;time_series&quot;,</span><br><span class="line">          &quot;interval&quot;: &quot;&quot;,</span><br><span class="line">          &quot;intervalFactor&quot;: 2,</span><br><span class="line">          &quot;legendFormat&quot;: &quot;&quot;,</span><br><span class="line">          &quot;metric&quot;: &quot;&quot;,</span><br><span class="line">          &quot;refId&quot;: &quot;A&quot;,</span><br><span class="line">          &quot;step&quot;: 1800</span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      &quot;thresholds&quot;: &quot;&quot;,</span><br><span class="line">      &quot;title&quot;: &quot;Redis Uptime&quot;,</span><br><span class="line">      &quot;type&quot;: &quot;singlestat&quot;,</span><br><span class="line">      &quot;valueFontSize&quot;: &quot;70%&quot;,</span><br><span class="line">      &quot;valueMaps&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;op&quot;: &quot;=&quot;,</span><br><span class="line">          &quot;text&quot;: &quot;N/A&quot;,</span><br><span class="line">          &quot;value&quot;: &quot;null&quot;</span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      &quot;valueName&quot;: &quot;avg&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;cacheTimeout&quot;: null,</span><br><span class="line">      &quot;colorBackground&quot;: false,</span><br><span class="line">      &quot;colorValue&quot;: false,</span><br><span class="line">      &quot;colors&quot;: [</span><br><span class="line">        &quot;rgba(245, 54, 54, 0.9)&quot;,</span><br><span class="line">        &quot;rgba(237, 129, 40, 0.89)&quot;,</span><br><span class="line">        &quot;rgba(50, 172, 45, 0.97)&quot;</span><br><span class="line">      ],</span><br><span class="line">      &quot;datasource&quot;: &quot;$&#123;DS_PROMETHEUS&#125;&quot;,</span><br><span class="line">      &quot;decimals&quot;: 0,</span><br><span class="line">      &quot;editable&quot;: true,</span><br><span class="line">      &quot;error&quot;: false,</span><br><span class="line">      &quot;format&quot;: &quot;none&quot;,</span><br><span class="line">      &quot;gauge&quot;: &#123;</span><br><span class="line">        &quot;maxValue&quot;: 100,</span><br><span class="line">        &quot;minValue&quot;: 0,</span><br><span class="line">        &quot;show&quot;: false,</span><br><span class="line">        &quot;thresholdLabels&quot;: false,</span><br><span class="line">        &quot;thresholdMarkers&quot;: true</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;gridPos&quot;: &#123;</span><br><span class="line">        &quot;h&quot;: 7,</span><br><span class="line">        &quot;w&quot;: 4,</span><br><span class="line">        &quot;x&quot;: 4,</span><br><span class="line">        &quot;y&quot;: 0</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;hideTimeOverride&quot;: true,</span><br><span class="line">      &quot;id&quot;: 12,</span><br><span class="line">      &quot;interval&quot;: null,</span><br><span class="line">      &quot;isNew&quot;: true,</span><br><span class="line">      &quot;links&quot;: [],</span><br><span class="line">      &quot;mappingType&quot;: 1,</span><br><span class="line">      &quot;mappingTypes&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;name&quot;: &quot;value to text&quot;,</span><br><span class="line">          &quot;value&quot;: 1</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;name&quot;: &quot;range to text&quot;,</span><br><span class="line">          &quot;value&quot;: 2</span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      &quot;maxDataPoints&quot;: 100,</span><br><span class="line">      &quot;nullPointMode&quot;: &quot;connected&quot;,</span><br><span class="line">      &quot;nullText&quot;: null,</span><br><span class="line">      &quot;postfix&quot;: &quot;&quot;,</span><br><span class="line">      &quot;postfixFontSize&quot;: &quot;50%&quot;,</span><br><span class="line">      &quot;prefix&quot;: &quot;&quot;,</span><br><span class="line">      &quot;prefixFontSize&quot;: &quot;50%&quot;,</span><br><span class="line">      &quot;rangeMaps&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;from&quot;: &quot;null&quot;,</span><br><span class="line">          &quot;text&quot;: &quot;N/A&quot;,</span><br><span class="line">          &quot;to&quot;: &quot;null&quot;</span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      &quot;sparkline&quot;: &#123;</span><br><span class="line">        &quot;fillColor&quot;: &quot;rgba(31, 118, 189, 0.18)&quot;,</span><br><span class="line">        &quot;full&quot;: false,</span><br><span class="line">        &quot;lineColor&quot;: &quot;rgb(31, 120, 193)&quot;,</span><br><span class="line">        &quot;show&quot;: true</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;tableColumn&quot;: &quot;&quot;,</span><br><span class="line">      &quot;targets&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;expr&quot;: &quot;redis_connected_clients&#123;instance=\&quot;$instance\&quot;&#125;&quot;,</span><br><span class="line">          &quot;format&quot;: &quot;time_series&quot;,</span><br><span class="line">          &quot;intervalFactor&quot;: 2,</span><br><span class="line">          &quot;legendFormat&quot;: &quot;&quot;,</span><br><span class="line">          &quot;metric&quot;: &quot;&quot;,</span><br><span class="line">          &quot;refId&quot;: &quot;A&quot;,</span><br><span class="line">          &quot;step&quot;: 2</span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      &quot;thresholds&quot;: &quot;&quot;,</span><br><span class="line">      &quot;timeFrom&quot;: &quot;1m&quot;,</span><br><span class="line">      &quot;timeShift&quot;: null,</span><br><span class="line">      &quot;title&quot;: &quot;Clients&quot;,</span><br><span class="line">      &quot;type&quot;: &quot;singlestat&quot;,</span><br><span class="line">      &quot;valueFontSize&quot;: &quot;80%&quot;,</span><br><span class="line">      &quot;valueMaps&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;op&quot;: &quot;=&quot;,</span><br><span class="line">          &quot;text&quot;: &quot;N/A&quot;,</span><br><span class="line">          &quot;value&quot;: &quot;null&quot;</span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      &quot;valueName&quot;: &quot;current&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;aliasColors&quot;: &#123;&#125;,</span><br><span class="line">      &quot;bars&quot;: false,</span><br><span class="line">      &quot;dashLength&quot;: 10,</span><br><span class="line">      &quot;dashes&quot;: false,</span><br><span class="line">      &quot;datasource&quot;: &quot;$&#123;DS_PROMETHEUS&#125;&quot;,</span><br><span class="line">      &quot;editable&quot;: true,</span><br><span class="line">      &quot;error&quot;: false,</span><br><span class="line">      &quot;fill&quot;: 1,</span><br><span class="line">      &quot;grid&quot;: &#123;&#125;,</span><br><span class="line">      &quot;gridPos&quot;: &#123;</span><br><span class="line">        &quot;h&quot;: 7,</span><br><span class="line">        &quot;w&quot;: 8,</span><br><span class="line">        &quot;x&quot;: 8,</span><br><span class="line">        &quot;y&quot;: 0</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;id&quot;: 2,</span><br><span class="line">      &quot;isNew&quot;: true,</span><br><span class="line">      &quot;legend&quot;: &#123;</span><br><span class="line">        &quot;avg&quot;: false,</span><br><span class="line">        &quot;current&quot;: false,</span><br><span class="line">        &quot;max&quot;: false,</span><br><span class="line">        &quot;min&quot;: false,</span><br><span class="line">        &quot;show&quot;: false,</span><br><span class="line">        &quot;total&quot;: false,</span><br><span class="line">        &quot;values&quot;: false</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;lines&quot;: true,</span><br><span class="line">      &quot;linewidth&quot;: 2,</span><br><span class="line">      &quot;links&quot;: [],</span><br><span class="line">      &quot;nullPointMode&quot;: &quot;connected&quot;,</span><br><span class="line">      &quot;percentage&quot;: false,</span><br><span class="line">      &quot;pointradius&quot;: 5,</span><br><span class="line">      &quot;points&quot;: false,</span><br><span class="line">      &quot;renderer&quot;: &quot;flot&quot;,</span><br><span class="line">      &quot;seriesOverrides&quot;: [],</span><br><span class="line">      &quot;spaceLength&quot;: 10,</span><br><span class="line">      &quot;stack&quot;: false,</span><br><span class="line">      &quot;steppedLine&quot;: false,</span><br><span class="line">      &quot;targets&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;expr&quot;: &quot;rate(redis_commands_processed_total&#123;instance=~\&quot;$instance\&quot;&#125;[5m])&quot;,</span><br><span class="line">          &quot;format&quot;: &quot;time_series&quot;,</span><br><span class="line">          &quot;interval&quot;: &quot;&quot;,</span><br><span class="line">          &quot;intervalFactor&quot;: 2,</span><br><span class="line">          &quot;legendFormat&quot;: &quot;&quot;,</span><br><span class="line">          &quot;metric&quot;: &quot;A&quot;,</span><br><span class="line">          &quot;refId&quot;: &quot;A&quot;,</span><br><span class="line">          &quot;step&quot;: 240,</span><br><span class="line">          &quot;target&quot;: &quot;&quot;</span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      &quot;thresholds&quot;: [],</span><br><span class="line">      &quot;timeFrom&quot;: null,</span><br><span class="line">      &quot;timeRegions&quot;: [],</span><br><span class="line">      &quot;timeShift&quot;: null,</span><br><span class="line">      &quot;title&quot;: &quot;Commands Executed / sec&quot;,</span><br><span class="line">      &quot;tooltip&quot;: &#123;</span><br><span class="line">        &quot;msResolution&quot;: false,</span><br><span class="line">        &quot;shared&quot;: true,</span><br><span class="line">        &quot;sort&quot;: 0,</span><br><span class="line">        &quot;value_type&quot;: &quot;cumulative&quot;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;type&quot;: &quot;graph&quot;,</span><br><span class="line">      &quot;xaxis&quot;: &#123;</span><br><span class="line">        &quot;buckets&quot;: null,</span><br><span class="line">        &quot;mode&quot;: &quot;time&quot;,</span><br><span class="line">        &quot;name&quot;: null,</span><br><span class="line">        &quot;show&quot;: true,</span><br><span class="line">        &quot;values&quot;: []</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;yaxes&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;format&quot;: &quot;short&quot;,</span><br><span class="line">          &quot;label&quot;: null,</span><br><span class="line">          &quot;logBase&quot;: 1,</span><br><span class="line">          &quot;max&quot;: null,</span><br><span class="line">          &quot;min&quot;: null,</span><br><span class="line">          &quot;show&quot;: true</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;format&quot;: &quot;short&quot;,</span><br><span class="line">          &quot;label&quot;: null,</span><br><span class="line">          &quot;logBase&quot;: 1,</span><br><span class="line">          &quot;max&quot;: null,</span><br><span class="line">          &quot;min&quot;: null,</span><br><span class="line">          &quot;show&quot;: true</span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      &quot;yaxis&quot;: &#123;</span><br><span class="line">        &quot;align&quot;: false,</span><br><span class="line">        &quot;alignLevel&quot;: null</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;aliasColors&quot;: &#123;&#125;,</span><br><span class="line">      &quot;bars&quot;: false,</span><br><span class="line">      &quot;dashLength&quot;: 10,</span><br><span class="line">      &quot;dashes&quot;: false,</span><br><span class="line">      &quot;datasource&quot;: &quot;$&#123;DS_PROMETHEUS&#125;&quot;,</span><br><span class="line">      &quot;decimals&quot;: 2,</span><br><span class="line">      &quot;editable&quot;: true,</span><br><span class="line">      &quot;error&quot;: false,</span><br><span class="line">      &quot;fill&quot;: 1,</span><br><span class="line">      &quot;grid&quot;: &#123;&#125;,</span><br><span class="line">      &quot;gridPos&quot;: &#123;</span><br><span class="line">        &quot;h&quot;: 7,</span><br><span class="line">        &quot;w&quot;: 8,</span><br><span class="line">        &quot;x&quot;: 16,</span><br><span class="line">        &quot;y&quot;: 0</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;id&quot;: 1,</span><br><span class="line">      &quot;isNew&quot;: true,</span><br><span class="line">      &quot;legend&quot;: &#123;</span><br><span class="line">        &quot;avg&quot;: false,</span><br><span class="line">        &quot;current&quot;: false,</span><br><span class="line">        &quot;max&quot;: false,</span><br><span class="line">        &quot;min&quot;: false,</span><br><span class="line">        &quot;show&quot;: false,</span><br><span class="line">        &quot;total&quot;: false,</span><br><span class="line">        &quot;values&quot;: false</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;lines&quot;: true,</span><br><span class="line">      &quot;linewidth&quot;: 2,</span><br><span class="line">      &quot;links&quot;: [],</span><br><span class="line">      &quot;nullPointMode&quot;: &quot;connected&quot;,</span><br><span class="line">      &quot;percentage&quot;: true,</span><br><span class="line">      &quot;pointradius&quot;: 5,</span><br><span class="line">      &quot;points&quot;: false,</span><br><span class="line">      &quot;renderer&quot;: &quot;flot&quot;,</span><br><span class="line">      &quot;seriesOverrides&quot;: [],</span><br><span class="line">      &quot;spaceLength&quot;: 10,</span><br><span class="line">      &quot;stack&quot;: false,</span><br><span class="line">      &quot;steppedLine&quot;: false,</span><br><span class="line">      &quot;targets&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;expr&quot;: &quot;irate(redis_keyspace_hits_total&#123;instance=\&quot;$instance\&quot;&#125;[5m])&quot;,</span><br><span class="line">          &quot;format&quot;: &quot;time_series&quot;,</span><br><span class="line">          &quot;hide&quot;: false,</span><br><span class="line">          &quot;interval&quot;: &quot;&quot;,</span><br><span class="line">          &quot;intervalFactor&quot;: 2,</span><br><span class="line">          &quot;legendFormat&quot;: &quot;hits&quot;,</span><br><span class="line">          &quot;metric&quot;: &quot;&quot;,</span><br><span class="line">          &quot;refId&quot;: &quot;A&quot;,</span><br><span class="line">          &quot;step&quot;: 240,</span><br><span class="line">          &quot;target&quot;: &quot;&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;expr&quot;: &quot;irate(redis_keyspace_misses_total&#123;instance=\&quot;$instance\&quot;&#125;[5m])&quot;,</span><br><span class="line">          &quot;format&quot;: &quot;time_series&quot;,</span><br><span class="line">          &quot;hide&quot;: false,</span><br><span class="line">          &quot;interval&quot;: &quot;&quot;,</span><br><span class="line">          &quot;intervalFactor&quot;: 2,</span><br><span class="line">          &quot;legendFormat&quot;: &quot;misses&quot;,</span><br><span class="line">          &quot;metric&quot;: &quot;&quot;,</span><br><span class="line">          &quot;refId&quot;: &quot;B&quot;,</span><br><span class="line">          &quot;step&quot;: 240,</span><br><span class="line">          &quot;target&quot;: &quot;&quot;</span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      &quot;thresholds&quot;: [],</span><br><span class="line">      &quot;timeFrom&quot;: null,</span><br><span class="line">      &quot;timeRegions&quot;: [],</span><br><span class="line">      &quot;timeShift&quot;: null,</span><br><span class="line">      &quot;title&quot;: &quot;Hits / Misses per Sec&quot;,</span><br><span class="line">      &quot;tooltip&quot;: &#123;</span><br><span class="line">        &quot;msResolution&quot;: false,</span><br><span class="line">        &quot;shared&quot;: true,</span><br><span class="line">        &quot;sort&quot;: 0,</span><br><span class="line">        &quot;value_type&quot;: &quot;individual&quot;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;type&quot;: &quot;graph&quot;,</span><br><span class="line">      &quot;xaxis&quot;: &#123;</span><br><span class="line">        &quot;buckets&quot;: null,</span><br><span class="line">        &quot;mode&quot;: &quot;time&quot;,</span><br><span class="line">        &quot;name&quot;: null,</span><br><span class="line">        &quot;show&quot;: true,</span><br><span class="line">        &quot;values&quot;: []</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;yaxes&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;format&quot;: &quot;short&quot;,</span><br><span class="line">          &quot;label&quot;: &quot;&quot;,</span><br><span class="line">          &quot;logBase&quot;: 1,</span><br><span class="line">          &quot;max&quot;: null,</span><br><span class="line">          &quot;min&quot;: 0,</span><br><span class="line">          &quot;show&quot;: true</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;format&quot;: &quot;short&quot;,</span><br><span class="line">          &quot;label&quot;: null,</span><br><span class="line">          &quot;logBase&quot;: 1,</span><br><span class="line">          &quot;max&quot;: null,</span><br><span class="line">          &quot;min&quot;: null,</span><br><span class="line">          &quot;show&quot;: true</span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      &quot;yaxis&quot;: &#123;</span><br><span class="line">        &quot;align&quot;: false,</span><br><span class="line">        &quot;alignLevel&quot;: null</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;aliasColors&quot;: &#123;</span><br><span class="line">        &quot;max&quot;: &quot;#BF1B00&quot;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;bars&quot;: false,</span><br><span class="line">      &quot;dashLength&quot;: 10,</span><br><span class="line">      &quot;dashes&quot;: false,</span><br><span class="line">      &quot;datasource&quot;: &quot;$&#123;DS_PROMETHEUS&#125;&quot;,</span><br><span class="line">      &quot;editable&quot;: true,</span><br><span class="line">      &quot;error&quot;: false,</span><br><span class="line">      &quot;fill&quot;: 1,</span><br><span class="line">      &quot;grid&quot;: &#123;&#125;,</span><br><span class="line">      &quot;gridPos&quot;: &#123;</span><br><span class="line">        &quot;h&quot;: 7,</span><br><span class="line">        &quot;w&quot;: 12,</span><br><span class="line">        &quot;x&quot;: 0,</span><br><span class="line">        &quot;y&quot;: 7</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;id&quot;: 7,</span><br><span class="line">      &quot;isNew&quot;: true,</span><br><span class="line">      &quot;legend&quot;: &#123;</span><br><span class="line">        &quot;avg&quot;: false,</span><br><span class="line">        &quot;current&quot;: false,</span><br><span class="line">        &quot;hideEmpty&quot;: false,</span><br><span class="line">        &quot;hideZero&quot;: false,</span><br><span class="line">        &quot;max&quot;: false,</span><br><span class="line">        &quot;min&quot;: false,</span><br><span class="line">        &quot;show&quot;: true,</span><br><span class="line">        &quot;total&quot;: false,</span><br><span class="line">        &quot;values&quot;: false</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;lines&quot;: true,</span><br><span class="line">      &quot;linewidth&quot;: 2,</span><br><span class="line">      &quot;links&quot;: [],</span><br><span class="line">      &quot;nullPointMode&quot;: &quot;null as zero&quot;,</span><br><span class="line">      &quot;percentage&quot;: false,</span><br><span class="line">      &quot;pointradius&quot;: 5,</span><br><span class="line">      &quot;points&quot;: false,</span><br><span class="line">      &quot;renderer&quot;: &quot;flot&quot;,</span><br><span class="line">      &quot;seriesOverrides&quot;: [],</span><br><span class="line">      &quot;spaceLength&quot;: 10,</span><br><span class="line">      &quot;stack&quot;: false,</span><br><span class="line">      &quot;steppedLine&quot;: false,</span><br><span class="line">      &quot;targets&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;expr&quot;: &quot;redis_memory_used_bytes&#123;instance=~\&quot;$instance\&quot;&#125; &quot;,</span><br><span class="line">          &quot;format&quot;: &quot;time_series&quot;,</span><br><span class="line">          &quot;intervalFactor&quot;: 2,</span><br><span class="line">          &quot;legendFormat&quot;: &quot;used&quot;,</span><br><span class="line">          &quot;metric&quot;: &quot;&quot;,</span><br><span class="line">          &quot;refId&quot;: &quot;A&quot;,</span><br><span class="line">          &quot;step&quot;: 240,</span><br><span class="line">          &quot;target&quot;: &quot;&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;expr&quot;: &quot;redis_config_maxmemory&#123;instance=~\&quot;$instance\&quot;&#125; &quot;,</span><br><span class="line">          &quot;format&quot;: &quot;time_series&quot;,</span><br><span class="line">          &quot;hide&quot;: false,</span><br><span class="line">          &quot;intervalFactor&quot;: 2,</span><br><span class="line">          &quot;legendFormat&quot;: &quot;max&quot;,</span><br><span class="line">          &quot;refId&quot;: &quot;B&quot;,</span><br><span class="line">          &quot;step&quot;: 240</span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      &quot;thresholds&quot;: [],</span><br><span class="line">      &quot;timeFrom&quot;: null,</span><br><span class="line">      &quot;timeRegions&quot;: [],</span><br><span class="line">      &quot;timeShift&quot;: null,</span><br><span class="line">      &quot;title&quot;: &quot;Total Memory Usage&quot;,</span><br><span class="line">      &quot;tooltip&quot;: &#123;</span><br><span class="line">        &quot;msResolution&quot;: false,</span><br><span class="line">        &quot;shared&quot;: true,</span><br><span class="line">        &quot;sort&quot;: 0,</span><br><span class="line">        &quot;value_type&quot;: &quot;cumulative&quot;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;type&quot;: &quot;graph&quot;,</span><br><span class="line">      &quot;xaxis&quot;: &#123;</span><br><span class="line">        &quot;buckets&quot;: null,</span><br><span class="line">        &quot;mode&quot;: &quot;time&quot;,</span><br><span class="line">        &quot;name&quot;: null,</span><br><span class="line">        &quot;show&quot;: true,</span><br><span class="line">        &quot;values&quot;: []</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;yaxes&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;format&quot;: &quot;bytes&quot;,</span><br><span class="line">          &quot;label&quot;: null,</span><br><span class="line">          &quot;logBase&quot;: 1,</span><br><span class="line">          &quot;max&quot;: null,</span><br><span class="line">          &quot;min&quot;: 0,</span><br><span class="line">          &quot;show&quot;: true</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;format&quot;: &quot;short&quot;,</span><br><span class="line">          &quot;label&quot;: null,</span><br><span class="line">          &quot;logBase&quot;: 1,</span><br><span class="line">          &quot;max&quot;: null,</span><br><span class="line">          &quot;min&quot;: null,</span><br><span class="line">          &quot;show&quot;: true</span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      &quot;yaxis&quot;: &#123;</span><br><span class="line">        &quot;align&quot;: false,</span><br><span class="line">        &quot;alignLevel&quot;: null</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;aliasColors&quot;: &#123;&#125;,</span><br><span class="line">      &quot;bars&quot;: false,</span><br><span class="line">      &quot;dashLength&quot;: 10,</span><br><span class="line">      &quot;dashes&quot;: false,</span><br><span class="line">      &quot;datasource&quot;: &quot;$&#123;DS_PROMETHEUS&#125;&quot;,</span><br><span class="line">      &quot;editable&quot;: true,</span><br><span class="line">      &quot;error&quot;: false,</span><br><span class="line">      &quot;fill&quot;: 1,</span><br><span class="line">      &quot;grid&quot;: &#123;&#125;,</span><br><span class="line">      &quot;gridPos&quot;: &#123;</span><br><span class="line">        &quot;h&quot;: 7,</span><br><span class="line">        &quot;w&quot;: 12,</span><br><span class="line">        &quot;x&quot;: 12,</span><br><span class="line">        &quot;y&quot;: 7</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;id&quot;: 10,</span><br><span class="line">      &quot;isNew&quot;: true,</span><br><span class="line">      &quot;legend&quot;: &#123;</span><br><span class="line">        &quot;avg&quot;: false,</span><br><span class="line">        &quot;current&quot;: false,</span><br><span class="line">        &quot;max&quot;: false,</span><br><span class="line">        &quot;min&quot;: false,</span><br><span class="line">        &quot;show&quot;: true,</span><br><span class="line">        &quot;total&quot;: false,</span><br><span class="line">        &quot;values&quot;: false</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;lines&quot;: true,</span><br><span class="line">      &quot;linewidth&quot;: 2,</span><br><span class="line">      &quot;links&quot;: [],</span><br><span class="line">      &quot;nullPointMode&quot;: &quot;connected&quot;,</span><br><span class="line">      &quot;percentage&quot;: false,</span><br><span class="line">      &quot;pointradius&quot;: 5,</span><br><span class="line">      &quot;points&quot;: false,</span><br><span class="line">      &quot;renderer&quot;: &quot;flot&quot;,</span><br><span class="line">      &quot;seriesOverrides&quot;: [],</span><br><span class="line">      &quot;spaceLength&quot;: 10,</span><br><span class="line">      &quot;stack&quot;: false,</span><br><span class="line">      &quot;steppedLine&quot;: false,</span><br><span class="line">      &quot;targets&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;expr&quot;: &quot;rate(redis_net_input_bytes_total&#123;instance=\&quot;$instance\&quot;&#125;[5m])&quot;,</span><br><span class="line">          &quot;format&quot;: &quot;time_series&quot;,</span><br><span class="line">          &quot;intervalFactor&quot;: 2,</span><br><span class="line">          &quot;legendFormat&quot;: &quot;&#123;&#123; input &#125;&#125;&quot;,</span><br><span class="line">          &quot;refId&quot;: &quot;A&quot;,</span><br><span class="line">          &quot;step&quot;: 240</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;expr&quot;: &quot;rate(redis_net_output_bytes_total&#123;instance=\&quot;$instance\&quot;&#125;[5m])&quot;,</span><br><span class="line">          &quot;format&quot;: &quot;time_series&quot;,</span><br><span class="line">          &quot;interval&quot;: &quot;&quot;,</span><br><span class="line">          &quot;intervalFactor&quot;: 2,</span><br><span class="line">          &quot;legendFormat&quot;: &quot;&#123;&#123; output &#125;&#125;&quot;,</span><br><span class="line">          &quot;refId&quot;: &quot;B&quot;,</span><br><span class="line">          &quot;step&quot;: 240</span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      &quot;thresholds&quot;: [],</span><br><span class="line">      &quot;timeFrom&quot;: null,</span><br><span class="line">      &quot;timeRegions&quot;: [],</span><br><span class="line">      &quot;timeShift&quot;: null,</span><br><span class="line">      &quot;title&quot;: &quot;Network I/O&quot;,</span><br><span class="line">      &quot;tooltip&quot;: &#123;</span><br><span class="line">        &quot;msResolution&quot;: true,</span><br><span class="line">        &quot;shared&quot;: true,</span><br><span class="line">        &quot;sort&quot;: 0,</span><br><span class="line">        &quot;value_type&quot;: &quot;cumulative&quot;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;type&quot;: &quot;graph&quot;,</span><br><span class="line">      &quot;xaxis&quot;: &#123;</span><br><span class="line">        &quot;buckets&quot;: null,</span><br><span class="line">        &quot;mode&quot;: &quot;time&quot;,</span><br><span class="line">        &quot;name&quot;: null,</span><br><span class="line">        &quot;show&quot;: true,</span><br><span class="line">        &quot;values&quot;: []</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;yaxes&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;format&quot;: &quot;bytes&quot;,</span><br><span class="line">          &quot;label&quot;: null,</span><br><span class="line">          &quot;logBase&quot;: 1,</span><br><span class="line">          &quot;max&quot;: null,</span><br><span class="line">          &quot;min&quot;: null,</span><br><span class="line">          &quot;show&quot;: true</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;format&quot;: &quot;short&quot;,</span><br><span class="line">          &quot;label&quot;: null,</span><br><span class="line">          &quot;logBase&quot;: 1,</span><br><span class="line">          &quot;max&quot;: null,</span><br><span class="line">          &quot;min&quot;: null,</span><br><span class="line">          &quot;show&quot;: true</span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      &quot;yaxis&quot;: &#123;</span><br><span class="line">        &quot;align&quot;: false,</span><br><span class="line">        &quot;alignLevel&quot;: null</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;aliasColors&quot;: &#123;&#125;,</span><br><span class="line">      &quot;bars&quot;: false,</span><br><span class="line">      &quot;dashLength&quot;: 10,</span><br><span class="line">      &quot;dashes&quot;: false,</span><br><span class="line">      &quot;datasource&quot;: &quot;$&#123;DS_PROMETHEUS&#125;&quot;,</span><br><span class="line">      &quot;editable&quot;: true,</span><br><span class="line">      &quot;error&quot;: false,</span><br><span class="line">      &quot;fill&quot;: 7,</span><br><span class="line">      &quot;grid&quot;: &#123;&#125;,</span><br><span class="line">      &quot;gridPos&quot;: &#123;</span><br><span class="line">        &quot;h&quot;: 7,</span><br><span class="line">        &quot;w&quot;: 12,</span><br><span class="line">        &quot;x&quot;: 0,</span><br><span class="line">        &quot;y&quot;: 14</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;id&quot;: 5,</span><br><span class="line">      &quot;isNew&quot;: true,</span><br><span class="line">      &quot;legend&quot;: &#123;</span><br><span class="line">        &quot;alignAsTable&quot;: true,</span><br><span class="line">        &quot;avg&quot;: false,</span><br><span class="line">        &quot;current&quot;: true,</span><br><span class="line">        &quot;max&quot;: false,</span><br><span class="line">        &quot;min&quot;: false,</span><br><span class="line">        &quot;rightSide&quot;: true,</span><br><span class="line">        &quot;show&quot;: true,</span><br><span class="line">        &quot;total&quot;: false,</span><br><span class="line">        &quot;values&quot;: true</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;lines&quot;: true,</span><br><span class="line">      &quot;linewidth&quot;: 2,</span><br><span class="line">      &quot;links&quot;: [],</span><br><span class="line">      &quot;nullPointMode&quot;: &quot;connected&quot;,</span><br><span class="line">      &quot;percentage&quot;: false,</span><br><span class="line">      &quot;pointradius&quot;: 5,</span><br><span class="line">      &quot;points&quot;: false,</span><br><span class="line">      &quot;renderer&quot;: &quot;flot&quot;,</span><br><span class="line">      &quot;seriesOverrides&quot;: [],</span><br><span class="line">      &quot;spaceLength&quot;: 10,</span><br><span class="line">      &quot;stack&quot;: true,</span><br><span class="line">      &quot;steppedLine&quot;: false,</span><br><span class="line">      &quot;targets&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;expr&quot;: &quot;sum (redis_db_keys&#123;instance=~\&quot;$instance\&quot;&#125;) by (db)&quot;,</span><br><span class="line">          &quot;format&quot;: &quot;time_series&quot;,</span><br><span class="line">          &quot;interval&quot;: &quot;&quot;,</span><br><span class="line">          &quot;intervalFactor&quot;: 2,</span><br><span class="line">          &quot;legendFormat&quot;: &quot;&#123;&#123; db &#125;&#125; &quot;,</span><br><span class="line">          &quot;refId&quot;: &quot;A&quot;,</span><br><span class="line">          &quot;step&quot;: 240,</span><br><span class="line">          &quot;target&quot;: &quot;&quot;</span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      &quot;thresholds&quot;: [],</span><br><span class="line">      &quot;timeFrom&quot;: null,</span><br><span class="line">      &quot;timeRegions&quot;: [],</span><br><span class="line">      &quot;timeShift&quot;: null,</span><br><span class="line">      &quot;title&quot;: &quot;Total Items per DB&quot;,</span><br><span class="line">      &quot;tooltip&quot;: &#123;</span><br><span class="line">        &quot;msResolution&quot;: false,</span><br><span class="line">        &quot;shared&quot;: true,</span><br><span class="line">        &quot;sort&quot;: 0,</span><br><span class="line">        &quot;value_type&quot;: &quot;individual&quot;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;type&quot;: &quot;graph&quot;,</span><br><span class="line">      &quot;xaxis&quot;: &#123;</span><br><span class="line">        &quot;buckets&quot;: null,</span><br><span class="line">        &quot;mode&quot;: &quot;time&quot;,</span><br><span class="line">        &quot;name&quot;: null,</span><br><span class="line">        &quot;show&quot;: true,</span><br><span class="line">        &quot;values&quot;: []</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;yaxes&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;format&quot;: &quot;none&quot;,</span><br><span class="line">          &quot;label&quot;: null,</span><br><span class="line">          &quot;logBase&quot;: 1,</span><br><span class="line">          &quot;max&quot;: null,</span><br><span class="line">          &quot;min&quot;: null,</span><br><span class="line">          &quot;show&quot;: true</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;format&quot;: &quot;short&quot;,</span><br><span class="line">          &quot;label&quot;: null,</span><br><span class="line">          &quot;logBase&quot;: 1,</span><br><span class="line">          &quot;max&quot;: null,</span><br><span class="line">          &quot;min&quot;: null,</span><br><span class="line">          &quot;show&quot;: true</span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      &quot;yaxis&quot;: &#123;</span><br><span class="line">        &quot;align&quot;: false,</span><br><span class="line">        &quot;alignLevel&quot;: null</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;aliasColors&quot;: &#123;&#125;,</span><br><span class="line">      &quot;bars&quot;: false,</span><br><span class="line">      &quot;dashLength&quot;: 10,</span><br><span class="line">      &quot;dashes&quot;: false,</span><br><span class="line">      &quot;datasource&quot;: &quot;$&#123;DS_PROMETHEUS&#125;&quot;,</span><br><span class="line">      &quot;editable&quot;: true,</span><br><span class="line">      &quot;error&quot;: false,</span><br><span class="line">      &quot;fill&quot;: 7,</span><br><span class="line">      &quot;grid&quot;: &#123;&#125;,</span><br><span class="line">      &quot;gridPos&quot;: &#123;</span><br><span class="line">        &quot;h&quot;: 7,</span><br><span class="line">        &quot;w&quot;: 12,</span><br><span class="line">        &quot;x&quot;: 12,</span><br><span class="line">        &quot;y&quot;: 14</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;id&quot;: 13,</span><br><span class="line">      &quot;isNew&quot;: true,</span><br><span class="line">      &quot;legend&quot;: &#123;</span><br><span class="line">        &quot;avg&quot;: false,</span><br><span class="line">        &quot;current&quot;: false,</span><br><span class="line">        &quot;max&quot;: false,</span><br><span class="line">        &quot;min&quot;: false,</span><br><span class="line">        &quot;show&quot;: true,</span><br><span class="line">        &quot;total&quot;: false,</span><br><span class="line">        &quot;values&quot;: false</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;lines&quot;: true,</span><br><span class="line">      &quot;linewidth&quot;: 2,</span><br><span class="line">      &quot;links&quot;: [],</span><br><span class="line">      &quot;nullPointMode&quot;: &quot;connected&quot;,</span><br><span class="line">      &quot;percentage&quot;: false,</span><br><span class="line">      &quot;pointradius&quot;: 5,</span><br><span class="line">      &quot;points&quot;: false,</span><br><span class="line">      &quot;renderer&quot;: &quot;flot&quot;,</span><br><span class="line">      &quot;seriesOverrides&quot;: [],</span><br><span class="line">      &quot;spaceLength&quot;: 10,</span><br><span class="line">      &quot;stack&quot;: true,</span><br><span class="line">      &quot;steppedLine&quot;: false,</span><br><span class="line">      &quot;targets&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;expr&quot;: &quot;sum (redis_db_keys&#123;instance=~\&quot;$instance\&quot;&#125;) - sum (redis_db_keys_expiring&#123;instance=~\&quot;$instance\&quot;&#125;) &quot;,</span><br><span class="line">          &quot;format&quot;: &quot;time_series&quot;,</span><br><span class="line">          &quot;interval&quot;: &quot;&quot;,</span><br><span class="line">          &quot;intervalFactor&quot;: 2,</span><br><span class="line">          &quot;legendFormat&quot;: &quot;not expiring&quot;,</span><br><span class="line">          &quot;refId&quot;: &quot;A&quot;,</span><br><span class="line">          &quot;step&quot;: 240,</span><br><span class="line">          &quot;target&quot;: &quot;&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;expr&quot;: &quot;sum (redis_db_keys_expiring&#123;instance=~\&quot;$instance\&quot;&#125;) &quot;,</span><br><span class="line">          &quot;format&quot;: &quot;time_series&quot;,</span><br><span class="line">          &quot;interval&quot;: &quot;&quot;,</span><br><span class="line">          &quot;intervalFactor&quot;: 2,</span><br><span class="line">          &quot;legendFormat&quot;: &quot;expiring&quot;,</span><br><span class="line">          &quot;metric&quot;: &quot;&quot;,</span><br><span class="line">          &quot;refId&quot;: &quot;B&quot;,</span><br><span class="line">          &quot;step&quot;: 240</span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      &quot;thresholds&quot;: [],</span><br><span class="line">      &quot;timeFrom&quot;: null,</span><br><span class="line">      &quot;timeRegions&quot;: [],</span><br><span class="line">      &quot;timeShift&quot;: null,</span><br><span class="line">      &quot;title&quot;: &quot;Expiring vs Not-Expiring Keys&quot;,</span><br><span class="line">      &quot;tooltip&quot;: &#123;</span><br><span class="line">        &quot;msResolution&quot;: false,</span><br><span class="line">        &quot;shared&quot;: true,</span><br><span class="line">        &quot;sort&quot;: 0,</span><br><span class="line">        &quot;value_type&quot;: &quot;individual&quot;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;type&quot;: &quot;graph&quot;,</span><br><span class="line">      &quot;xaxis&quot;: &#123;</span><br><span class="line">        &quot;buckets&quot;: null,</span><br><span class="line">        &quot;mode&quot;: &quot;time&quot;,</span><br><span class="line">        &quot;name&quot;: null,</span><br><span class="line">        &quot;show&quot;: true,</span><br><span class="line">        &quot;values&quot;: []</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;yaxes&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;format&quot;: &quot;short&quot;,</span><br><span class="line">          &quot;label&quot;: null,</span><br><span class="line">          &quot;logBase&quot;: 1,</span><br><span class="line">          &quot;max&quot;: null,</span><br><span class="line">          &quot;min&quot;: null,</span><br><span class="line">          &quot;show&quot;: true</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;format&quot;: &quot;short&quot;,</span><br><span class="line">          &quot;label&quot;: null,</span><br><span class="line">          &quot;logBase&quot;: 1,</span><br><span class="line">          &quot;max&quot;: null,</span><br><span class="line">          &quot;min&quot;: null,</span><br><span class="line">          &quot;show&quot;: true</span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      &quot;yaxis&quot;: &#123;</span><br><span class="line">        &quot;align&quot;: false,</span><br><span class="line">        &quot;alignLevel&quot;: null</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;aliasColors&quot;: &#123;</span><br><span class="line">        &quot;evicts&quot;: &quot;#890F02&quot;,</span><br><span class="line">        &quot;memcached_items_evicted_total&#123;instance=\&quot;172.17.0.1:9150\&quot;,job=\&quot;prometheus\&quot;&#125;&quot;: &quot;#890F02&quot;,</span><br><span class="line">        &quot;reclaims&quot;: &quot;#3F6833&quot;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;bars&quot;: false,</span><br><span class="line">      &quot;dashLength&quot;: 10,</span><br><span class="line">      &quot;dashes&quot;: false,</span><br><span class="line">      &quot;datasource&quot;: &quot;$&#123;DS_PROMETHEUS&#125;&quot;,</span><br><span class="line">      &quot;editable&quot;: true,</span><br><span class="line">      &quot;error&quot;: false,</span><br><span class="line">      &quot;fill&quot;: 1,</span><br><span class="line">      &quot;grid&quot;: &#123;&#125;,</span><br><span class="line">      &quot;gridPos&quot;: &#123;</span><br><span class="line">        &quot;h&quot;: 7,</span><br><span class="line">        &quot;w&quot;: 12,</span><br><span class="line">        &quot;x&quot;: 0,</span><br><span class="line">        &quot;y&quot;: 21</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;id&quot;: 8,</span><br><span class="line">      &quot;isNew&quot;: true,</span><br><span class="line">      &quot;legend&quot;: &#123;</span><br><span class="line">        &quot;avg&quot;: false,</span><br><span class="line">        &quot;current&quot;: false,</span><br><span class="line">        &quot;max&quot;: false,</span><br><span class="line">        &quot;min&quot;: false,</span><br><span class="line">        &quot;show&quot;: true,</span><br><span class="line">        &quot;total&quot;: false,</span><br><span class="line">        &quot;values&quot;: false</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;lines&quot;: true,</span><br><span class="line">      &quot;linewidth&quot;: 2,</span><br><span class="line">      &quot;links&quot;: [],</span><br><span class="line">      &quot;nullPointMode&quot;: &quot;connected&quot;,</span><br><span class="line">      &quot;percentage&quot;: false,</span><br><span class="line">      &quot;pointradius&quot;: 5,</span><br><span class="line">      &quot;points&quot;: false,</span><br><span class="line">      &quot;renderer&quot;: &quot;flot&quot;,</span><br><span class="line">      &quot;seriesOverrides&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;alias&quot;: &quot;reclaims&quot;,</span><br><span class="line">          &quot;yaxis&quot;: 2</span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      &quot;spaceLength&quot;: 10,</span><br><span class="line">      &quot;stack&quot;: false,</span><br><span class="line">      &quot;steppedLine&quot;: false,</span><br><span class="line">      &quot;targets&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;expr&quot;: &quot;sum(rate(redis_expired_keys_total&#123;instance=~\&quot;$instance\&quot;&#125;[5m])) by (instance)&quot;,</span><br><span class="line">          &quot;format&quot;: &quot;time_series&quot;,</span><br><span class="line">          &quot;interval&quot;: &quot;&quot;,</span><br><span class="line">          &quot;intervalFactor&quot;: 2,</span><br><span class="line">          &quot;legendFormat&quot;: &quot;expired&quot;,</span><br><span class="line">          &quot;metric&quot;: &quot;&quot;,</span><br><span class="line">          &quot;refId&quot;: &quot;A&quot;,</span><br><span class="line">          &quot;step&quot;: 240,</span><br><span class="line">          &quot;target&quot;: &quot;&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;expr&quot;: &quot;sum(rate(redis_evicted_keys_total&#123;instance=~\&quot;$instance\&quot;&#125;[5m])) by (instance)&quot;,</span><br><span class="line">          &quot;format&quot;: &quot;time_series&quot;,</span><br><span class="line">          &quot;interval&quot;: &quot;&quot;,</span><br><span class="line">          &quot;intervalFactor&quot;: 2,</span><br><span class="line">          &quot;legendFormat&quot;: &quot;evicted&quot;,</span><br><span class="line">          &quot;refId&quot;: &quot;B&quot;,</span><br><span class="line">          &quot;step&quot;: 240</span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      &quot;thresholds&quot;: [],</span><br><span class="line">      &quot;timeFrom&quot;: null,</span><br><span class="line">      &quot;timeRegions&quot;: [],</span><br><span class="line">      &quot;timeShift&quot;: null,</span><br><span class="line">      &quot;title&quot;: &quot;Expired / Evicted&quot;,</span><br><span class="line">      &quot;tooltip&quot;: &#123;</span><br><span class="line">        &quot;msResolution&quot;: false,</span><br><span class="line">        &quot;shared&quot;: true,</span><br><span class="line">        &quot;sort&quot;: 0,</span><br><span class="line">        &quot;value_type&quot;: &quot;cumulative&quot;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;type&quot;: &quot;graph&quot;,</span><br><span class="line">      &quot;xaxis&quot;: &#123;</span><br><span class="line">        &quot;buckets&quot;: null,</span><br><span class="line">        &quot;mode&quot;: &quot;time&quot;,</span><br><span class="line">        &quot;name&quot;: null,</span><br><span class="line">        &quot;show&quot;: true,</span><br><span class="line">        &quot;values&quot;: []</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;yaxes&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;format&quot;: &quot;short&quot;,</span><br><span class="line">          &quot;label&quot;: null,</span><br><span class="line">          &quot;logBase&quot;: 1,</span><br><span class="line">          &quot;max&quot;: null,</span><br><span class="line">          &quot;min&quot;: null,</span><br><span class="line">          &quot;show&quot;: true</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;format&quot;: &quot;short&quot;,</span><br><span class="line">          &quot;label&quot;: null,</span><br><span class="line">          &quot;logBase&quot;: 1,</span><br><span class="line">          &quot;max&quot;: null,</span><br><span class="line">          &quot;min&quot;: null,</span><br><span class="line">          &quot;show&quot;: true</span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      &quot;yaxis&quot;: &#123;</span><br><span class="line">        &quot;align&quot;: false,</span><br><span class="line">        &quot;alignLevel&quot;: null</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;aliasColors&quot;: &#123;&#125;,</span><br><span class="line">      &quot;bars&quot;: false,</span><br><span class="line">      &quot;dashLength&quot;: 10,</span><br><span class="line">      &quot;dashes&quot;: false,</span><br><span class="line">      &quot;datasource&quot;: &quot;$&#123;DS_PROMETHEUS&#125;&quot;,</span><br><span class="line">      &quot;editable&quot;: true,</span><br><span class="line">      &quot;error&quot;: false,</span><br><span class="line">      &quot;fill&quot;: 8,</span><br><span class="line">      &quot;grid&quot;: &#123;&#125;,</span><br><span class="line">      &quot;gridPos&quot;: &#123;</span><br><span class="line">        &quot;h&quot;: 7,</span><br><span class="line">        &quot;w&quot;: 12,</span><br><span class="line">        &quot;x&quot;: 12,</span><br><span class="line">        &quot;y&quot;: 21</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;id&quot;: 14,</span><br><span class="line">      &quot;isNew&quot;: true,</span><br><span class="line">      &quot;legend&quot;: &#123;</span><br><span class="line">        &quot;avg&quot;: false,</span><br><span class="line">        &quot;current&quot;: false,</span><br><span class="line">        &quot;max&quot;: false,</span><br><span class="line">        &quot;min&quot;: false,</span><br><span class="line">        &quot;show&quot;: true,</span><br><span class="line">        &quot;total&quot;: false,</span><br><span class="line">        &quot;values&quot;: false</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;lines&quot;: true,</span><br><span class="line">      &quot;linewidth&quot;: 1,</span><br><span class="line">      &quot;links&quot;: [],</span><br><span class="line">      &quot;nullPointMode&quot;: &quot;connected&quot;,</span><br><span class="line">      &quot;percentage&quot;: false,</span><br><span class="line">      &quot;pointradius&quot;: 5,</span><br><span class="line">      &quot;points&quot;: false,</span><br><span class="line">      &quot;renderer&quot;: &quot;flot&quot;,</span><br><span class="line">      &quot;seriesOverrides&quot;: [],</span><br><span class="line">      &quot;spaceLength&quot;: 10,</span><br><span class="line">      &quot;stack&quot;: true,</span><br><span class="line">      &quot;steppedLine&quot;: false,</span><br><span class="line">      &quot;targets&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;expr&quot;: &quot;topk(5, irate(redis_commands_duration_seconds_total&#123;instance=~\&quot;$instance\&quot;&#125; [1m]))&quot;,</span><br><span class="line">          &quot;format&quot;: &quot;time_series&quot;,</span><br><span class="line">          &quot;interval&quot;: &quot;&quot;,</span><br><span class="line">          &quot;intervalFactor&quot;: 2,</span><br><span class="line">          &quot;legendFormat&quot;: &quot;&#123;&#123; cmd &#125;&#125;&quot;,</span><br><span class="line">          &quot;metric&quot;: &quot;redis_command_calls_total&quot;,</span><br><span class="line">          &quot;refId&quot;: &quot;A&quot;,</span><br><span class="line">          &quot;step&quot;: 240</span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      &quot;thresholds&quot;: [],</span><br><span class="line">      &quot;timeFrom&quot;: null,</span><br><span class="line">      &quot;timeRegions&quot;: [],</span><br><span class="line">      &quot;timeShift&quot;: null,</span><br><span class="line">      &quot;title&quot;: &quot;Command Calls / sec&quot;,</span><br><span class="line">      &quot;tooltip&quot;: &#123;</span><br><span class="line">        &quot;msResolution&quot;: true,</span><br><span class="line">        &quot;shared&quot;: true,</span><br><span class="line">        &quot;sort&quot;: 0,</span><br><span class="line">        &quot;value_type&quot;: &quot;cumulative&quot;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;type&quot;: &quot;graph&quot;,</span><br><span class="line">      &quot;xaxis&quot;: &#123;</span><br><span class="line">        &quot;buckets&quot;: null,</span><br><span class="line">        &quot;mode&quot;: &quot;time&quot;,</span><br><span class="line">        &quot;name&quot;: null,</span><br><span class="line">        &quot;show&quot;: true,</span><br><span class="line">        &quot;values&quot;: []</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;yaxes&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;format&quot;: &quot;short&quot;,</span><br><span class="line">          &quot;label&quot;: null,</span><br><span class="line">          &quot;logBase&quot;: 1,</span><br><span class="line">          &quot;max&quot;: null,</span><br><span class="line">          &quot;min&quot;: null,</span><br><span class="line">          &quot;show&quot;: true</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;format&quot;: &quot;short&quot;,</span><br><span class="line">          &quot;label&quot;: null,</span><br><span class="line">          &quot;logBase&quot;: 1,</span><br><span class="line">          &quot;max&quot;: null,</span><br><span class="line">          &quot;min&quot;: null,</span><br><span class="line">          &quot;show&quot;: true</span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      &quot;yaxis&quot;: &#123;</span><br><span class="line">        &quot;align&quot;: false,</span><br><span class="line">        &quot;alignLevel&quot;: null</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  &quot;refresh&quot;: &quot;30s&quot;,</span><br><span class="line">  &quot;schemaVersion&quot;: 16,</span><br><span class="line">  &quot;style&quot;: &quot;dark&quot;,</span><br><span class="line">  &quot;tags&quot;: [</span><br><span class="line">    &quot;prometheus&quot;,</span><br><span class="line">    &quot;redis&quot;</span><br><span class="line">  ],</span><br><span class="line">  &quot;templating&quot;: &#123;</span><br><span class="line">    &quot;list&quot;: [</span><br><span class="line">      &#123;</span><br><span class="line">        &quot;allValue&quot;: null,</span><br><span class="line">        &quot;current&quot;: &#123;&#125;,</span><br><span class="line">        &quot;datasource&quot;: &quot;$&#123;DS_PROMETHEUS&#125;&quot;,</span><br><span class="line">        &quot;definition&quot;: &quot;label_values(redis_connected_clients, instance)&quot;,</span><br><span class="line">        &quot;hide&quot;: 0,</span><br><span class="line">        &quot;includeAll&quot;: false,</span><br><span class="line">        &quot;label&quot;: null,</span><br><span class="line">        &quot;multi&quot;: false,</span><br><span class="line">        &quot;name&quot;: &quot;instance&quot;,</span><br><span class="line">        &quot;options&quot;: [],</span><br><span class="line">        &quot;query&quot;: &quot;label_values(redis_connected_clients, instance)&quot;,</span><br><span class="line">        &quot;refresh&quot;: 1,</span><br><span class="line">        &quot;regex&quot;: &quot;&quot;,</span><br><span class="line">        &quot;skipUrlSync&quot;: false,</span><br><span class="line">        &quot;sort&quot;: 0,</span><br><span class="line">        &quot;tagValuesQuery&quot;: &quot;&quot;,</span><br><span class="line">        &quot;tags&quot;: [],</span><br><span class="line">        &quot;tagsQuery&quot;: &quot;&quot;,</span><br><span class="line">        &quot;type&quot;: &quot;query&quot;,</span><br><span class="line">        &quot;useTags&quot;: false</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;time&quot;: &#123;</span><br><span class="line">    &quot;from&quot;: &quot;now-15m&quot;,</span><br><span class="line">    &quot;to&quot;: &quot;now&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;timepicker&quot;: &#123;</span><br><span class="line">    &quot;refresh_intervals&quot;: [</span><br><span class="line">      &quot;5s&quot;,</span><br><span class="line">      &quot;10s&quot;,</span><br><span class="line">      &quot;30s&quot;,</span><br><span class="line">      &quot;1m&quot;,</span><br><span class="line">      &quot;5m&quot;,</span><br><span class="line">      &quot;15m&quot;,</span><br><span class="line">      &quot;30m&quot;,</span><br><span class="line">      &quot;1h&quot;,</span><br><span class="line">      &quot;2h&quot;,</span><br><span class="line">      &quot;1d&quot;</span><br><span class="line">    ],</span><br><span class="line">    &quot;time_options&quot;: [</span><br><span class="line">      &quot;5m&quot;,</span><br><span class="line">      &quot;15m&quot;,</span><br><span class="line">      &quot;1h&quot;,</span><br><span class="line">      &quot;6h&quot;,</span><br><span class="line">      &quot;12h&quot;,</span><br><span class="line">      &quot;24h&quot;,</span><br><span class="line">      &quot;2d&quot;,</span><br><span class="line">      &quot;7d&quot;,</span><br><span class="line">      &quot;30d&quot;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;timezone&quot;: &quot;browser&quot;,</span><br><span class="line">  &quot;title&quot;: &quot;Redis cluster&quot;,</span><br><span class="line">  &quot;uid&quot;: &quot;ekHEbFvWk&quot;,</span><br><span class="line">  &quot;version&quot;: 9</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://shenshengkun.github.io/images/k8s_redis1.png" alt=""></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;安装redis-exporter&quot;&gt;&lt;a href=&quot;#安装redis-exporter&quot; class=&quot;headerlink&quot; title=&quot;安装redis_exporter&quot;&gt;&lt;/a&gt;安装redis_exporter&lt;/h1&gt;&lt;figure class=&quot;hi
      
    
    </summary>
    
      <category term="k8s" scheme="https://shenshengkun.github.io/categories/k8s/"/>
    
    
  </entry>
  
  <entry>
    <title>prometheus监控mysql集群</title>
    <link href="https://shenshengkun.github.io/posts/24jdja99.html"/>
    <id>https://shenshengkun.github.io/posts/24jdja99.html</id>
    <published>2019-08-01T08:25:01.000Z</published>
    <updated>2019-08-01T08:39:25.370Z</updated>
    
    <content type="html"><![CDATA[<h1 id="安装mysql-exporter"><a href="#安装mysql-exporter" class="headerlink" title="安装mysql_exporter"></a>安装mysql_exporter</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local</span><br><span class="line">wget https://github.com/prometheus/mysqld_exporter/releases/download/v0.12.1/mysqld_exporter-0.12.1.linux-amd64.tar.gz</span><br><span class="line"></span><br><span class="line">tar -zxvf mysqld_exporter-0.12.1.linux-amd64.tar.gz</span><br><span class="line">mv mysqld_exporter-0.12.1.linux-amd64 mysqld_exporter</span><br><span class="line"></span><br><span class="line">mysql的pxc集群添加账号密码：</span><br><span class="line">GRANT REPLICATION CLIENT, PROCESS ON . TO &apos;exporter&apos;@&apos;localhost&apos; identified by &apos;123456&apos;;</span><br><span class="line">GRANT SELECT ON performance_schema.* TO &apos;exporter&apos;@&apos;localhost&apos;;</span><br><span class="line">flush privileges;</span><br><span class="line"></span><br><span class="line">[root@pxc1 mysqld_exporter]# cat .my.cnf </span><br><span class="line">[client]</span><br><span class="line">host=192.168.7.201</span><br><span class="line">user=exporter</span><br><span class="line">password=123456</span><br><span class="line"></span><br><span class="line">启动：</span><br><span class="line">nohup ./mysqld_exporter --config.my-cnf=.my.cnf &amp;</span><br></pre></td></tr></table></figure><h1 id="prometheus配置"><a href="#prometheus配置" class="headerlink" title="prometheus配置"></a>prometheus配置</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"> - job_name: &apos;mysql-cluster&apos;</span><br><span class="line">   static_configs:</span><br><span class="line">   - targets:</span><br><span class="line">     - &apos;192.168.7.201:9104&apos;</span><br><span class="line">     - &apos;192.168.7.202:9104&apos;</span><br><span class="line">     - &apos;192.168.7.203:9104&apos;</span><br><span class="line">     </span><br><span class="line">     </span><br><span class="line">     </span><br><span class="line">报警：</span><br><span class="line">############ mysql 监控 ############</span><br><span class="line">      - alert: MySQLGaleraNotReady</span><br><span class="line">        expr: mysql_global_status_wsrep_ready != 1</span><br><span class="line">        for: 5m</span><br><span class="line">        labels:</span><br><span class="line">          severity: warning</span><br><span class="line">        annotations:</span><br><span class="line">          description: &quot;&#123;&#123;$labels.job&#125;&#125; on &#123;&#123;$labels.instance&#125;&#125; is not ready.&quot;</span><br><span class="line">          summary: &quot;Galera cluster node not ready&quot;</span><br><span class="line">      - alert: MySQLGaleraOutOfSync</span><br><span class="line">        expr: (mysql_global_status_wsrep_local_state != 4 and mysql_global_variables_wsrep_desync == 0)</span><br><span class="line">        for: 5m</span><br><span class="line">        labels:</span><br><span class="line">          severity: warning</span><br><span class="line">        annotations:</span><br><span class="line">          description: &quot;&#123;&#123;$labels.job&#125;&#125; on &#123;&#123;$labels.instance&#125;&#125; is not in sync (&#123;&#123;$value&#125;&#125;!= 4).&quot;</span><br><span class="line">          summary: &quot;Galera cluster node out of sync&quot;</span><br><span class="line">      - alert: MySQL is down</span><br><span class="line">        expr: mysql_up == 0</span><br><span class="line">        for: 1m</span><br><span class="line">        labels:</span><br><span class="line">          severity: critical</span><br><span class="line">        annotations:</span><br><span class="line">          description: &quot;Instance &#123;&#123; $labels.instance &#125;&#125; MySQL is down&quot;</span><br><span class="line">          summary: &quot;MySQL database is down. This requires immediate action!&quot;</span><br><span class="line">      - alert: MySql 连接数超过最大连接数的80%</span><br><span class="line">        expr: mysql_global_status_max_used_connections &gt; mysql_global_variables_max_connections * 0.8</span><br><span class="line">        for: 2m</span><br><span class="line">        labels:</span><br><span class="line">          severity: warning</span><br><span class="line">        annotations:</span><br><span class="line">          description: &quot;Instance &#123;&#123; $labels.instance &#125;&#125; Used more than 80% of max connections limited&quot;</span><br><span class="line">          summary: &quot;Used more than 80% of max connections limited&quot;</span><br></pre></td></tr></table></figure><h1 id="grafana导入模板"><a href="#grafana导入模板" class="headerlink" title="grafana导入模板"></a>grafana导入模板</h1><p><a href="https://grafana.com/grafana/dashboards/7362" target="_blank" rel="noopener">https://grafana.com/grafana/dashboards/7362</a>   mysql<br><a href="https://grafana.com/grafana/dashboards/7377" target="_blank" rel="noopener">https://grafana.com/grafana/dashboards/7377</a>   pxc</p><p><img src="https://shenshengkun.github.io/images/pro_mysql1.png" alt=""></p><p><img src="https://shenshengkun.github.io/images/pro_mysql2.png" alt=""></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;安装mysql-exporter&quot;&gt;&lt;a href=&quot;#安装mysql-exporter&quot; class=&quot;headerlink&quot; title=&quot;安装mysql_exporter&quot;&gt;&lt;/a&gt;安装mysql_exporter&lt;/h1&gt;&lt;figure class=&quot;hi
      
    
    </summary>
    
      <category term="k8s" scheme="https://shenshengkun.github.io/categories/k8s/"/>
    
    
  </entry>
  
  <entry>
    <title>jenkins的pipeline</title>
    <link href="https://shenshengkun.github.io/posts/dld541al.html"/>
    <id>https://shenshengkun.github.io/posts/dld541al.html</id>
    <published>2019-07-31T05:10:01.000Z</published>
    <updated>2019-07-31T05:54:27.466Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Jenkins-Pipeline的总体介绍"><a href="#Jenkins-Pipeline的总体介绍" class="headerlink" title="Jenkins Pipeline的总体介绍"></a>Jenkins Pipeline的总体介绍</h1><p>Jenkins Pipeline 的核心概念：</p><p>Pipeline，简而言之，就是一套运行于Jenkins上的工作流框架，将原本独立运行于单个或者多个节点的任务连接起来，实现单个任务难以完成的复杂流程编排与可视化。</p><p>Pipeline是Jenkins2.X的最核心的特性，帮助Jenkins实现从CI到CD与DevOps的转变</p><p>Pipeline是一组插件，让Jenkins可以实现持续交付管道的落地和实施。</p><p>持续交付管道（CD Pipeline）是将软件从版本控制阶段到交付给用户或客户的完整过程的自动化表现。软件的每一次更改（提交到源代码管理系统）都要经过一个复杂的过程才能被发布。</p><p>Pipeline提供了一组可扩展的工具，通过Pipeline Domain Specific Language（DSL）syntax可以达到Pipeline as Code（Jenkinsfile存储在项目的源代码库）的目的。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Stage：阶段，一个Pipeline可以划分成若干个Stage，每个Stage代表一组操作，例如：“Build”，“Test”，“Deploy”。</span><br><span class="line"></span><br><span class="line">注意，Stage是一个逻辑分组的概念，可以跨多个Node</span><br><span class="line"></span><br><span class="line">Node：节点，一个Node就是一个Jenkins节点，或者是Master，或者是Agent，是执行Step的具体运行环境。</span><br><span class="line"></span><br><span class="line">Step：步骤，Step是最基本的操作单元，小到创建一个目录，大到构建一个Docker镜像，由各类Jenklins Plugin提供，例如：sh ‘make’</span><br></pre></td></tr></table></figure><p>Pipeline五大特性</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">代码:Pipeline以代码的形式实现，通常被检入源代码控制，使团队能够编辑、审查和迭代其CD流程。</span><br><span class="line"></span><br><span class="line">可持续性：Jenklins重启或者中断后都不会影响Pipeline Job。</span><br><span class="line"></span><br><span class="line">停顿：Pipeline可以选择停止并等待任工输入或批准，然后再继续Pipeline运行。</span><br><span class="line"></span><br><span class="line">多功能：Pipeline支持现实世界的复杂CD要求，包括fork/join子进程，循环和并行执行工作的能力</span><br><span class="line"></span><br><span class="line">可扩展：Pipeline插件支持其DSL的自定义扩展以及与其他插件集成的多个选项。</span><br></pre></td></tr></table></figure><h1 id="简单的pipeline"><a href="#简单的pipeline" class="headerlink" title="简单的pipeline"></a>简单的pipeline</h1><p>新建 Job：在 Web UI 中点击 New Item -&gt; 输入名称：pipeline-demo -&gt; 选择下面的 Pipeline -&gt; 点击 OK</p><p>配置：在最下方的 Pipeline 区域输入如下 Script 脚本，然后点击保存。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">node(&apos;jnlp&apos;) &#123;</span><br><span class="line">    stage(&apos;Clone&apos;) &#123;</span><br><span class="line">      echo &quot;1.Clone Stage&quot;</span><br><span class="line">    &#125;</span><br><span class="line">    stage(&apos;Test&apos;) &#123;</span><br><span class="line">      echo &quot;2.Test Stage&quot;</span><br><span class="line">    &#125;</span><br><span class="line">    stage(&apos;Build&apos;) &#123;</span><br><span class="line">      echo &quot;3.Build Stage&quot;</span><br><span class="line">    &#125;</span><br><span class="line">    stage(&apos;Deploy&apos;) &#123;</span><br><span class="line">      echo &quot;4. Deploy Stage&quot;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://shenshengkun.github.io/images/jenkins_pipeline1.png" alt=""></p><p>构建：点击左侧区域的 Build Now，可以看到 Job 开始构建了</p><p><img src="https://shenshengkun.github.io/images/jenkins_pipeline2.png" alt=""></p><p>命令行可以看到：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@node1 jenkins2]# kubectl get pods</span><br><span class="line">NAME                        READY   STATUS    RESTARTS   AGE</span><br><span class="line">busybox                     1/1     Running   309        12d</span><br><span class="line">jenkins2-5f76f7f8b5-hzcqw   1/1     Running   0          16h</span><br><span class="line">jnlp-gd6wz                  1/1     Running   0          69s</span><br><span class="line">[root@node1 jenkins2]# kubectl get pods</span><br><span class="line">NAME                        READY   STATUS    RESTARTS   AGE</span><br><span class="line">busybox                     1/1     Running   309        12d</span><br><span class="line">jenkins2-5f76f7f8b5-hzcqw   1/1     Running   0          16h</span><br></pre></td></tr></table></figure><h1 id="简单golang服务pipeline"><a href="#简单golang服务pipeline" class="headerlink" title="简单golang服务pipeline"></a>简单golang服务pipeline</h1><ul><li>第一步，clone 代码</li><li>第二步，进行测试，如果测试通过了才继续下面的任务</li><li>第三步，由于 Dockerfile 基本上都是放入源码中进行管理的，所以我们这里就是直接构建 Docker 镜像了</li><li>第四步，镜像打包完成，推送到镜像仓库</li><li>第五步，镜像推送完成，更改 YAML 文件中的镜像 TAG 为这次镜像的 TAG</li><li>第六步，使用 kubectl 命令行工具进行部署了</li></ul><p><img src="https://shenshengkun.github.io/images/jenkins_pipeline3.png" alt=""></p><p>script脚本：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">node(&apos;jnlp&apos;) &#123;</span><br><span class="line">    stage(&apos;Clone&apos;) &#123;</span><br><span class="line">        echo &quot;1.Clone Stage&quot;</span><br><span class="line">        git url: &quot;https://github.com/shenshengkun/jenkins-demo.git&quot;</span><br><span class="line">        script &#123;</span><br><span class="line">            build_tag = sh(returnStdout: true, script: &apos;git rev-parse --short HEAD&apos;).trim()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    stage(&apos;Test&apos;) &#123;</span><br><span class="line">      echo &quot;2.Test Stage&quot;</span><br><span class="line">    &#125;</span><br><span class="line">    stage(&apos;Build&apos;) &#123;</span><br><span class="line">        echo &quot;3.Build Docker Image Stage&quot;</span><br><span class="line">        sh &quot;docker build -t registry.gag.cn/private/sy:$&#123;build_tag&#125; .&quot;</span><br><span class="line">    &#125;</span><br><span class="line">    stage(&apos;Push&apos;) &#123;</span><br><span class="line">        echo &quot;4.Push Docker Image Stage&quot;</span><br><span class="line">            sh &quot;docker push registry.gag.cn/private/sy:$&#123;build_tag&#125;&quot;</span><br><span class="line">    &#125;</span><br><span class="line">    stage(&apos;Deploy&apos;) &#123;</span><br><span class="line">        echo &quot;5. Deploy Stage&quot;</span><br><span class="line">        sh &quot;sed -i &apos;s/&lt;BUILD_TAG&gt;/$&#123;build_tag&#125;/&apos; k8s.yaml&quot;</span><br><span class="line">        sh &quot;kubectl apply -f k8s.yaml --record --validate=false&quot;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>build now：</p><p><img src="https://shenshengkun.github.io/images/jenkins_pipeline4.png" alt=""></p><p>Stage View 界面：</p><p><img src="https://shenshengkun.github.io/images/jenkins_pipeline5.png" alt=""></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">[root@node1 jenkins]# kubectl get pods                </span><br><span class="line">NAME                        READY   STATUS    RESTARTS   AGE</span><br><span class="line">busybox                     1/1     Running   313        13d</span><br><span class="line">jenkins2-5f76f7f8b5-hzcqw   1/1     Running   0          19h</span><br><span class="line">jnlp-p6b1b                  1/1     Running   0          3m39s</span><br><span class="line">[root@node1 jenkins]# docker images   </span><br><span class="line">REPOSITORY                                                     TAG                 IMAGE ID            CREATED             SIZE</span><br><span class="line">registry.gag.cn/private/sy                                     c4af501             6c1eb660f5b7        11 seconds ago      258MB</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@node1 jenkins]# kubectl get pods</span><br><span class="line">NAME                           READY   STATUS             RESTARTS   AGE</span><br><span class="line">busybox                        1/1     Running            313        13d</span><br><span class="line">jenkins-demo-c44c8d468-tnrxs   0/1     CrashLoopBackOff   1          11s</span><br><span class="line">jenkins2-5f76f7f8b5-hzcqw      1/1     Running            0          19h</span><br><span class="line">jnlp-p6b1b                     1/1     Running            0          7m42s</span><br><span class="line">[root@node1 jenkins]# kubectl logs -f jenkins-demo-c44c8d468-tnrxs</span><br><span class="line">Hello, sy！I&apos;m from Jenkins CI！</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@node1 jenkins]# kubectl get pods</span><br><span class="line">NAME                           READY   STATUS             RESTARTS   AGE</span><br><span class="line">busybox                        1/1     Running            313        13d</span><br><span class="line">jenkins-demo-c44c8d468-tnrxs   0/1     CrashLoopBackOff   2          41s</span><br><span class="line">jenkins2-5f76f7f8b5-hzcqw      1/1     Running            0          19h</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Jenkins-Pipeline的总体介绍&quot;&gt;&lt;a href=&quot;#Jenkins-Pipeline的总体介绍&quot; class=&quot;headerlink&quot; title=&quot;Jenkins Pipeline的总体介绍&quot;&gt;&lt;/a&gt;Jenkins Pipeline的总体介绍&lt;/
      
    
    </summary>
    
      <category term="k8s" scheme="https://shenshengkun.github.io/categories/k8s/"/>
    
    
  </entry>
  
  <entry>
    <title>k8s部署jenkins动态slave</title>
    <link href="https://shenshengkun.github.io/posts/dkkd644a.html"/>
    <id>https://shenshengkun.github.io/posts/dkkd644a.html</id>
    <published>2019-07-29T07:10:01.000Z</published>
    <updated>2019-07-30T09:35:44.853Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Kubernetes-环境下面使用-Jenkins-有什么好处"><a href="#Kubernetes-环境下面使用-Jenkins-有什么好处" class="headerlink" title="Kubernetes 环境下面使用 Jenkins 有什么好处"></a>Kubernetes 环境下面使用 Jenkins 有什么好处</h1><p>我们知道持续构建与发布是我们日常工作中必不可少的一个步骤，目前大多公司都采用 Jenkins 集群来搭建符合需求的 CI/CD 流程，然而传统的 Jenkins Slave 一主多从方式会存在一些痛点，比如：</p><ul><li>主 Master 发生单点故障时，整个流程都不可用了</li><li>每个 Slave 的配置环境不一样，来完成不同语言的编译打包等操作，但是这些差异化的配置导致管理起来非常不方便，维护起来也是比较费劲</li><li>资源分配不均衡，有的 Slave 要运行的 job 出现排队等待，而有的 Slave 处于空闲状态</li><li>资源有浪费，每台 Slave 可能是物理机或者虚拟机，当 Slave 处于空闲状态时，也不会完全释放掉资源。</li></ul><p>正因为上面的这些种种痛点，我们渴望一种更高效更可靠的方式来完成这个 CI/CD 流程，而 Docker 虚拟化容器技术能很好的解决这个痛点，又特别是在 Kubernetes 集群环境下面能够更好来解决上面的问题。</p><p>这种方式的工作流程大致为：当 Jenkins Master 接受到 Build 请求时，会根据配置的 Label 动态创建一个运行在 Pod 中的 Jenkins Slave 并注册到 Master 上，当运行完 Job 后，这个 Slave 会被注销并且这个 Pod 也会自动删除，恢复到最初状态。</p><p>那么我们使用这种方式带来了哪些好处呢？</p><ul><li><strong>服务高可用</strong>，当 Jenkins Master 出现故障时，Kubernetes 会自动创建一个新的 Jenkins Master 容器，并且将 Volume 分配给新创建的容器，保证数据不丢失，从而达到集群服务高可用。</li><li><strong>动态伸缩</strong>，合理使用资源，每次运行 Job 时，会自动创建一个 Jenkins Slave，Job 完成后，Slave 自动注销并删除容器，资源自动释放，而且 Kubernetes 会根据每个资源的使用情况，动态分配 Slave 到空闲的节点上创建，降低出现因某节点资源利用率高，还排队等待在该节点的情况。</li><li><strong>扩展性好</strong>，当 Kubernetes 集群的资源严重不足而导致 Job 排队等待时，可以很容易的添加一个 Kubernetes Node 到集群中，从而实现扩展。</li></ul><h1 id="部署"><a href="#部署" class="headerlink" title="部署"></a>部署</h1><h2 id="创建serviceAccount"><a href="#创建serviceAccount" class="headerlink" title="创建serviceAccount"></a>创建serviceAccount</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">[root@node1 jenkins]# cat rbac.yaml </span><br><span class="line">apiVersion: v1</span><br><span class="line">kind: ServiceAccount</span><br><span class="line">metadata:</span><br><span class="line">  name: jenkins2</span><br><span class="line">  namespace: default</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">kind: ClusterRole</span><br><span class="line">apiVersion: rbac.authorization.k8s.io/v1beta1</span><br><span class="line">metadata:</span><br><span class="line">  name: jenkins2</span><br><span class="line">rules:</span><br><span class="line">  - apiGroups: [&quot;extensions&quot;, &quot;apps&quot;]</span><br><span class="line">    resources: [&quot;deployments&quot;]</span><br><span class="line">    verbs: [&quot;create&quot;, &quot;delete&quot;, &quot;get&quot;, &quot;list&quot;, &quot;watch&quot;, &quot;patch&quot;, &quot;update&quot;]</span><br><span class="line">  - apiGroups: [&quot;&quot;]</span><br><span class="line">    resources: [&quot;services&quot;]</span><br><span class="line">    verbs: [&quot;create&quot;, &quot;delete&quot;, &quot;get&quot;, &quot;list&quot;, &quot;watch&quot;, &quot;patch&quot;, &quot;update&quot;]</span><br><span class="line">  - apiGroups: [&quot;&quot;]</span><br><span class="line">    resources: [&quot;pods&quot;]</span><br><span class="line">    verbs: [&quot;create&quot;,&quot;delete&quot;,&quot;get&quot;,&quot;list&quot;,&quot;patch&quot;,&quot;update&quot;,&quot;watch&quot;]</span><br><span class="line">  - apiGroups: [&quot;&quot;]</span><br><span class="line">    resources: [&quot;pods/exec&quot;]</span><br><span class="line">    verbs: [&quot;create&quot;,&quot;delete&quot;,&quot;get&quot;,&quot;list&quot;,&quot;patch&quot;,&quot;update&quot;,&quot;watch&quot;]</span><br><span class="line">  - apiGroups: [&quot;&quot;]</span><br><span class="line">    resources: [&quot;pods/log&quot;]</span><br><span class="line">    verbs: [&quot;get&quot;,&quot;list&quot;,&quot;watch&quot;]</span><br><span class="line">  - apiGroups: [&quot;&quot;]</span><br><span class="line">    resources: [&quot;secrets&quot;]</span><br><span class="line">    verbs: [&quot;get&quot;]</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line">apiVersion: rbac.authorization.k8s.io/v1beta1</span><br><span class="line">kind: ClusterRoleBinding</span><br><span class="line">metadata:</span><br><span class="line">  name: jenkins2</span><br><span class="line">  namespace: default</span><br><span class="line">roleRef:</span><br><span class="line">  apiGroup: rbac.authorization.k8s.io</span><br><span class="line">  kind: ClusterRole</span><br><span class="line">  name: jenkins2</span><br><span class="line">subjects:</span><br><span class="line">  - kind: ServiceAccount</span><br><span class="line">    name: jenkins2</span><br><span class="line">    namespace: default</span><br></pre></td></tr></table></figure><h2 id="jenkins"><a href="#jenkins" class="headerlink" title="jenkins"></a>jenkins</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line">[root@node1 jenkins]# cat jenkins.yaml </span><br><span class="line">---</span><br><span class="line">apiVersion: extensions/v1beta1</span><br><span class="line">kind: Deployment</span><br><span class="line">metadata:</span><br><span class="line">  name: jenkins2</span><br><span class="line">  namespace: default</span><br><span class="line">spec:</span><br><span class="line">  template:</span><br><span class="line">    metadata:</span><br><span class="line">      labels:</span><br><span class="line">        app: jenkins2</span><br><span class="line">    spec:</span><br><span class="line">      terminationGracePeriodSeconds: 10</span><br><span class="line">      serviceAccount: jenkins2</span><br><span class="line">      containers:</span><br><span class="line">      - name: jenkins</span><br><span class="line">        image: jenkins/jenkins:lts</span><br><span class="line">        imagePullPolicy: IfNotPresent</span><br><span class="line">        ports:</span><br><span class="line">        - containerPort: 8080</span><br><span class="line">          name: web</span><br><span class="line">          protocol: TCP</span><br><span class="line">        - containerPort: 50000</span><br><span class="line">          name: agent</span><br><span class="line">          protocol: TCP</span><br><span class="line">        resources:</span><br><span class="line">          limits:</span><br><span class="line">            cpu: 1000m</span><br><span class="line">            memory: 1Gi</span><br><span class="line">          requests:</span><br><span class="line">            cpu: 500m</span><br><span class="line">            memory: 512Mi</span><br><span class="line">        livenessProbe:</span><br><span class="line">          httpGet:</span><br><span class="line">            path: /login</span><br><span class="line">            port: 8080</span><br><span class="line">          initialDelaySeconds: 60</span><br><span class="line">          timeoutSeconds: 5</span><br><span class="line">          failureThreshold: 12</span><br><span class="line">        readinessProbe:</span><br><span class="line">          httpGet:</span><br><span class="line">            path: /login</span><br><span class="line">            port: 8080</span><br><span class="line">          initialDelaySeconds: 60</span><br><span class="line">          timeoutSeconds: 5</span><br><span class="line">          failureThreshold: 12</span><br><span class="line">        volumeMounts:</span><br><span class="line">        - name: jenkinshome</span><br><span class="line">          subPath: jenkins2</span><br><span class="line">          mountPath: /var/jenkins_home</span><br><span class="line">        env:</span><br><span class="line">        - name: LIMITS_MEMORY</span><br><span class="line">          valueFrom:</span><br><span class="line">            resourceFieldRef:</span><br><span class="line">              resource: limits.memory</span><br><span class="line">              divisor: 1Mi</span><br><span class="line">        - name: JAVA_OPTS</span><br><span class="line">          value: -Xmx$(LIMITS_MEMORY)m -XshowSettings:vm -Dhudson.slaves.NodeProvisioner.initialDelay=0 -Dhudson.slaves.NodeProvisioner.MARGIN=50 -Dhudson.slaves.NodeProvisioner.MARGIN0=0.85 -Duser.timezone=Asia/Shanghai</span><br><span class="line">      securityContext:</span><br><span class="line">        fsGroup: 1000</span><br><span class="line">      volumes:</span><br><span class="line">      - name: jenkinshome</span><br><span class="line">        persistentVolumeClaim:</span><br><span class="line">          claimName: cephfs-pvc</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line">apiVersion: v1</span><br><span class="line">kind: Service</span><br><span class="line">metadata:</span><br><span class="line">  name: jenkins2</span><br><span class="line">  namespace: default</span><br><span class="line">  labels:</span><br><span class="line">    app: jenkins2</span><br><span class="line">spec:</span><br><span class="line">  selector:</span><br><span class="line">    app: jenkins2</span><br><span class="line">  type: NodePort</span><br><span class="line">  ports:</span><br><span class="line">  - name: web</span><br><span class="line">    port: 8080</span><br><span class="line">    targetPort: web</span><br><span class="line">    nodePort: 30002</span><br><span class="line">  - name: agent</span><br><span class="line">    port: 50000</span><br><span class="line">    targetPort: agent</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[root@node1 jenkins]# kubectl apply -f rbac.yaml </span><br><span class="line">serviceaccount/jenkins2 created</span><br><span class="line">clusterrole.rbac.authorization.k8s.io/jenkins2 created</span><br><span class="line">clusterrolebinding.rbac.authorization.k8s.io/jenkins2 created</span><br><span class="line">[root@node1 jenkins]# kubectl create -f jenkins.yaml </span><br><span class="line">deployment.extensions/jenkins2 created</span><br><span class="line">service/jenkins2 created</span><br><span class="line"></span><br><span class="line">[root@node1 jenkins]# kubectl get pods</span><br><span class="line">NAME                        READY   STATUS    RESTARTS   AGE</span><br><span class="line">busybox                     1/1     Running   291        12d</span><br><span class="line">jenkins2-5f76f7f8b5-cqwb4   1/1     Running   0          17m</span><br></pre></td></tr></table></figure><p>访问：</p><p><a href="http://192.168.6.102:30002" target="_blank" rel="noopener">http://192.168.6.102:30002</a></p><p>初始化的密码我们可以在 jenkins 的容器的日志中进行查看，也可以直接在cephfs的共享数据目录中查看： </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@node1 secrets]# cat /mnt/cephfs/jenkins2/secrets/initialAdminPassword </span><br><span class="line">fc5cf245b9924616b4d430a50ad413dc</span><br></pre></td></tr></table></figure><h1 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h1><p>第1步. 我们需要安装<strong>kubernetes plugin</strong>， 点击 Manage Jenkins -&gt; Manage Plugins -&gt; Available -&gt; Kubernetes勾选安装即可。 </p><p>第2步. 安装完毕后，点击 Manage Jenkins —&gt; Configure System —&gt; (拖到最下方)Add a new cloud —&gt; 选择 Kubernetes，然后填写 Kubernetes 和 Jenkins 配置信息。  </p><p><img src="https://shenshengkun.github.io/images/k8s_jenkins1.png" alt=""></p><p>第3步. 配置 Pod Template，其实就是配置 Jenkins Slave 运行的 Pod 模板，命名空间我们同样是用 kube-ops，Labels 这里也非常重要，对于后面执行 Job 的时候需要用到该值 </p><p><img src="https://shenshengkun.github.io/images/k8s_jenkins2.png" alt=""></p><p>另外需要注意我们这里需要在下面挂载两个主机目录，一个是 /var/run/docker.sock，该文件是用于 Pod 中的容器能够共享宿主机的 Docker，这就是大家说的 docker in docker 的方式，Docker 二进制文件我们已经打包到上面的镜像中了，另外一个目录下 /root/.kube 目录，我们将这个目录挂载到容器的 /home/jenkins/.kube 目录下面这是为了让我们能够在 Pod 的容器中能够使用 kubectl 工具来访问我们的 Kubernetes 集群，方便我们后面在 Slave Pod 部署 Kubernetes 应用。  </p><p>另外还有几个参数需要注意，如下图中的<strong>Time in minutes to retain slave when idle</strong>，这个参数表示的意思是当处于空闲状态的时候保留 Slave Pod 多长时间，这个参数最好我们保存默认就行了，如果你设置过大的话，Job 任务执行完成后，对应的 Slave Pod 就不会立即被销毁删除。  </p><p>Jenkins Slave Pod 中没有配置权限，所以需要配置上 ServiceAccount，在 Slave Pod 配置的地方点击下面的高级，添加上对应的 ServiceAccount ，jenkins2</p><p><img src="https://shenshengkun.github.io/images/k8s_jenkins3.png" alt=""></p><h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><p>Kubernetes 插件的配置工作完成了，接下来我们就来添加一个 Job 任务，看是否能够在 Slave Pod 中执行，任务执行完成后看 Pod 是否会被销毁。</p><p>在 Jenkins 首页点击<strong>create new jobs</strong>，创建一个测试的任务，输入任务名称，然后我们选择 Freestyle project 类型的任务： </p><p><img src="https://shenshengkun.github.io/images/k8s_jenkins4.png" alt=""></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;测试 Kubernetes 动态生成 jenkins slave&quot;</span><br><span class="line">echo &quot;==============docker in docker===========&quot;</span><br><span class="line">docker info</span><br><span class="line"></span><br><span class="line">echo &quot;=============kubectl=============&quot;</span><br><span class="line">kubectl get pods</span><br></pre></td></tr></table></figure><p>我们直接在页面点击做成的 Build now 触发构建即可，然后观察 Kubernetes 集群中 Pod 的变化 </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@node1 jenkins]# kubectl get pods</span><br><span class="line">NAME                        READY   STATUS    RESTARTS   AGE</span><br><span class="line">busybox                     1/1     Running   293        12d</span><br><span class="line">jenkins2-5f76f7f8b5-hzcqw   1/1     Running   0          22m</span><br><span class="line">jnlp-bv17b                  1/1     Running   0          28s</span><br><span class="line">[root@node1 jenkins]# kubectl get pods</span><br><span class="line">NAME                        READY   STATUS    RESTARTS   AGE</span><br><span class="line">busybox                     1/1     Running   293        12d</span><br><span class="line">jenkins2-5f76f7f8b5-hzcqw   1/1     Running   0          22m</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Kubernetes-环境下面使用-Jenkins-有什么好处&quot;&gt;&lt;a href=&quot;#Kubernetes-环境下面使用-Jenkins-有什么好处&quot; class=&quot;headerlink&quot; title=&quot;Kubernetes 环境下面使用 Jenkins 有什么好
      
    
    </summary>
    
      <category term="k8s" scheme="https://shenshengkun.github.io/categories/k8s/"/>
    
    
  </entry>
  
  <entry>
    <title>pxc集群部署</title>
    <link href="https://shenshengkun.github.io/posts/dlfl674a.html"/>
    <id>https://shenshengkun.github.io/posts/dlfl674a.html</id>
    <published>2019-07-25T02:49:10.000Z</published>
    <updated>2019-07-29T07:35:25.659Z</updated>
    
    <content type="html"><![CDATA[<h1 id="pxc介绍"><a href="#pxc介绍" class="headerlink" title="pxc介绍"></a>pxc介绍</h1><p>​    galera产品是以galera cluster方式为mysql提高高可用集群解决方案的。galera cluster就是集成了galera插件的mysql集群。galera replication是codership提供的mysql数据同步方案，具有高可用性，方便扩展，并且可以实现多个mysql节点间的数据同步复制与读写，可保障数据库的服务高可用及数据强一致性。 </p><p>​    PXC属于一套近乎完美的mysql高可用集群解决方案，相比那些比较传统的基于主从复制模式的集群架构MHA和MM+keepalived，galera cluster最突出特点就是解决了诟病已久的数据复制延迟问题，基本上可以达到实时同步。而且节点与节点之间，他们相互的关系是对等的。本身galera cluster也是一种多主架构。galera cluster最关注的是数据的一致性，对待事物的行为时，要么在所有节点上执行，要么都不执行，它的实现机制决定了它对待一致性的行为非常严格，这也能非常完美的保证MySQL集群的数据一致性； </p><p>​    对galera cluster的封装有两个，虽然名称不同，但实质都是一样的，使用的都是galera cluster。一个MySQL的创始人在自己全新的MariaDB上实现的MAriaDB cluster；一个是著名的MySQL服务和工具提供商percona实现的percona xtradb cluster，简称PXC 。</p><p>​    要搭建PXC架构至少需要3个mysql实例来组成一个集群，三个实例之间不是主从模式，而是各自为主，所以三者是对等关系，不分从属，这就叫multi-master架构。客户端写入和读取数据时，连接哪个实例都是一样的。读取到的数据时相同的，写入任意一个实例之后，集群自己会将新写入的数据同步到其他实例上，这种架构不共享任何数据，是一种高冗余架构。 </p><h1 id="部署"><a href="#部署" class="headerlink" title="部署"></a>部署</h1><h2 id="部署准备工作"><a href="#部署准备工作" class="headerlink" title="部署准备工作"></a>部署准备工作</h2><table><thead><tr><th>主机名</th><th>IP</th></tr></thead><tbody><tr><td>pxc1</td><td>192.168.6.201   192.168.6.200</td></tr><tr><td>pxc2</td><td>192.168.6.202</td></tr><tr><td>pxc3</td><td>192.168.6.203</td></tr></tbody></table><p>关防火墙、selinux、ntp时间同步</p><h2 id="安装pxc"><a href="#安装pxc" class="headerlink" title="安装pxc"></a>安装pxc</h2><h3 id="rpm安装"><a href="#rpm安装" class="headerlink" title="rpm安装"></a>rpm安装</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">##安装yum源</span><br><span class="line"> yum install https://repo.percona.com/yum/percona-release-latest.noarch.rpm</span><br><span class="line"> ##定位到pxc57的仓库</span><br><span class="line">  percona-release setup pxc57</span><br><span class="line"> #解压</span><br><span class="line"> tar vxf Percona-XtraBackup-2.4.14-ref675d4-el7-x86_64-bundle.tar</span><br><span class="line"> tar vxf Percona-XtraDB-Cluster-5.7.25-31.35-r463-el7-x86_64-bundle.tar</span><br><span class="line"> ##安装rpm包用yum localinstall 命令率先从本地安装，并根据本地rpm包会在线寻找未安装的依赖(pxc官网下载的安装包会依赖其他包)</span><br><span class="line"> yum localinstall *.rpm</span><br></pre></td></tr></table></figure><h3 id="分别在三个节点创建数据存储目录"><a href="#分别在三个节点创建数据存储目录" class="headerlink" title="分别在三个节点创建数据存储目录"></a>分别在三个节点创建数据存储目录</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /data/local/percona-xtradb-cluster/data</span><br><span class="line">chown -R mysql:mysql /data/local/percona-xtradb-cluster/data</span><br><span class="line">mkdir -p /data/local/percona-xtradb-cluster/run</span><br><span class="line">chown -R mysql:mysql /data/local/percona-xtradb-cluster/run</span><br><span class="line">mkdir -p /data/logs/mysql</span><br><span class="line">chown -R mysql:mysql /data/logs/mysql</span><br></pre></td></tr></table></figure><h3 id="修改-etc-my-cnf配置文件，其他两台节点需要修改server-id和wsrep-node-address"><a href="#修改-etc-my-cnf配置文件，其他两台节点需要修改server-id和wsrep-node-address" class="headerlink" title="修改/etc/my.cnf配置文件，其他两台节点需要修改server_id和wsrep_node_address"></a>修改/etc/my.cnf配置文件，其他两台节点需要修改server_id和wsrep_node_address</h3><p>pxc1：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">[root@pxc1 ~]# cat /etc/my.cnf</span><br><span class="line">[client]</span><br><span class="line">port = 3306</span><br><span class="line">socket = /data/local/percona-xtradb-cluster/run/mysql.sock</span><br><span class="line">default-character-set = utf8mb4</span><br><span class="line">[mysqld]</span><br><span class="line">user =  mysql</span><br><span class="line">innodb_buffer_pool_size = 1024M</span><br><span class="line">character_set_server = utf8mb4</span><br><span class="line">datadir = /data/local/percona-xtradb-cluster/data</span><br><span class="line">port = 3306</span><br><span class="line">server_id = 1</span><br><span class="line">socket = /data/local/percona-xtradb-cluster/run/mysql.sock</span><br><span class="line">pid-file = /data/local/percona-xtradb-cluster/run/mysql.pid</span><br><span class="line">log-error = /data/logs/mysql/error.log</span><br><span class="line">log_warnings = 2</span><br><span class="line">slow_query_log_file = /data/logs/mysql/slow.log</span><br><span class="line">long_query_time = 2</span><br><span class="line">log_timestamps=SYSTEM</span><br><span class="line">lower_case_table_names = 1</span><br><span class="line">key_buffer_size = 1344M</span><br><span class="line">event_scheduler=ON</span><br><span class="line">sql_mode=NO_ENGINE_SUBSTITUTION,STRICT_TRANS_TABLES</span><br><span class="line">wsrep_provider=/usr/lib64/libgalera_smm.so</span><br><span class="line">wsrep_cluster_address=gcomm://192.168.6.201,192.168.6.202,192.168.6.203</span><br><span class="line">binlog_format=ROW</span><br><span class="line">pxc_strict_mode=PERMISSIVE</span><br><span class="line">max_connect_errors=1000</span><br><span class="line">max_allowed_packet = 1024M</span><br><span class="line">default_storage_engine=InnoDB</span><br><span class="line">#Innodb</span><br><span class="line">innodb_flush_method = O_DIRECT</span><br><span class="line">innodb_log_files_in_group = 5</span><br><span class="line">innodb_lock_wait_timeout = 50</span><br><span class="line">innodb_log_file_size = 1024M</span><br><span class="line">innodb_flush_log_at_trx_commit = 1</span><br><span class="line">innodb_file_per_table = 1</span><br><span class="line">innodb_thread_concurrency = 8</span><br><span class="line">innodb_buffer_pool_size = 5G</span><br><span class="line">innodb_read_io_threads = 24</span><br><span class="line">innodb_write_io_threads = 24</span><br><span class="line">log_bin_trust_function_creators=1</span><br><span class="line">innodb_autoinc_lock_mode=2</span><br><span class="line">innodb_locks_unsafe_for_binlog=1</span><br><span class="line"># CACHES AND LIMITS #</span><br><span class="line">tmp_table_size = 32M</span><br><span class="line">max_heap_table_size = 32M</span><br><span class="line">max_connections = 1000</span><br><span class="line">thread_cache_size = 50</span><br><span class="line">open_files_limit = 65535</span><br><span class="line">table_definition_cache = 4096</span><br><span class="line">table_open_cache = 5000</span><br><span class="line">#wsrep</span><br><span class="line">wsrep_retry_autocommit=1</span><br><span class="line">wsrep_auto_increment_control=1</span><br><span class="line">wsrep_node_name = pxc1</span><br><span class="line">wsrep_node_address=192.168.6.201</span><br><span class="line">wsrep_sst_method=xtrabackup-v2</span><br><span class="line">wsrep_cluster_name=pxc</span><br><span class="line">wsrep_sst_auth=&quot;sstuser:secret&quot;</span><br></pre></td></tr></table></figure><p>pxc2：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">[root@pxc2 ~]# cat /etc/my.cnf</span><br><span class="line">[client]</span><br><span class="line">port = 3306</span><br><span class="line">socket = /data/local/percona-xtradb-cluster/run/mysql.sock</span><br><span class="line">default-character-set = utf8mb4</span><br><span class="line">[mysqld]</span><br><span class="line">user =  mysql</span><br><span class="line">innodb_buffer_pool_size = 1024M</span><br><span class="line">character_set_server = utf8mb4</span><br><span class="line">datadir = /data/local/percona-xtradb-cluster/data</span><br><span class="line">port = 3306</span><br><span class="line">server_id = 2</span><br><span class="line">socket = /data/local/percona-xtradb-cluster/run/mysql.sock</span><br><span class="line">pid-file = /data/local/percona-xtradb-cluster/run/mysql.pid</span><br><span class="line">log-error = /data/logs/mysql/error.log</span><br><span class="line">log_warnings = 2</span><br><span class="line">slow_query_log_file = /data/logs/mysql/slow.log</span><br><span class="line">long_query_time = 2</span><br><span class="line">log_timestamps=SYSTEM</span><br><span class="line">lower_case_table_names = 1</span><br><span class="line">key_buffer_size = 1344M</span><br><span class="line">event_scheduler=ON</span><br><span class="line">sql_mode=NO_ENGINE_SUBSTITUTION,STRICT_TRANS_TABLES</span><br><span class="line">wsrep_provider=/usr/lib64/libgalera_smm.so</span><br><span class="line">wsrep_cluster_address=gcomm://192.168.6.201,192.168.6.202,192.168.6.203</span><br><span class="line">binlog_format=ROW</span><br><span class="line">pxc_strict_mode=PERMISSIVE</span><br><span class="line">max_connect_errors=1000</span><br><span class="line">max_allowed_packet = 1024M</span><br><span class="line">default_storage_engine=InnoDB</span><br><span class="line">#Innodb</span><br><span class="line">innodb_flush_method = O_DIRECT</span><br><span class="line">innodb_log_files_in_group = 5</span><br><span class="line">innodb_lock_wait_timeout = 50</span><br><span class="line">innodb_log_file_size = 1024M</span><br><span class="line">innodb_flush_log_at_trx_commit = 1</span><br><span class="line">innodb_file_per_table = 1</span><br><span class="line">innodb_thread_concurrency = 8</span><br><span class="line">innodb_buffer_pool_size = 5G</span><br><span class="line">innodb_read_io_threads = 24</span><br><span class="line">innodb_write_io_threads = 24</span><br><span class="line">log_bin_trust_function_creators=1</span><br><span class="line">innodb_autoinc_lock_mode=2</span><br><span class="line">innodb_locks_unsafe_for_binlog=1</span><br><span class="line"># CACHES AND LIMITS #</span><br><span class="line">tmp_table_size = 32M</span><br><span class="line">max_heap_table_size = 32M</span><br><span class="line">max_connections = 1000</span><br><span class="line">thread_cache_size = 50</span><br><span class="line">open_files_limit = 65535</span><br><span class="line">table_definition_cache = 4096</span><br><span class="line">table_open_cache = 5000</span><br><span class="line">#wsrep</span><br><span class="line">wsrep_retry_autocommit=1</span><br><span class="line">wsrep_auto_increment_control=1</span><br><span class="line">wsrep_node_name = pxc2</span><br><span class="line">wsrep_node_address=192.168.6.202</span><br><span class="line">wsrep_sst_method=xtrabackup-v2</span><br><span class="line">wsrep_cluster_name=pxc</span><br><span class="line">wsrep_sst_auth=&quot;sstuser:secret&quot;</span><br></pre></td></tr></table></figure><p>pxc3:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">[root@pxc3 ~]# cat /etc/my.cnf</span><br><span class="line">[client]</span><br><span class="line">port = 3306</span><br><span class="line">socket = /data/local/percona-xtradb-cluster/run/mysql.sock</span><br><span class="line">default-character-set = utf8mb4</span><br><span class="line">[mysqld]</span><br><span class="line">user =  mysql</span><br><span class="line">innodb_buffer_pool_size = 1024M</span><br><span class="line">character_set_server = utf8mb4</span><br><span class="line">datadir = /data/local/percona-xtradb-cluster/data</span><br><span class="line">port = 3306</span><br><span class="line">server_id = 3</span><br><span class="line">socket = /data/local/percona-xtradb-cluster/run/mysql.sock</span><br><span class="line">pid-file = /data/local/percona-xtradb-cluster/run/mysql.pid</span><br><span class="line">log-error = /data/logs/mysql/error.log</span><br><span class="line">log_warnings = 2</span><br><span class="line">slow_query_log_file = /data/logs/mysql/slow.log</span><br><span class="line">long_query_time = 2</span><br><span class="line">log_timestamps=SYSTEM</span><br><span class="line">lower_case_table_names = 1</span><br><span class="line">key_buffer_size = 1344M</span><br><span class="line">event_scheduler=ON</span><br><span class="line">sql_mode=NO_ENGINE_SUBSTITUTION,STRICT_TRANS_TABLES</span><br><span class="line">wsrep_provider=/usr/lib64/libgalera_smm.so</span><br><span class="line">wsrep_cluster_address=gcomm://192.168.6.201,192.168.6.202,192.168.6.203</span><br><span class="line">binlog_format=ROW</span><br><span class="line">pxc_strict_mode=PERMISSIVE</span><br><span class="line">max_connect_errors=1000</span><br><span class="line">max_allowed_packet = 1024M</span><br><span class="line">default_storage_engine=InnoDB</span><br><span class="line">#Innodb</span><br><span class="line">innodb_flush_method = O_DIRECT</span><br><span class="line">innodb_log_files_in_group = 5</span><br><span class="line">innodb_lock_wait_timeout = 50</span><br><span class="line">innodb_log_file_size = 1024M</span><br><span class="line">innodb_flush_log_at_trx_commit = 1</span><br><span class="line">innodb_file_per_table = 1</span><br><span class="line">innodb_thread_concurrency = 8</span><br><span class="line">innodb_buffer_pool_size = 5G</span><br><span class="line">innodb_read_io_threads = 24</span><br><span class="line">innodb_write_io_threads = 24</span><br><span class="line">log_bin_trust_function_creators=1</span><br><span class="line">innodb_autoinc_lock_mode=2</span><br><span class="line">innodb_locks_unsafe_for_binlog=1</span><br><span class="line"># CACHES AND LIMITS #</span><br><span class="line">tmp_table_size = 32M</span><br><span class="line">max_heap_table_size = 32M</span><br><span class="line">max_connections = 1000</span><br><span class="line">thread_cache_size = 50</span><br><span class="line">open_files_limit = 65535</span><br><span class="line">table_definition_cache = 4096</span><br><span class="line">table_open_cache = 5000</span><br><span class="line">#wsrep</span><br><span class="line">wsrep_retry_autocommit=1</span><br><span class="line">wsrep_auto_increment_control=1</span><br><span class="line">wsrep_node_name = pxc3</span><br><span class="line">wsrep_node_address=192.168.6.203</span><br><span class="line">wsrep_sst_method=xtrabackup-v2</span><br><span class="line">wsrep_cluster_name=pxc</span><br><span class="line">wsrep_sst_auth=&quot;sstuser:secret&quot;</span><br></pre></td></tr></table></figure><h3 id="启动"><a href="#启动" class="headerlink" title="启动"></a>启动</h3><p>主节点：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service  mysql@bootstrap.service  start</span><br></pre></td></tr></table></figure><p>其他节点：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service mysql start</span><br></pre></td></tr></table></figure><h3 id="启动第二个节点时遇到sst连接失败的问题"><a href="#启动第二个节点时遇到sst连接失败的问题" class="headerlink" title="启动第二个节点时遇到sst连接失败的问题"></a>启动第二个节点时遇到sst连接失败的问题</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">将wsrep.cnf 配置文件的wsrep_sst_method改为rsync,成功启动集群后停止集群，然后改回xtrabackup-v2,再启动集群节点。</span><br></pre></td></tr></table></figure><h3 id="修改密码"><a href="#修改密码" class="headerlink" title="修改密码"></a>修改密码</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql5.7版本日志均在error.log 里面生成</span><br><span class="line">grep &quot;temporary password&quot;  /data/logs/mysql/error.log</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">使用改密码登陆MySQL，修改成自己想要的密码</span><br><span class="line">mysql&gt; alter user &apos;root&apos;@&apos;localhost&apos; idnetified by &apos;pxc&apos;;</span><br><span class="line"></span><br><span class="line">配置SST认证账号</span><br><span class="line">CREATE USER &apos;sstuser&apos;@&apos;192.168.%.%&apos; IDENTIFIED BY &apos;secret&apos;;</span><br><span class="line">GRANT RELOAD, LOCK TABLES, PROCESS, REPLICATION CLIENT ON *.* TO &apos;sstuser&apos;@&apos;192.168.%.%&apos;;</span><br><span class="line">FLUSH PRIVILEGES;</span><br></pre></td></tr></table></figure><h3 id="查看状态"><a href="#查看状态" class="headerlink" title="查看状态"></a>查看状态</h3><p>查看节点数：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show global status like &apos;wsrep_cluster_size&apos;;</span><br></pre></td></tr></table></figure><p>查看集群状态：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show global status like &apos;wsrep%&apos;;</span><br></pre></td></tr></table></figure><p>查看当前节点状态：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show global status like &apos;wsrep_cluster_status&apos;;</span><br></pre></td></tr></table></figure><h1 id="安装keepalive"><a href="#安装keepalive" class="headerlink" title="安装keepalive"></a>安装keepalive</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">6.200为虚ip</span><br><span class="line">在192.168.6.201,6.202上</span><br><span class="line">yum -y install keepalived</span><br></pre></td></tr></table></figure><p>主：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">[root@pxc1 ~]# cat /etc/keepalived/keepalived.conf </span><br><span class="line">global_defs &#123;</span><br><span class="line">   router_id LVS_mysql</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">vrrp_script Checkmysql &#123;</span><br><span class="line">    script &quot;curl -k http://192.168.7.201:3306&quot; # vip</span><br><span class="line">    interval 3</span><br><span class="line">    timeout 9</span><br><span class="line">    fall 2</span><br><span class="line">    rise 2</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">vrrp_instance VI_1 &#123;</span><br><span class="line">    state MASTER</span><br><span class="line">    interface ens160 # 本地网卡名称</span><br><span class="line">    virtual_router_id 61</span><br><span class="line">    priority 120 # 权重,要唯一</span><br><span class="line">    advert_int 1</span><br><span class="line">    mcast_src_ip 192.168.7.201 # 本地IP</span><br><span class="line">    nopreempt</span><br><span class="line">    authentication &#123;</span><br><span class="line">        auth_type PASS</span><br><span class="line">        auth_pass sqP05dQgMSlzrxHj</span><br><span class="line">    &#125;</span><br><span class="line">    unicast_peer &#123;</span><br><span class="line">        192.168.7.202</span><br><span class="line">        192.168.7.203</span><br><span class="line">    &#125;</span><br><span class="line">    virtual_ipaddress &#123;</span><br><span class="line">        192.168.7.200/24 # VIP</span><br><span class="line">    &#125;</span><br><span class="line">    track_script &#123;</span><br><span class="line">        Checkmysql</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>从：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">[root@pxc2 ~]# cat /etc/keepalived/keepalived.conf </span><br><span class="line">global_defs &#123;</span><br><span class="line">   router_id LVS_mysql</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">vrrp_script Checkmysql &#123;</span><br><span class="line">    script &quot;curl -k http://192.168.7.201:3306&quot; # vip</span><br><span class="line">    interval 3</span><br><span class="line">    timeout 9</span><br><span class="line">    fall 2</span><br><span class="line">    rise 2</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">vrrp_instance VI_1 &#123;</span><br><span class="line">    state BACKUP</span><br><span class="line">    interface ens160 # 本地网卡名称</span><br><span class="line">    virtual_router_id 61</span><br><span class="line">    priority 80 # 权重,要唯一</span><br><span class="line">    advert_int 1</span><br><span class="line">    mcast_src_ip 192.168.7.202 # 本地IP</span><br><span class="line">    nopreempt</span><br><span class="line">    authentication &#123;</span><br><span class="line">        auth_type PASS</span><br><span class="line">        auth_pass sqP05dQgMSlzrxHj</span><br><span class="line">    &#125;</span><br><span class="line">    unicast_peer &#123;</span><br><span class="line">        192.168.7.201</span><br><span class="line">        192.168.7.203</span><br><span class="line">    &#125;</span><br><span class="line">    virtual_ipaddress &#123;</span><br><span class="line">        192.168.7.200/24 # VIP</span><br><span class="line">    &#125;</span><br><span class="line">    track_script &#123;</span><br><span class="line">        Checkmysql</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>登录：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@pxc1 ~]# mysql -usstuser -psecret --host 192.168.6.200</span><br><span class="line">mysql: [Warning] Using a password on the command line interface can be insecure.</span><br><span class="line">Welcome to the MySQL monitor.  Commands end with ; or \g.</span><br><span class="line">Your MySQL connection id is 1099</span><br><span class="line">Server version: 5.7.25-28-57 Percona XtraDB Cluster (GPL), Release rel28, Revision a2ef85f, WSREP version 31.35, wsrep_31.35</span><br><span class="line"></span><br><span class="line">Copyright (c) 2009-2019 Percona LLC and/or its affiliates</span><br><span class="line">Copyright (c) 2000, 2019, Oracle and/or its affiliates. All rights reserved.</span><br><span class="line"></span><br><span class="line">Oracle is a registered trademark of Oracle Corporation and/or its</span><br><span class="line">affiliates. Other names may be trademarks of their respective</span><br><span class="line">owners.</span><br><span class="line"></span><br><span class="line">Type &apos;help;&apos; or &apos;\h&apos; for help. Type &apos;\c&apos; to clear the current input statement.</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;pxc介绍&quot;&gt;&lt;a href=&quot;#pxc介绍&quot; class=&quot;headerlink&quot; title=&quot;pxc介绍&quot;&gt;&lt;/a&gt;pxc介绍&lt;/h1&gt;&lt;p&gt;​    galera产品是以galera cluster方式为mysql提高高可用集群解决方案的。galera c
      
    
    </summary>
    
      <category term="中间件" scheme="https://shenshengkun.github.io/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6/"/>
    
    
  </entry>
  
  <entry>
    <title>k8s上用cephfs存储</title>
    <link href="https://shenshengkun.github.io/posts/0rfhdj22.html"/>
    <id>https://shenshengkun.github.io/posts/0rfhdj22.html</id>
    <published>2019-07-22T03:10:01.000Z</published>
    <updated>2019-07-29T07:01:10.799Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>k8s对ceph rbd模式不支持<strong>ReadWriteMany（RWX）</strong>,为了满足k8s的灵活性需求,采用支持多点挂载的cephfs工作模式 </p><h1 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h1><h2 id="ceph端"><a href="#ceph端" class="headerlink" title="ceph端"></a>ceph端</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ceph-deploy mds create ceph</span><br><span class="line"></span><br><span class="line">为cephfs创建存储池</span><br><span class="line">ceph osd pool create cephfs_data 8</span><br><span class="line">ceph osd pool create  cephfs_metadata 8</span><br><span class="line">ceph fs new cephfs cephfs_metadata    cephfs_data</span><br></pre></td></tr></table></figure><p>查看：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[root@node1 ceph]# ceph  fs  ls</span><br><span class="line">name: cephfs, metadata pool: cephfs_metadata, data pools: [cephfs_data ]</span><br><span class="line"></span><br><span class="line">[root@node1 ceph]# ceph -s</span><br><span class="line">  cluster:</span><br><span class="line">    id:     cbc04385-1cdf-4512-a3f5-a5b3e8686a05</span><br><span class="line">    health: HEALTH_OK</span><br><span class="line"> </span><br><span class="line">  services:</span><br><span class="line">    mon: 1 daemons, quorum ceph</span><br><span class="line">    mgr: ceph(active)</span><br><span class="line">    mds: cephfs-1/1/1 up  &#123;0=ceph=up:active&#125;</span><br><span class="line">    osd: 1 osds: 1 up, 1 in</span><br><span class="line"> </span><br><span class="line">  data:</span><br><span class="line">    pools:   3 pools, 106 pgs</span><br><span class="line">    objects: 73 objects, 137MiB</span><br><span class="line">    usage:   3.82GiB used, 16.2GiB / 20.0GiB avail</span><br><span class="line">    pgs:     106 active+clean</span><br></pre></td></tr></table></figure><h2 id="k8s挂载ceph"><a href="#k8s挂载ceph" class="headerlink" title="k8s挂载ceph"></a>k8s挂载ceph</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">[root@node1 ceph]# cat admin.secret </span><br><span class="line">AQA6EzBd5zAwIRAAgs+NyCjoAKuSrQKoFvQi9w==</span><br><span class="line"></span><br><span class="line">[root@node1 ceph]# mkdir /mnt/cephfs</span><br><span class="line"></span><br><span class="line">[root@node1 ceph]# mount -t ceph 192.168.6.101:6789:/ /mnt/cephfs -o name=admin,secretfile=/etc/ceph/admin.secret</span><br><span class="line"></span><br><span class="line">[root@node1 ceph]# df -h</span><br><span class="line">Filesystem            Size  Used Avail Use% Mounted on</span><br><span class="line">devtmpfs              2.0G     0  2.0G   0% /dev</span><br><span class="line">tmpfs                 2.0G     0  2.0G   0% /dev/shm</span><br><span class="line">tmpfs                 2.0G  198M  1.8G  10% /run</span><br><span class="line">tmpfs                 2.0G     0  2.0G   0% /sys/fs/cgroup</span><br><span class="line">/dev/mapper/cl-root    36G   12G   24G  34% /</span><br><span class="line">/dev/sda1            1014M  216M  799M  22% /boot</span><br><span class="line">tmpfs                 2.0G   12K  2.0G   1% /data/k8s/k8s/kubelet/pods/42d3eb88-aaba-11e9-b1ef-005056b1d2de/volumes/kubernetes.io~secret/coredns-token-qklgj</span><br><span class="line">overlay                36G   12G   24G  34% /data/k8s/docker/data/overlay2/f651aa6ff6070b5a3acb8ba0e8d810a1d699a7853e0d3df802851fa64fc2c029/merged</span><br><span class="line">shm                    64M     0   64M   0% /data/k8s/docker/data/containers/531654eae411cc84ed7ed3c2d5e60afa2bd68cca57cf821636369be5869f6f7d/mounts/shm</span><br><span class="line">tmpfs                 2.0G   12K  2.0G   1% /data/k8s/k8s/kubelet/pods/4eb99bd2-aaba-11e9-b1ef-005056b1d2de/volumes/kubernetes.io~secret/default-token-npj5x</span><br><span class="line">overlay                36G   12G   24G  34% /data/k8s/docker/data/overlay2/1707081196a127bbf0f46f57a9a6831c8f6d87a6f92dad5a578375d24eb41580/merged</span><br><span class="line">shm                    64M     0   64M   0% /data/k8s/docker/data/containers/b6b70ef43252b12414afc08562ceb4002467ff700acb01941dce73cf9e40d88a/mounts/shm</span><br><span class="line">overlay                36G   12G   24G  34% /data/k8s/docker/data/overlay2/3ccf15f58beb54a2b59ab2c5c421ac3a8f3f2d5896b5b12430a8f672783eeb84/merged</span><br><span class="line">tmpfs                 396M     0  396M   0% /run/user/0</span><br><span class="line">192.168.6.101:6789:/   20G  3.9G   17G  20% /mnt/cephfs</span><br></pre></td></tr></table></figure><h3 id="创建secret"><a href="#创建secret" class="headerlink" title="创建secret"></a>创建secret</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@node1 ceph]# cat cephfs-secret.yaml </span><br><span class="line">apiVersion: v1</span><br><span class="line">kind: Secret</span><br><span class="line">metadata:</span><br><span class="line">  name: ceph-secret</span><br><span class="line">data:</span><br><span class="line">  key: QVFBNkV6QmQ1ekF3SVJBQWdzK055Q2pvQUt1U3JRS29GdlFpOXc9PQ==</span><br></pre></td></tr></table></figure><h3 id="pv"><a href="#pv" class="headerlink" title="pv"></a>pv</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">[root@node1 ceph]# cat cephfs-pv.yaml </span><br><span class="line">apiVersion: v1</span><br><span class="line">kind: PersistentVolume</span><br><span class="line">metadata:</span><br><span class="line">  name: cephfs-pv</span><br><span class="line">  labels:</span><br><span class="line">    pv: cephfs-pv</span><br><span class="line">spec:</span><br><span class="line">  capacity:</span><br><span class="line">    storage: 1Gi</span><br><span class="line">  accessModes:</span><br><span class="line">    - ReadWriteMany</span><br><span class="line">  cephfs:</span><br><span class="line">    monitors:</span><br><span class="line">      - 192.168.6.101:6789</span><br><span class="line">    user: admin</span><br><span class="line">    secretRef:</span><br><span class="line">      name: ceph-secret</span><br><span class="line">    readOnly: false</span><br><span class="line">  persistentVolumeReclaimPolicy: Delete</span><br></pre></td></tr></table></figure><h3 id="pvc"><a href="#pvc" class="headerlink" title="pvc"></a>pvc</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[root@node1 ceph]# cat cephfs-pvc.yaml </span><br><span class="line">kind: PersistentVolumeClaim</span><br><span class="line">apiVersion: v1</span><br><span class="line">metadata:</span><br><span class="line">  name: cephfs-pvc</span><br><span class="line">spec:</span><br><span class="line">  accessModes:</span><br><span class="line">    - ReadWriteMany</span><br><span class="line">  resources:</span><br><span class="line">    requests:</span><br><span class="line">      storage: 1Gi</span><br><span class="line">  selector:</span><br><span class="line">    matchLabels:</span><br><span class="line">      pv: cephfs-pv</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h1&gt;&lt;p&gt;k8s对ceph rbd模式不支持&lt;strong&gt;ReadWriteMany（RWX）&lt;/strong&gt;,为了满足k8s的灵活性需求,采用支
      
    
    </summary>
    
      <category term="ceph" scheme="https://shenshengkun.github.io/categories/ceph/"/>
    
    
  </entry>
  
  <entry>
    <title>rbd无法map</title>
    <link href="https://shenshengkun.github.io/posts/dl9876la.html"/>
    <id>https://shenshengkun.github.io/posts/dl9876la.html</id>
    <published>2019-07-19T09:10:01.000Z</published>
    <updated>2019-07-22T08:32:24.811Z</updated>
    
    <content type="html"><![CDATA[<h1 id="默认开启了rbd的一些属性"><a href="#默认开启了rbd的一些属性" class="headerlink" title="默认开启了rbd的一些属性"></a>默认开启了rbd的一些属性</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@ceph1 ~]# ceph --show-config|grep rbd|grep features</span><br><span class="line">rbd_default_features = 61</span><br></pre></td></tr></table></figure><p>RBD属性表： </p><p><img src="https://shenshengkun.github.io/images/ceph_rbd_shuxing.png" alt=""></p><p>61的意思是上面图中的bit码相加得到的值<br>对rbd进行内核的map操作</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@ceph1 ~]# rbd map mytest</span><br><span class="line">rbd: sysfs write failed</span><br><span class="line">RBD image feature set mismatch. You can disable features unsupported by the kernel with &quot;rbd feature disable&quot;.</span><br><span class="line">In some cases useful info is found in syslog - try &quot;dmesg | tail&quot; or so.</span><br><span class="line">rbd: map failed: (6) No such device or address</span><br></pre></td></tr></table></figure><p>根据提示查询打印的信息</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@ceph1 ~]# dmesg | tail</span><br><span class="line">[10440.462708] rbd: image mytest: image uses unsupported features: 0x3c</span><br></pre></td></tr></table></figure><p>这个地方提示的很清楚了，不支持的属性0x3c，0x3c是16进制的数值，换算成10进制是3*16+12=60<br>60的意思是不支持：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">32+16+8+4 = exclusive-lock, object-map, fast-diff, deep-flatten</span><br><span class="line"></span><br><span class="line">也就是不支持这些属性，现在动态关闭这些属性</span><br></pre></td></tr></table></figure><h1 id="关闭这些属性"><a href="#关闭这些属性" class="headerlink" title="关闭这些属性"></a>关闭这些属性</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rbd feature disable &#123;poolname&#125;/&#123;imagename&#125; &#123;feature&#125;</span><br></pre></td></tr></table></figure><p>如果不想动态的关闭，那么在创建rbd之前，在配置文件中设置这个参数即可</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">rbd_default_features = 3</span><br><span class="line"></span><br><span class="line">关于属性支持的，目前到内核4.6仍然只支持</span><br><span class="line"></span><br><span class="line">layering,striping = 1 + 2</span><br><span class="line"></span><br><span class="line">这两个属性</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;默认开启了rbd的一些属性&quot;&gt;&lt;a href=&quot;#默认开启了rbd的一些属性&quot; class=&quot;headerlink&quot; title=&quot;默认开启了rbd的一些属性&quot;&gt;&lt;/a&gt;默认开启了rbd的一些属性&lt;/h1&gt;&lt;figure class=&quot;highlight plai
      
    
    </summary>
    
      <category term="ceph" scheme="https://shenshengkun.github.io/categories/ceph/"/>
    
    
  </entry>
  
  <entry>
    <title>prometheus监控ceph集群</title>
    <link href="https://shenshengkun.github.io/posts/dk8973fg.html"/>
    <id>https://shenshengkun.github.io/posts/dk8973fg.html</id>
    <published>2019-07-19T05:49:01.000Z</published>
    <updated>2019-08-02T03:26:04.923Z</updated>
    
    <content type="html"><![CDATA[<h1 id="安装ceph-exporter"><a href="#安装ceph-exporter" class="headerlink" title="安装ceph_exporter"></a>安装ceph_exporter</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">yum install golang -y</span><br><span class="line">yum install librados2-devel librbd1-devel -y</span><br><span class="line"></span><br><span class="line"># 配置go PATH环境变量：</span><br><span class="line">[root@ceph1 bin]# cat /etc/profile.d/go.sh </span><br><span class="line">export GOROOT=/usr/lib/golang</span><br><span class="line">export GOBIN=$GOROOT/bin</span><br><span class="line">export GOPATH=/usr/local/go</span><br><span class="line">export PATH=$PATH:$GOROOT/bin:$GOPATH/bin</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">source /etc/profile.d/go.sh</span><br><span class="line">mkdir /usr/local/go</span><br><span class="line"></span><br><span class="line">编译：</span><br><span class="line">mkdir -p /usr/local/go/src/github.com/digitalocean</span><br><span class="line">cd /usr/local/go/src/github.com/digitalocean</span><br><span class="line">git clone https://github.com/digitalocean/ceph_exporter</span><br><span class="line">cd ceph_exporter/</span><br><span class="line">go build</span><br><span class="line">mkdir  /usr/local/go/bin</span><br><span class="line">cp ceph_exporter /usr/local/go/bin/</span><br><span class="line">cd /usr/local/bin/</span><br><span class="line"></span><br><span class="line">启动：</span><br><span class="line">nohup ./ceph_exporter &gt;&gt; ceph_exporter.log &amp;</span><br></pre></td></tr></table></figure><h1 id="prometheus配置"><a href="#prometheus配置" class="headerlink" title="prometheus配置"></a>prometheus配置</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">- job_name: &apos;ceph-cluster&apos;</span><br><span class="line">  static_configs:</span><br><span class="line">  - targets: [&apos;192.168.7.31:9128&apos;]</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">重读配置</span><br><span class="line">./reload-prometheus.sh</span><br></pre></td></tr></table></figure><h1 id="grafana导入模板"><a href="#grafana导入模板" class="headerlink" title="grafana导入模板"></a>grafana导入模板</h1><p><a href="https://grafana.com/dashboards/917" target="_blank" rel="noopener">https://grafana.com/dashboards/917</a></p><p><img src="https://shenshengkun.github.io/images/ceph_cluster1.png" alt=""></p><h1 id="报警"><a href="#报警" class="headerlink" title="报警"></a>报警</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">############ ceph cluster 监控 ############</span><br><span class="line">- alert: Ceph OSD Down</span><br><span class="line">  expr: ceph_osd_down &gt; 0</span><br><span class="line">  for: 2m</span><br><span class="line">  labels:</span><br><span class="line">    status: 监控osd</span><br><span class="line">  annotations:</span><br><span class="line">    description: &quot;&#123;&#123;$labels.instance&#125;&#125;: 有&#123;&#123; $value &#125;&#125;个OSD挂掉了&quot;</span><br><span class="line">    summary: &quot;&#123;&#123;$labels.instance&#125;&#125;:&#123;&#123; $labels.osd &#125;&#125;当前状态为&#123;&#123; $labels.status &#125;&#125;&quot;</span><br><span class="line">- alert: 集群空间使用率</span><br><span class="line">  expr: ceph_cluster_used_bytes / ceph_cluster_capacity_bytes * 100 &gt; 80</span><br><span class="line">  for: 2m</span><br><span class="line">  labels:</span><br><span class="line">    status: 监控ceph集群空间</span><br><span class="line">  annotations:</span><br><span class="line">    description: &quot;&#123;&#123;$labels.instance&#125;&#125;:集群空间不足&quot;</span><br><span class="line">    summary: &quot;&#123;&#123;$labels.instance&#125;&#125;:当前空间使用率为&#123;&#123; $value &#125;&#125;&quot;</span><br></pre></td></tr></table></figure><h1 id="grafana补充增加选集群变量以及osd、pool"><a href="#grafana补充增加选集群变量以及osd、pool" class="headerlink" title="grafana补充增加选集群变量以及osd、pool"></a>grafana补充增加选集群变量以及osd、pool</h1><h2 id="ceph-cluster"><a href="#ceph-cluster" class="headerlink" title="ceph-cluster"></a>ceph-cluster</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br><span class="line">911</span><br><span class="line">912</span><br><span class="line">913</span><br><span class="line">914</span><br><span class="line">915</span><br><span class="line">916</span><br><span class="line">917</span><br><span class="line">918</span><br><span class="line">919</span><br><span class="line">920</span><br><span class="line">921</span><br><span class="line">922</span><br><span class="line">923</span><br><span class="line">924</span><br><span class="line">925</span><br><span class="line">926</span><br><span class="line">927</span><br><span class="line">928</span><br><span class="line">929</span><br><span class="line">930</span><br><span class="line">931</span><br><span class="line">932</span><br><span class="line">933</span><br><span class="line">934</span><br><span class="line">935</span><br><span class="line">936</span><br><span class="line">937</span><br><span class="line">938</span><br><span class="line">939</span><br><span class="line">940</span><br><span class="line">941</span><br><span class="line">942</span><br><span class="line">943</span><br><span class="line">944</span><br><span class="line">945</span><br><span class="line">946</span><br><span class="line">947</span><br><span class="line">948</span><br><span class="line">949</span><br><span class="line">950</span><br><span class="line">951</span><br><span class="line">952</span><br><span class="line">953</span><br><span class="line">954</span><br><span class="line">955</span><br><span class="line">956</span><br><span class="line">957</span><br><span class="line">958</span><br><span class="line">959</span><br><span class="line">960</span><br><span class="line">961</span><br><span class="line">962</span><br><span class="line">963</span><br><span class="line">964</span><br><span class="line">965</span><br><span class="line">966</span><br><span class="line">967</span><br><span class="line">968</span><br><span class="line">969</span><br><span class="line">970</span><br><span class="line">971</span><br><span class="line">972</span><br><span class="line">973</span><br><span class="line">974</span><br><span class="line">975</span><br><span class="line">976</span><br><span class="line">977</span><br><span class="line">978</span><br><span class="line">979</span><br><span class="line">980</span><br><span class="line">981</span><br><span class="line">982</span><br><span class="line">983</span><br><span class="line">984</span><br><span class="line">985</span><br><span class="line">986</span><br><span class="line">987</span><br><span class="line">988</span><br><span class="line">989</span><br><span class="line">990</span><br><span class="line">991</span><br><span class="line">992</span><br><span class="line">993</span><br><span class="line">994</span><br><span class="line">995</span><br><span class="line">996</span><br><span class="line">997</span><br><span class="line">998</span><br><span class="line">999</span><br><span class="line">1000</span><br><span class="line">1001</span><br><span class="line">1002</span><br><span class="line">1003</span><br><span class="line">1004</span><br><span class="line">1005</span><br><span class="line">1006</span><br><span class="line">1007</span><br><span class="line">1008</span><br><span class="line">1009</span><br><span class="line">1010</span><br><span class="line">1011</span><br><span class="line">1012</span><br><span class="line">1013</span><br><span class="line">1014</span><br><span class="line">1015</span><br><span class="line">1016</span><br><span class="line">1017</span><br><span class="line">1018</span><br><span class="line">1019</span><br><span class="line">1020</span><br><span class="line">1021</span><br><span class="line">1022</span><br><span class="line">1023</span><br><span class="line">1024</span><br><span class="line">1025</span><br><span class="line">1026</span><br><span class="line">1027</span><br><span class="line">1028</span><br><span class="line">1029</span><br><span class="line">1030</span><br><span class="line">1031</span><br><span class="line">1032</span><br><span class="line">1033</span><br><span class="line">1034</span><br><span class="line">1035</span><br><span class="line">1036</span><br><span class="line">1037</span><br><span class="line">1038</span><br><span class="line">1039</span><br><span class="line">1040</span><br><span class="line">1041</span><br><span class="line">1042</span><br><span class="line">1043</span><br><span class="line">1044</span><br><span class="line">1045</span><br><span class="line">1046</span><br><span class="line">1047</span><br><span class="line">1048</span><br><span class="line">1049</span><br><span class="line">1050</span><br><span class="line">1051</span><br><span class="line">1052</span><br><span class="line">1053</span><br><span class="line">1054</span><br><span class="line">1055</span><br><span class="line">1056</span><br><span class="line">1057</span><br><span class="line">1058</span><br><span class="line">1059</span><br><span class="line">1060</span><br><span class="line">1061</span><br><span class="line">1062</span><br><span class="line">1063</span><br><span class="line">1064</span><br><span class="line">1065</span><br><span class="line">1066</span><br><span class="line">1067</span><br><span class="line">1068</span><br><span class="line">1069</span><br><span class="line">1070</span><br><span class="line">1071</span><br><span class="line">1072</span><br><span class="line">1073</span><br><span class="line">1074</span><br><span class="line">1075</span><br><span class="line">1076</span><br><span class="line">1077</span><br><span class="line">1078</span><br><span class="line">1079</span><br><span class="line">1080</span><br><span class="line">1081</span><br><span class="line">1082</span><br><span class="line">1083</span><br><span class="line">1084</span><br><span class="line">1085</span><br><span class="line">1086</span><br><span class="line">1087</span><br><span class="line">1088</span><br><span class="line">1089</span><br><span class="line">1090</span><br><span class="line">1091</span><br><span class="line">1092</span><br><span class="line">1093</span><br><span class="line">1094</span><br><span class="line">1095</span><br><span class="line">1096</span><br><span class="line">1097</span><br><span class="line">1098</span><br><span class="line">1099</span><br><span class="line">1100</span><br><span class="line">1101</span><br><span class="line">1102</span><br><span class="line">1103</span><br><span class="line">1104</span><br><span class="line">1105</span><br><span class="line">1106</span><br><span class="line">1107</span><br><span class="line">1108</span><br><span class="line">1109</span><br><span class="line">1110</span><br><span class="line">1111</span><br><span class="line">1112</span><br><span class="line">1113</span><br><span class="line">1114</span><br><span class="line">1115</span><br><span class="line">1116</span><br><span class="line">1117</span><br><span class="line">1118</span><br><span class="line">1119</span><br><span class="line">1120</span><br><span class="line">1121</span><br><span class="line">1122</span><br><span class="line">1123</span><br><span class="line">1124</span><br><span class="line">1125</span><br><span class="line">1126</span><br><span class="line">1127</span><br><span class="line">1128</span><br><span class="line">1129</span><br><span class="line">1130</span><br><span class="line">1131</span><br><span class="line">1132</span><br><span class="line">1133</span><br><span class="line">1134</span><br><span class="line">1135</span><br><span class="line">1136</span><br><span class="line">1137</span><br><span class="line">1138</span><br><span class="line">1139</span><br><span class="line">1140</span><br><span class="line">1141</span><br><span class="line">1142</span><br><span class="line">1143</span><br><span class="line">1144</span><br><span class="line">1145</span><br><span class="line">1146</span><br><span class="line">1147</span><br><span class="line">1148</span><br><span class="line">1149</span><br><span class="line">1150</span><br><span class="line">1151</span><br><span class="line">1152</span><br><span class="line">1153</span><br><span class="line">1154</span><br><span class="line">1155</span><br><span class="line">1156</span><br><span class="line">1157</span><br><span class="line">1158</span><br><span class="line">1159</span><br><span class="line">1160</span><br><span class="line">1161</span><br><span class="line">1162</span><br><span class="line">1163</span><br><span class="line">1164</span><br><span class="line">1165</span><br><span class="line">1166</span><br><span class="line">1167</span><br><span class="line">1168</span><br><span class="line">1169</span><br><span class="line">1170</span><br><span class="line">1171</span><br><span class="line">1172</span><br><span class="line">1173</span><br><span class="line">1174</span><br><span class="line">1175</span><br><span class="line">1176</span><br><span class="line">1177</span><br><span class="line">1178</span><br><span class="line">1179</span><br><span class="line">1180</span><br><span class="line">1181</span><br><span class="line">1182</span><br><span class="line">1183</span><br><span class="line">1184</span><br><span class="line">1185</span><br><span class="line">1186</span><br><span class="line">1187</span><br><span class="line">1188</span><br><span class="line">1189</span><br><span class="line">1190</span><br><span class="line">1191</span><br><span class="line">1192</span><br><span class="line">1193</span><br><span class="line">1194</span><br><span class="line">1195</span><br><span class="line">1196</span><br><span class="line">1197</span><br><span class="line">1198</span><br><span class="line">1199</span><br><span class="line">1200</span><br><span class="line">1201</span><br><span class="line">1202</span><br><span class="line">1203</span><br><span class="line">1204</span><br><span class="line">1205</span><br><span class="line">1206</span><br><span class="line">1207</span><br><span class="line">1208</span><br><span class="line">1209</span><br><span class="line">1210</span><br><span class="line">1211</span><br><span class="line">1212</span><br><span class="line">1213</span><br><span class="line">1214</span><br><span class="line">1215</span><br><span class="line">1216</span><br><span class="line">1217</span><br><span class="line">1218</span><br><span class="line">1219</span><br><span class="line">1220</span><br><span class="line">1221</span><br><span class="line">1222</span><br><span class="line">1223</span><br><span class="line">1224</span><br><span class="line">1225</span><br><span class="line">1226</span><br><span class="line">1227</span><br><span class="line">1228</span><br><span class="line">1229</span><br><span class="line">1230</span><br><span class="line">1231</span><br><span class="line">1232</span><br><span class="line">1233</span><br><span class="line">1234</span><br><span class="line">1235</span><br><span class="line">1236</span><br><span class="line">1237</span><br><span class="line">1238</span><br><span class="line">1239</span><br><span class="line">1240</span><br><span class="line">1241</span><br><span class="line">1242</span><br><span class="line">1243</span><br><span class="line">1244</span><br><span class="line">1245</span><br><span class="line">1246</span><br><span class="line">1247</span><br><span class="line">1248</span><br><span class="line">1249</span><br><span class="line">1250</span><br><span class="line">1251</span><br><span class="line">1252</span><br><span class="line">1253</span><br><span class="line">1254</span><br><span class="line">1255</span><br><span class="line">1256</span><br><span class="line">1257</span><br><span class="line">1258</span><br><span class="line">1259</span><br><span class="line">1260</span><br><span class="line">1261</span><br><span class="line">1262</span><br><span class="line">1263</span><br><span class="line">1264</span><br><span class="line">1265</span><br><span class="line">1266</span><br><span class="line">1267</span><br><span class="line">1268</span><br><span class="line">1269</span><br><span class="line">1270</span><br><span class="line">1271</span><br><span class="line">1272</span><br><span class="line">1273</span><br><span class="line">1274</span><br><span class="line">1275</span><br><span class="line">1276</span><br><span class="line">1277</span><br><span class="line">1278</span><br><span class="line">1279</span><br><span class="line">1280</span><br><span class="line">1281</span><br><span class="line">1282</span><br><span class="line">1283</span><br><span class="line">1284</span><br><span class="line">1285</span><br><span class="line">1286</span><br><span class="line">1287</span><br><span class="line">1288</span><br><span class="line">1289</span><br><span class="line">1290</span><br><span class="line">1291</span><br><span class="line">1292</span><br><span class="line">1293</span><br><span class="line">1294</span><br><span class="line">1295</span><br><span class="line">1296</span><br><span class="line">1297</span><br><span class="line">1298</span><br><span class="line">1299</span><br><span class="line">1300</span><br><span class="line">1301</span><br><span class="line">1302</span><br><span class="line">1303</span><br><span class="line">1304</span><br><span class="line">1305</span><br><span class="line">1306</span><br><span class="line">1307</span><br><span class="line">1308</span><br><span class="line">1309</span><br><span class="line">1310</span><br><span class="line">1311</span><br><span class="line">1312</span><br><span class="line">1313</span><br><span class="line">1314</span><br><span class="line">1315</span><br><span class="line">1316</span><br><span class="line">1317</span><br><span class="line">1318</span><br><span class="line">1319</span><br><span class="line">1320</span><br><span class="line">1321</span><br><span class="line">1322</span><br><span class="line">1323</span><br><span class="line">1324</span><br><span class="line">1325</span><br><span class="line">1326</span><br><span class="line">1327</span><br><span class="line">1328</span><br><span class="line">1329</span><br><span class="line">1330</span><br><span class="line">1331</span><br><span class="line">1332</span><br><span class="line">1333</span><br><span class="line">1334</span><br><span class="line">1335</span><br><span class="line">1336</span><br><span class="line">1337</span><br><span class="line">1338</span><br><span class="line">1339</span><br><span class="line">1340</span><br><span class="line">1341</span><br><span class="line">1342</span><br><span class="line">1343</span><br><span class="line">1344</span><br><span class="line">1345</span><br><span class="line">1346</span><br><span class="line">1347</span><br><span class="line">1348</span><br><span class="line">1349</span><br><span class="line">1350</span><br><span class="line">1351</span><br><span class="line">1352</span><br><span class="line">1353</span><br><span class="line">1354</span><br><span class="line">1355</span><br><span class="line">1356</span><br><span class="line">1357</span><br><span class="line">1358</span><br><span class="line">1359</span><br><span class="line">1360</span><br><span class="line">1361</span><br><span class="line">1362</span><br><span class="line">1363</span><br><span class="line">1364</span><br><span class="line">1365</span><br><span class="line">1366</span><br><span class="line">1367</span><br><span class="line">1368</span><br><span class="line">1369</span><br><span class="line">1370</span><br><span class="line">1371</span><br><span class="line">1372</span><br><span class="line">1373</span><br><span class="line">1374</span><br><span class="line">1375</span><br><span class="line">1376</span><br><span class="line">1377</span><br><span class="line">1378</span><br><span class="line">1379</span><br><span class="line">1380</span><br><span class="line">1381</span><br><span class="line">1382</span><br><span class="line">1383</span><br><span class="line">1384</span><br><span class="line">1385</span><br><span class="line">1386</span><br><span class="line">1387</span><br><span class="line">1388</span><br><span class="line">1389</span><br><span class="line">1390</span><br><span class="line">1391</span><br><span class="line">1392</span><br><span class="line">1393</span><br><span class="line">1394</span><br><span class="line">1395</span><br><span class="line">1396</span><br><span class="line">1397</span><br><span class="line">1398</span><br><span class="line">1399</span><br><span class="line">1400</span><br><span class="line">1401</span><br><span class="line">1402</span><br><span class="line">1403</span><br><span class="line">1404</span><br><span class="line">1405</span><br><span class="line">1406</span><br><span class="line">1407</span><br><span class="line">1408</span><br><span class="line">1409</span><br><span class="line">1410</span><br><span class="line">1411</span><br><span class="line">1412</span><br><span class="line">1413</span><br><span class="line">1414</span><br><span class="line">1415</span><br><span class="line">1416</span><br><span class="line">1417</span><br><span class="line">1418</span><br><span class="line">1419</span><br><span class="line">1420</span><br><span class="line">1421</span><br><span class="line">1422</span><br><span class="line">1423</span><br><span class="line">1424</span><br><span class="line">1425</span><br><span class="line">1426</span><br><span class="line">1427</span><br><span class="line">1428</span><br><span class="line">1429</span><br><span class="line">1430</span><br><span class="line">1431</span><br><span class="line">1432</span><br><span class="line">1433</span><br><span class="line">1434</span><br><span class="line">1435</span><br><span class="line">1436</span><br><span class="line">1437</span><br><span class="line">1438</span><br><span class="line">1439</span><br><span class="line">1440</span><br><span class="line">1441</span><br><span class="line">1442</span><br><span class="line">1443</span><br><span class="line">1444</span><br><span class="line">1445</span><br><span class="line">1446</span><br><span class="line">1447</span><br><span class="line">1448</span><br><span class="line">1449</span><br><span class="line">1450</span><br><span class="line">1451</span><br><span class="line">1452</span><br><span class="line">1453</span><br><span class="line">1454</span><br><span class="line">1455</span><br><span class="line">1456</span><br><span class="line">1457</span><br><span class="line">1458</span><br><span class="line">1459</span><br><span class="line">1460</span><br><span class="line">1461</span><br><span class="line">1462</span><br><span class="line">1463</span><br><span class="line">1464</span><br><span class="line">1465</span><br><span class="line">1466</span><br><span class="line">1467</span><br><span class="line">1468</span><br><span class="line">1469</span><br><span class="line">1470</span><br><span class="line">1471</span><br><span class="line">1472</span><br><span class="line">1473</span><br><span class="line">1474</span><br><span class="line">1475</span><br><span class="line">1476</span><br><span class="line">1477</span><br><span class="line">1478</span><br><span class="line">1479</span><br><span class="line">1480</span><br><span class="line">1481</span><br><span class="line">1482</span><br><span class="line">1483</span><br><span class="line">1484</span><br><span class="line">1485</span><br><span class="line">1486</span><br><span class="line">1487</span><br><span class="line">1488</span><br><span class="line">1489</span><br><span class="line">1490</span><br><span class="line">1491</span><br><span class="line">1492</span><br><span class="line">1493</span><br><span class="line">1494</span><br><span class="line">1495</span><br><span class="line">1496</span><br><span class="line">1497</span><br><span class="line">1498</span><br><span class="line">1499</span><br><span class="line">1500</span><br><span class="line">1501</span><br><span class="line">1502</span><br><span class="line">1503</span><br><span class="line">1504</span><br><span class="line">1505</span><br><span class="line">1506</span><br><span class="line">1507</span><br><span class="line">1508</span><br><span class="line">1509</span><br><span class="line">1510</span><br><span class="line">1511</span><br><span class="line">1512</span><br><span class="line">1513</span><br><span class="line">1514</span><br><span class="line">1515</span><br><span class="line">1516</span><br><span class="line">1517</span><br><span class="line">1518</span><br><span class="line">1519</span><br><span class="line">1520</span><br><span class="line">1521</span><br><span class="line">1522</span><br><span class="line">1523</span><br><span class="line">1524</span><br><span class="line">1525</span><br><span class="line">1526</span><br><span class="line">1527</span><br><span class="line">1528</span><br><span class="line">1529</span><br><span class="line">1530</span><br><span class="line">1531</span><br><span class="line">1532</span><br><span class="line">1533</span><br><span class="line">1534</span><br><span class="line">1535</span><br><span class="line">1536</span><br><span class="line">1537</span><br><span class="line">1538</span><br><span class="line">1539</span><br><span class="line">1540</span><br><span class="line">1541</span><br><span class="line">1542</span><br><span class="line">1543</span><br><span class="line">1544</span><br><span class="line">1545</span><br><span class="line">1546</span><br><span class="line">1547</span><br><span class="line">1548</span><br><span class="line">1549</span><br><span class="line">1550</span><br><span class="line">1551</span><br><span class="line">1552</span><br><span class="line">1553</span><br><span class="line">1554</span><br><span class="line">1555</span><br><span class="line">1556</span><br><span class="line">1557</span><br><span class="line">1558</span><br><span class="line">1559</span><br><span class="line">1560</span><br><span class="line">1561</span><br><span class="line">1562</span><br><span class="line">1563</span><br><span class="line">1564</span><br><span class="line">1565</span><br><span class="line">1566</span><br><span class="line">1567</span><br><span class="line">1568</span><br><span class="line">1569</span><br><span class="line">1570</span><br><span class="line">1571</span><br><span class="line">1572</span><br><span class="line">1573</span><br><span class="line">1574</span><br><span class="line">1575</span><br><span class="line">1576</span><br><span class="line">1577</span><br><span class="line">1578</span><br><span class="line">1579</span><br><span class="line">1580</span><br><span class="line">1581</span><br><span class="line">1582</span><br><span class="line">1583</span><br><span class="line">1584</span><br><span class="line">1585</span><br><span class="line">1586</span><br><span class="line">1587</span><br><span class="line">1588</span><br><span class="line">1589</span><br><span class="line">1590</span><br><span class="line">1591</span><br><span class="line">1592</span><br><span class="line">1593</span><br><span class="line">1594</span><br><span class="line">1595</span><br><span class="line">1596</span><br><span class="line">1597</span><br><span class="line">1598</span><br><span class="line">1599</span><br><span class="line">1600</span><br><span class="line">1601</span><br><span class="line">1602</span><br><span class="line">1603</span><br><span class="line">1604</span><br><span class="line">1605</span><br><span class="line">1606</span><br><span class="line">1607</span><br><span class="line">1608</span><br><span class="line">1609</span><br><span class="line">1610</span><br><span class="line">1611</span><br><span class="line">1612</span><br><span class="line">1613</span><br><span class="line">1614</span><br><span class="line">1615</span><br><span class="line">1616</span><br><span class="line">1617</span><br><span class="line">1618</span><br><span class="line">1619</span><br><span class="line">1620</span><br><span class="line">1621</span><br><span class="line">1622</span><br><span class="line">1623</span><br><span class="line">1624</span><br><span class="line">1625</span><br><span class="line">1626</span><br><span class="line">1627</span><br><span class="line">1628</span><br><span class="line">1629</span><br><span class="line">1630</span><br><span class="line">1631</span><br><span class="line">1632</span><br><span class="line">1633</span><br><span class="line">1634</span><br><span class="line">1635</span><br><span class="line">1636</span><br><span class="line">1637</span><br><span class="line">1638</span><br><span class="line">1639</span><br><span class="line">1640</span><br><span class="line">1641</span><br><span class="line">1642</span><br><span class="line">1643</span><br><span class="line">1644</span><br><span class="line">1645</span><br><span class="line">1646</span><br><span class="line">1647</span><br><span class="line">1648</span><br><span class="line">1649</span><br><span class="line">1650</span><br><span class="line">1651</span><br><span class="line">1652</span><br><span class="line">1653</span><br><span class="line">1654</span><br><span class="line">1655</span><br><span class="line">1656</span><br><span class="line">1657</span><br><span class="line">1658</span><br><span class="line">1659</span><br><span class="line">1660</span><br><span class="line">1661</span><br><span class="line">1662</span><br><span class="line">1663</span><br><span class="line">1664</span><br><span class="line">1665</span><br><span class="line">1666</span><br><span class="line">1667</span><br><span class="line">1668</span><br><span class="line">1669</span><br><span class="line">1670</span><br><span class="line">1671</span><br><span class="line">1672</span><br><span class="line">1673</span><br><span class="line">1674</span><br><span class="line">1675</span><br><span class="line">1676</span><br><span class="line">1677</span><br><span class="line">1678</span><br><span class="line">1679</span><br><span class="line">1680</span><br><span class="line">1681</span><br><span class="line">1682</span><br><span class="line">1683</span><br><span class="line">1684</span><br><span class="line">1685</span><br><span class="line">1686</span><br><span class="line">1687</span><br><span class="line">1688</span><br><span class="line">1689</span><br><span class="line">1690</span><br><span class="line">1691</span><br><span class="line">1692</span><br><span class="line">1693</span><br><span class="line">1694</span><br><span class="line">1695</span><br><span class="line">1696</span><br><span class="line">1697</span><br><span class="line">1698</span><br><span class="line">1699</span><br><span class="line">1700</span><br><span class="line">1701</span><br><span class="line">1702</span><br><span class="line">1703</span><br><span class="line">1704</span><br><span class="line">1705</span><br><span class="line">1706</span><br><span class="line">1707</span><br><span class="line">1708</span><br><span class="line">1709</span><br><span class="line">1710</span><br><span class="line">1711</span><br><span class="line">1712</span><br><span class="line">1713</span><br><span class="line">1714</span><br><span class="line">1715</span><br><span class="line">1716</span><br><span class="line">1717</span><br><span class="line">1718</span><br><span class="line">1719</span><br><span class="line">1720</span><br><span class="line">1721</span><br><span class="line">1722</span><br><span class="line">1723</span><br><span class="line">1724</span><br><span class="line">1725</span><br><span class="line">1726</span><br><span class="line">1727</span><br><span class="line">1728</span><br><span class="line">1729</span><br><span class="line">1730</span><br><span class="line">1731</span><br><span class="line">1732</span><br><span class="line">1733</span><br><span class="line">1734</span><br><span class="line">1735</span><br><span class="line">1736</span><br><span class="line">1737</span><br><span class="line">1738</span><br><span class="line">1739</span><br><span class="line">1740</span><br><span class="line">1741</span><br><span class="line">1742</span><br><span class="line">1743</span><br><span class="line">1744</span><br><span class="line">1745</span><br><span class="line">1746</span><br><span class="line">1747</span><br><span class="line">1748</span><br><span class="line">1749</span><br><span class="line">1750</span><br><span class="line">1751</span><br><span class="line">1752</span><br><span class="line">1753</span><br><span class="line">1754</span><br><span class="line">1755</span><br><span class="line">1756</span><br><span class="line">1757</span><br><span class="line">1758</span><br><span class="line">1759</span><br><span class="line">1760</span><br><span class="line">1761</span><br><span class="line">1762</span><br><span class="line">1763</span><br><span class="line">1764</span><br><span class="line">1765</span><br><span class="line">1766</span><br><span class="line">1767</span><br><span class="line">1768</span><br><span class="line">1769</span><br><span class="line">1770</span><br><span class="line">1771</span><br><span class="line">1772</span><br><span class="line">1773</span><br><span class="line">1774</span><br><span class="line">1775</span><br><span class="line">1776</span><br><span class="line">1777</span><br><span class="line">1778</span><br><span class="line">1779</span><br><span class="line">1780</span><br><span class="line">1781</span><br><span class="line">1782</span><br><span class="line">1783</span><br><span class="line">1784</span><br><span class="line">1785</span><br><span class="line">1786</span><br><span class="line">1787</span><br><span class="line">1788</span><br><span class="line">1789</span><br><span class="line">1790</span><br><span class="line">1791</span><br><span class="line">1792</span><br><span class="line">1793</span><br><span class="line">1794</span><br><span class="line">1795</span><br><span class="line">1796</span><br><span class="line">1797</span><br><span class="line">1798</span><br><span class="line">1799</span><br><span class="line">1800</span><br><span class="line">1801</span><br><span class="line">1802</span><br><span class="line">1803</span><br><span class="line">1804</span><br><span class="line">1805</span><br><span class="line">1806</span><br><span class="line">1807</span><br><span class="line">1808</span><br><span class="line">1809</span><br><span class="line">1810</span><br><span class="line">1811</span><br><span class="line">1812</span><br><span class="line">1813</span><br><span class="line">1814</span><br><span class="line">1815</span><br><span class="line">1816</span><br><span class="line">1817</span><br><span class="line">1818</span><br><span class="line">1819</span><br><span class="line">1820</span><br><span class="line">1821</span><br><span class="line">1822</span><br><span class="line">1823</span><br><span class="line">1824</span><br><span class="line">1825</span><br><span class="line">1826</span><br><span class="line">1827</span><br><span class="line">1828</span><br><span class="line">1829</span><br><span class="line">1830</span><br><span class="line">1831</span><br><span class="line">1832</span><br><span class="line">1833</span><br><span class="line">1834</span><br><span class="line">1835</span><br><span class="line">1836</span><br><span class="line">1837</span><br><span class="line">1838</span><br><span class="line">1839</span><br><span class="line">1840</span><br><span class="line">1841</span><br><span class="line">1842</span><br><span class="line">1843</span><br><span class="line">1844</span><br><span class="line">1845</span><br><span class="line">1846</span><br><span class="line">1847</span><br><span class="line">1848</span><br><span class="line">1849</span><br><span class="line">1850</span><br><span class="line">1851</span><br><span class="line">1852</span><br><span class="line">1853</span><br><span class="line">1854</span><br><span class="line">1855</span><br><span class="line">1856</span><br><span class="line">1857</span><br><span class="line">1858</span><br><span class="line">1859</span><br><span class="line">1860</span><br><span class="line">1861</span><br><span class="line">1862</span><br><span class="line">1863</span><br><span class="line">1864</span><br><span class="line">1865</span><br><span class="line">1866</span><br><span class="line">1867</span><br><span class="line">1868</span><br><span class="line">1869</span><br><span class="line">1870</span><br><span class="line">1871</span><br><span class="line">1872</span><br><span class="line">1873</span><br><span class="line">1874</span><br><span class="line">1875</span><br><span class="line">1876</span><br><span class="line">1877</span><br><span class="line">1878</span><br><span class="line">1879</span><br><span class="line">1880</span><br><span class="line">1881</span><br><span class="line">1882</span><br><span class="line">1883</span><br><span class="line">1884</span><br><span class="line">1885</span><br><span class="line">1886</span><br><span class="line">1887</span><br><span class="line">1888</span><br><span class="line">1889</span><br><span class="line">1890</span><br><span class="line">1891</span><br><span class="line">1892</span><br><span class="line">1893</span><br><span class="line">1894</span><br><span class="line">1895</span><br><span class="line">1896</span><br><span class="line">1897</span><br><span class="line">1898</span><br><span class="line">1899</span><br><span class="line">1900</span><br><span class="line">1901</span><br><span class="line">1902</span><br><span class="line">1903</span><br><span class="line">1904</span><br><span class="line">1905</span><br><span class="line">1906</span><br><span class="line">1907</span><br><span class="line">1908</span><br><span class="line">1909</span><br><span class="line">1910</span><br><span class="line">1911</span><br><span class="line">1912</span><br><span class="line">1913</span><br><span class="line">1914</span><br><span class="line">1915</span><br><span class="line">1916</span><br><span class="line">1917</span><br><span class="line">1918</span><br><span class="line">1919</span><br><span class="line">1920</span><br><span class="line">1921</span><br><span class="line">1922</span><br><span class="line">1923</span><br><span class="line">1924</span><br><span class="line">1925</span><br><span class="line">1926</span><br><span class="line">1927</span><br><span class="line">1928</span><br><span class="line">1929</span><br><span class="line">1930</span><br><span class="line">1931</span><br><span class="line">1932</span><br><span class="line">1933</span><br><span class="line">1934</span><br><span class="line">1935</span><br><span class="line">1936</span><br><span class="line">1937</span><br><span class="line">1938</span><br><span class="line">1939</span><br><span class="line">1940</span><br><span class="line">1941</span><br><span class="line">1942</span><br><span class="line">1943</span><br><span class="line">1944</span><br><span class="line">1945</span><br><span class="line">1946</span><br><span class="line">1947</span><br><span class="line">1948</span><br><span class="line">1949</span><br><span class="line">1950</span><br><span class="line">1951</span><br><span class="line">1952</span><br><span class="line">1953</span><br><span class="line">1954</span><br><span class="line">1955</span><br><span class="line">1956</span><br><span class="line">1957</span><br><span class="line">1958</span><br><span class="line">1959</span><br><span class="line">1960</span><br><span class="line">1961</span><br><span class="line">1962</span><br><span class="line">1963</span><br><span class="line">1964</span><br><span class="line">1965</span><br><span class="line">1966</span><br><span class="line">1967</span><br><span class="line">1968</span><br><span class="line">1969</span><br><span class="line">1970</span><br><span class="line">1971</span><br><span class="line">1972</span><br><span class="line">1973</span><br><span class="line">1974</span><br><span class="line">1975</span><br><span class="line">1976</span><br><span class="line">1977</span><br><span class="line">1978</span><br><span class="line">1979</span><br><span class="line">1980</span><br><span class="line">1981</span><br><span class="line">1982</span><br><span class="line">1983</span><br><span class="line">1984</span><br><span class="line">1985</span><br><span class="line">1986</span><br><span class="line">1987</span><br><span class="line">1988</span><br><span class="line">1989</span><br><span class="line">1990</span><br><span class="line">1991</span><br><span class="line">1992</span><br><span class="line">1993</span><br><span class="line">1994</span><br><span class="line">1995</span><br><span class="line">1996</span><br><span class="line">1997</span><br><span class="line">1998</span><br><span class="line">1999</span><br><span class="line">2000</span><br><span class="line">2001</span><br><span class="line">2002</span><br><span class="line">2003</span><br><span class="line">2004</span><br><span class="line">2005</span><br><span class="line">2006</span><br><span class="line">2007</span><br><span class="line">2008</span><br><span class="line">2009</span><br><span class="line">2010</span><br><span class="line">2011</span><br><span class="line">2012</span><br><span class="line">2013</span><br><span class="line">2014</span><br><span class="line">2015</span><br><span class="line">2016</span><br><span class="line">2017</span><br><span class="line">2018</span><br><span class="line">2019</span><br><span class="line">2020</span><br><span class="line">2021</span><br><span class="line">2022</span><br><span class="line">2023</span><br><span class="line">2024</span><br><span class="line">2025</span><br><span class="line">2026</span><br><span class="line">2027</span><br><span class="line">2028</span><br><span class="line">2029</span><br><span class="line">2030</span><br><span class="line">2031</span><br><span class="line">2032</span><br><span class="line">2033</span><br><span class="line">2034</span><br><span class="line">2035</span><br><span class="line">2036</span><br><span class="line">2037</span><br><span class="line">2038</span><br><span class="line">2039</span><br><span class="line">2040</span><br><span class="line">2041</span><br><span class="line">2042</span><br><span class="line">2043</span><br><span class="line">2044</span><br><span class="line">2045</span><br><span class="line">2046</span><br><span class="line">2047</span><br><span class="line">2048</span><br><span class="line">2049</span><br><span class="line">2050</span><br><span class="line">2051</span><br><span class="line">2052</span><br><span class="line">2053</span><br><span class="line">2054</span><br><span class="line">2055</span><br><span class="line">2056</span><br><span class="line">2057</span><br><span class="line">2058</span><br><span class="line">2059</span><br><span class="line">2060</span><br><span class="line">2061</span><br><span class="line">2062</span><br><span class="line">2063</span><br><span class="line">2064</span><br><span class="line">2065</span><br><span class="line">2066</span><br><span class="line">2067</span><br><span class="line">2068</span><br><span class="line">2069</span><br><span class="line">2070</span><br><span class="line">2071</span><br><span class="line">2072</span><br><span class="line">2073</span><br><span class="line">2074</span><br><span class="line">2075</span><br><span class="line">2076</span><br><span class="line">2077</span><br><span class="line">2078</span><br><span class="line">2079</span><br><span class="line">2080</span><br><span class="line">2081</span><br><span class="line">2082</span><br><span class="line">2083</span><br><span class="line">2084</span><br><span class="line">2085</span><br><span class="line">2086</span><br><span class="line">2087</span><br><span class="line">2088</span><br><span class="line">2089</span><br><span class="line">2090</span><br><span class="line">2091</span><br><span class="line">2092</span><br><span class="line">2093</span><br><span class="line">2094</span><br><span class="line">2095</span><br><span class="line">2096</span><br><span class="line">2097</span><br><span class="line">2098</span><br><span class="line">2099</span><br><span class="line">2100</span><br><span class="line">2101</span><br><span class="line">2102</span><br><span class="line">2103</span><br><span class="line">2104</span><br><span class="line">2105</span><br><span class="line">2106</span><br><span class="line">2107</span><br><span class="line">2108</span><br><span class="line">2109</span><br><span class="line">2110</span><br><span class="line">2111</span><br><span class="line">2112</span><br><span class="line">2113</span><br><span class="line">2114</span><br><span class="line">2115</span><br><span class="line">2116</span><br><span class="line">2117</span><br><span class="line">2118</span><br><span class="line">2119</span><br><span class="line">2120</span><br><span class="line">2121</span><br><span class="line">2122</span><br><span class="line">2123</span><br><span class="line">2124</span><br><span class="line">2125</span><br><span class="line">2126</span><br><span class="line">2127</span><br><span class="line">2128</span><br><span class="line">2129</span><br><span class="line">2130</span><br><span class="line">2131</span><br><span class="line">2132</span><br><span class="line">2133</span><br><span class="line">2134</span><br><span class="line">2135</span><br><span class="line">2136</span><br><span class="line">2137</span><br><span class="line">2138</span><br><span class="line">2139</span><br><span class="line">2140</span><br><span class="line">2141</span><br><span class="line">2142</span><br><span class="line">2143</span><br><span class="line">2144</span><br><span class="line">2145</span><br><span class="line">2146</span><br><span class="line">2147</span><br><span class="line">2148</span><br><span class="line">2149</span><br><span class="line">2150</span><br><span class="line">2151</span><br><span class="line">2152</span><br><span class="line">2153</span><br><span class="line">2154</span><br><span class="line">2155</span><br><span class="line">2156</span><br><span class="line">2157</span><br><span class="line">2158</span><br><span class="line">2159</span><br><span class="line">2160</span><br><span class="line">2161</span><br><span class="line">2162</span><br><span class="line">2163</span><br><span class="line">2164</span><br><span class="line">2165</span><br><span class="line">2166</span><br><span class="line">2167</span><br><span class="line">2168</span><br><span class="line">2169</span><br><span class="line">2170</span><br><span class="line">2171</span><br><span class="line">2172</span><br><span class="line">2173</span><br><span class="line">2174</span><br><span class="line">2175</span><br><span class="line">2176</span><br><span class="line">2177</span><br><span class="line">2178</span><br><span class="line">2179</span><br><span class="line">2180</span><br><span class="line">2181</span><br><span class="line">2182</span><br><span class="line">2183</span><br><span class="line">2184</span><br><span class="line">2185</span><br><span class="line">2186</span><br><span class="line">2187</span><br><span class="line">2188</span><br><span class="line">2189</span><br><span class="line">2190</span><br><span class="line">2191</span><br><span class="line">2192</span><br><span class="line">2193</span><br><span class="line">2194</span><br><span class="line">2195</span><br><span class="line">2196</span><br><span class="line">2197</span><br><span class="line">2198</span><br><span class="line">2199</span><br><span class="line">2200</span><br><span class="line">2201</span><br><span class="line">2202</span><br><span class="line">2203</span><br><span class="line">2204</span><br><span class="line">2205</span><br><span class="line">2206</span><br><span class="line">2207</span><br><span class="line">2208</span><br><span class="line">2209</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;annotations&quot;: &#123;</span><br><span class="line">    &quot;list&quot;: []</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;description&quot;: &quot;Ceph Cluster overview.\r\n&quot;,</span><br><span class="line">  &quot;editable&quot;: true,</span><br><span class="line">  &quot;gnetId&quot;: 917,</span><br><span class="line">  &quot;graphTooltip&quot;: 0,</span><br><span class="line">  &quot;hideControls&quot;: false,</span><br><span class="line">  &quot;id&quot;: 20,</span><br><span class="line">  &quot;links&quot;: [],</span><br><span class="line">  &quot;refresh&quot;: &quot;1m&quot;,</span><br><span class="line">  &quot;rows&quot;: [</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;collapse&quot;: false,</span><br><span class="line">      &quot;height&quot;: &quot;150px&quot;,</span><br><span class="line">      &quot;panels&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;cacheTimeout&quot;: null,</span><br><span class="line">          &quot;colorBackground&quot;: false,</span><br><span class="line">          &quot;colorValue&quot;: true,</span><br><span class="line">          &quot;colors&quot;: [</span><br><span class="line">            &quot;rgba(245, 54, 54, 0.9)&quot;,</span><br><span class="line">            &quot;rgba(237, 129, 40, 0.89)&quot;,</span><br><span class="line">            &quot;rgba(50, 172, 45, 0.97)&quot;</span><br><span class="line">          ],</span><br><span class="line">          &quot;datasource&quot;: &quot;prometheus&quot;,</span><br><span class="line">          &quot;editable&quot;: true,</span><br><span class="line">          &quot;error&quot;: false,</span><br><span class="line">          &quot;format&quot;: &quot;none&quot;,</span><br><span class="line">          &quot;gauge&quot;: &#123;</span><br><span class="line">            &quot;maxValue&quot;: 100,</span><br><span class="line">            &quot;minValue&quot;: 0,</span><br><span class="line">            &quot;show&quot;: false,</span><br><span class="line">            &quot;thresholdLabels&quot;: false,</span><br><span class="line">            &quot;thresholdMarkers&quot;: true</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;id&quot;: 21,</span><br><span class="line">          &quot;interval&quot;: &quot;1m&quot;,</span><br><span class="line">          &quot;links&quot;: [],</span><br><span class="line">          &quot;mappingType&quot;: 1,</span><br><span class="line">          &quot;mappingTypes&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;name&quot;: &quot;value to text&quot;,</span><br><span class="line">              &quot;value&quot;: 1</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;name&quot;: &quot;range to text&quot;,</span><br><span class="line">              &quot;value&quot;: 2</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;maxDataPoints&quot;: 100,</span><br><span class="line">          &quot;nullPointMode&quot;: &quot;connected&quot;,</span><br><span class="line">          &quot;nullText&quot;: null,</span><br><span class="line">          &quot;postfix&quot;: &quot;&quot;,</span><br><span class="line">          &quot;postfixFontSize&quot;: &quot;50%&quot;,</span><br><span class="line">          &quot;prefix&quot;: &quot;&quot;,</span><br><span class="line">          &quot;prefixFontSize&quot;: &quot;50%&quot;,</span><br><span class="line">          &quot;rangeMaps&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;from&quot;: &quot;null&quot;,</span><br><span class="line">              &quot;text&quot;: &quot;N/A&quot;,</span><br><span class="line">              &quot;to&quot;: &quot;null&quot;</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;span&quot;: 2,</span><br><span class="line">          &quot;sparkline&quot;: &#123;</span><br><span class="line">            &quot;fillColor&quot;: &quot;rgba(31, 118, 189, 0.18)&quot;,</span><br><span class="line">            &quot;full&quot;: false,</span><br><span class="line">            &quot;lineColor&quot;: &quot;rgb(31, 120, 193)&quot;,</span><br><span class="line">            &quot;show&quot;: false</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;targets&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;expr&quot;: &quot;ceph_health_status&#123;job=\&quot;$export\&quot;&#125;&quot;,</span><br><span class="line">              &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">              &quot;intervalFactor&quot;: 1,</span><br><span class="line">              &quot;refId&quot;: &quot;A&quot;,</span><br><span class="line">              &quot;step&quot;: 10</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;thresholds&quot;: &quot;1,0&quot;,</span><br><span class="line">          &quot;title&quot;: &quot;Status&quot;,</span><br><span class="line">          &quot;transparent&quot;: false,</span><br><span class="line">          &quot;type&quot;: &quot;singlestat&quot;,</span><br><span class="line">          &quot;valueFontSize&quot;: &quot;100%&quot;,</span><br><span class="line">          &quot;valueMaps&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;op&quot;: &quot;=&quot;,</span><br><span class="line">              &quot;text&quot;: &quot;N/A&quot;,</span><br><span class="line">              &quot;value&quot;: &quot;null&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;op&quot;: &quot;=&quot;,</span><br><span class="line">              &quot;text&quot;: &quot;HEALTHY&quot;,</span><br><span class="line">              &quot;value&quot;: &quot;0&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;op&quot;: &quot;=&quot;,</span><br><span class="line">              &quot;text&quot;: &quot;WARNING&quot;,</span><br><span class="line">              &quot;value&quot;: &quot;1&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;op&quot;: &quot;=&quot;,</span><br><span class="line">              &quot;text&quot;: &quot;ERROR&quot;,</span><br><span class="line">              &quot;value&quot;: &quot;2&quot;</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;valueName&quot;: &quot;current&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;cacheTimeout&quot;: null,</span><br><span class="line">          &quot;colorBackground&quot;: false,</span><br><span class="line">          &quot;colorValue&quot;: true,</span><br><span class="line">          &quot;colors&quot;: [</span><br><span class="line">            &quot;rgba(245, 54, 54, 0.9)&quot;,</span><br><span class="line">            &quot;rgba(237, 129, 40, 0.89)&quot;,</span><br><span class="line">            &quot;rgba(50, 172, 45, 0.97)&quot;</span><br><span class="line">          ],</span><br><span class="line">          &quot;datasource&quot;: &quot;prometheus&quot;,</span><br><span class="line">          &quot;editable&quot;: true,</span><br><span class="line">          &quot;error&quot;: false,</span><br><span class="line">          &quot;format&quot;: &quot;none&quot;,</span><br><span class="line">          &quot;gauge&quot;: &#123;</span><br><span class="line">            &quot;maxValue&quot;: 100,</span><br><span class="line">            &quot;minValue&quot;: 0,</span><br><span class="line">            &quot;show&quot;: false,</span><br><span class="line">            &quot;thresholdLabels&quot;: false,</span><br><span class="line">            &quot;thresholdMarkers&quot;: true</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;id&quot;: 14,</span><br><span class="line">          &quot;interval&quot;: &quot;1m&quot;,</span><br><span class="line">          &quot;links&quot;: [],</span><br><span class="line">          &quot;mappingType&quot;: 1,</span><br><span class="line">          &quot;mappingTypes&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;name&quot;: &quot;value to text&quot;,</span><br><span class="line">              &quot;value&quot;: 1</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;name&quot;: &quot;range to text&quot;,</span><br><span class="line">              &quot;value&quot;: 2</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;maxDataPoints&quot;: 100,</span><br><span class="line">          &quot;nullPointMode&quot;: &quot;connected&quot;,</span><br><span class="line">          &quot;nullText&quot;: null,</span><br><span class="line">          &quot;postfix&quot;: &quot;&quot;,</span><br><span class="line">          &quot;postfixFontSize&quot;: &quot;50%&quot;,</span><br><span class="line">          &quot;prefix&quot;: &quot;&quot;,</span><br><span class="line">          &quot;prefixFontSize&quot;: &quot;50%&quot;,</span><br><span class="line">          &quot;rangeMaps&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;from&quot;: &quot;null&quot;,</span><br><span class="line">              &quot;text&quot;: &quot;N/A&quot;,</span><br><span class="line">              &quot;to&quot;: &quot;null&quot;</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;span&quot;: 2,</span><br><span class="line">          &quot;sparkline&quot;: &#123;</span><br><span class="line">            &quot;fillColor&quot;: &quot;rgba(31, 118, 189, 0.18)&quot;,</span><br><span class="line">            &quot;full&quot;: false,</span><br><span class="line">            &quot;lineColor&quot;: &quot;rgb(31, 120, 193)&quot;,</span><br><span class="line">            &quot;show&quot;: false</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;targets&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;expr&quot;: &quot;ceph_monitor_quorum_count&#123;job=\&quot;$export\&quot;&#125;&quot;,</span><br><span class="line">              &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">              &quot;intervalFactor&quot;: 1,</span><br><span class="line">              &quot;legendFormat&quot;: &quot;&quot;,</span><br><span class="line">              &quot;refId&quot;: &quot;A&quot;,</span><br><span class="line">              &quot;step&quot;: 10</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;thresholds&quot;: &quot;2,3&quot;,</span><br><span class="line">          &quot;title&quot;: &quot;Monitors In Quorum&quot;,</span><br><span class="line">          &quot;transparent&quot;: false,</span><br><span class="line">          &quot;type&quot;: &quot;singlestat&quot;,</span><br><span class="line">          &quot;valueFontSize&quot;: &quot;100%&quot;,</span><br><span class="line">          &quot;valueMaps&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;op&quot;: &quot;=&quot;,</span><br><span class="line">              &quot;text&quot;: &quot;N/A&quot;,</span><br><span class="line">              &quot;value&quot;: &quot;null&quot;</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;valueName&quot;: &quot;current&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;cacheTimeout&quot;: null,</span><br><span class="line">          &quot;colorBackground&quot;: false,</span><br><span class="line">          &quot;colorValue&quot;: false,</span><br><span class="line">          &quot;colors&quot;: [</span><br><span class="line">            &quot;rgba(245, 54, 54, 0.9)&quot;,</span><br><span class="line">            &quot;rgba(237, 129, 40, 0.89)&quot;,</span><br><span class="line">            &quot;rgba(50, 172, 45, 0.97)&quot;</span><br><span class="line">          ],</span><br><span class="line">          &quot;datasource&quot;: &quot;prometheus&quot;,</span><br><span class="line">          &quot;editable&quot;: true,</span><br><span class="line">          &quot;error&quot;: false,</span><br><span class="line">          &quot;format&quot;: &quot;none&quot;,</span><br><span class="line">          &quot;gauge&quot;: &#123;</span><br><span class="line">            &quot;maxValue&quot;: 100,</span><br><span class="line">            &quot;minValue&quot;: 0,</span><br><span class="line">            &quot;show&quot;: false,</span><br><span class="line">            &quot;thresholdLabels&quot;: false,</span><br><span class="line">            &quot;thresholdMarkers&quot;: true</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;id&quot;: 22,</span><br><span class="line">          &quot;interval&quot;: &quot;1m&quot;,</span><br><span class="line">          &quot;links&quot;: [],</span><br><span class="line">          &quot;mappingType&quot;: 1,</span><br><span class="line">          &quot;mappingTypes&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;name&quot;: &quot;value to text&quot;,</span><br><span class="line">              &quot;value&quot;: 1</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;name&quot;: &quot;range to text&quot;,</span><br><span class="line">              &quot;value&quot;: 2</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;maxDataPoints&quot;: 100,</span><br><span class="line">          &quot;nullPointMode&quot;: &quot;connected&quot;,</span><br><span class="line">          &quot;nullText&quot;: null,</span><br><span class="line">          &quot;postfix&quot;: &quot;&quot;,</span><br><span class="line">          &quot;postfixFontSize&quot;: &quot;50%&quot;,</span><br><span class="line">          &quot;prefix&quot;: &quot;&quot;,</span><br><span class="line">          &quot;prefixFontSize&quot;: &quot;50%&quot;,</span><br><span class="line">          &quot;rangeMaps&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;from&quot;: &quot;null&quot;,</span><br><span class="line">              &quot;text&quot;: &quot;N/A&quot;,</span><br><span class="line">              &quot;to&quot;: &quot;null&quot;</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;span&quot;: 2,</span><br><span class="line">          &quot;sparkline&quot;: &#123;</span><br><span class="line">            &quot;fillColor&quot;: &quot;rgba(31, 118, 189, 0.18)&quot;,</span><br><span class="line">            &quot;full&quot;: true,</span><br><span class="line">            &quot;lineColor&quot;: &quot;rgb(31, 120, 193)&quot;,</span><br><span class="line">            &quot;show&quot;: true</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;targets&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;expr&quot;: &quot;count(ceph_pool_available_bytes&#123;job=\&quot;$export\&quot;&#125;)&quot;,</span><br><span class="line">              &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">              &quot;intervalFactor&quot;: 1,</span><br><span class="line">              &quot;legendFormat&quot;: &quot;&quot;,</span><br><span class="line">              &quot;refId&quot;: &quot;A&quot;,</span><br><span class="line">              &quot;step&quot;: 10</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;thresholds&quot;: &quot;&quot;,</span><br><span class="line">          &quot;title&quot;: &quot;Pools&quot;,</span><br><span class="line">          &quot;transparent&quot;: false,</span><br><span class="line">          &quot;type&quot;: &quot;singlestat&quot;,</span><br><span class="line">          &quot;valueFontSize&quot;: &quot;100%&quot;,</span><br><span class="line">          &quot;valueMaps&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;op&quot;: &quot;=&quot;,</span><br><span class="line">              &quot;text&quot;: &quot;N/A&quot;,</span><br><span class="line">              &quot;value&quot;: &quot;null&quot;</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;valueName&quot;: &quot;current&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;cacheTimeout&quot;: null,</span><br><span class="line">          &quot;colorBackground&quot;: false,</span><br><span class="line">          &quot;colorValue&quot;: false,</span><br><span class="line">          &quot;colors&quot;: [</span><br><span class="line">            &quot;rgba(50, 172, 45, 0.97)&quot;,</span><br><span class="line">            &quot;rgba(237, 129, 40, 0.89)&quot;,</span><br><span class="line">            &quot;rgba(245, 54, 54, 0.9)&quot;</span><br><span class="line">          ],</span><br><span class="line">          &quot;datasource&quot;: &quot;prometheus&quot;,</span><br><span class="line">          &quot;editable&quot;: true,</span><br><span class="line">          &quot;error&quot;: false,</span><br><span class="line">          &quot;format&quot;: &quot;bytes&quot;,</span><br><span class="line">          &quot;gauge&quot;: &#123;</span><br><span class="line">            &quot;maxValue&quot;: 100,</span><br><span class="line">            &quot;minValue&quot;: 0,</span><br><span class="line">            &quot;show&quot;: false,</span><br><span class="line">            &quot;thresholdLabels&quot;: false,</span><br><span class="line">            &quot;thresholdMarkers&quot;: true</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;id&quot;: 33,</span><br><span class="line">          &quot;interval&quot;: &quot;1m&quot;,</span><br><span class="line">          &quot;links&quot;: [],</span><br><span class="line">          &quot;mappingType&quot;: 1,</span><br><span class="line">          &quot;mappingTypes&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;name&quot;: &quot;value to text&quot;,</span><br><span class="line">              &quot;value&quot;: 1</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;name&quot;: &quot;range to text&quot;,</span><br><span class="line">              &quot;value&quot;: 2</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;maxDataPoints&quot;: 100,</span><br><span class="line">          &quot;nullPointMode&quot;: &quot;connected&quot;,</span><br><span class="line">          &quot;nullText&quot;: null,</span><br><span class="line">          &quot;postfix&quot;: &quot;&quot;,</span><br><span class="line">          &quot;postfixFontSize&quot;: &quot;50%&quot;,</span><br><span class="line">          &quot;prefix&quot;: &quot;&quot;,</span><br><span class="line">          &quot;prefixFontSize&quot;: &quot;50%&quot;,</span><br><span class="line">          &quot;rangeMaps&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;from&quot;: &quot;null&quot;,</span><br><span class="line">              &quot;text&quot;: &quot;N/A&quot;,</span><br><span class="line">              &quot;to&quot;: &quot;null&quot;</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;span&quot;: 2,</span><br><span class="line">          &quot;sparkline&quot;: &#123;</span><br><span class="line">            &quot;fillColor&quot;: &quot;rgba(31, 118, 189, 0.18)&quot;,</span><br><span class="line">            &quot;full&quot;: true,</span><br><span class="line">            &quot;lineColor&quot;: &quot;rgb(31, 120, 193)&quot;,</span><br><span class="line">            &quot;show&quot;: true</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;targets&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;expr&quot;: &quot;ceph_cluster_capacity_bytes&#123;job=\&quot;$export\&quot;&#125;&quot;,</span><br><span class="line">              &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">              &quot;intervalFactor&quot;: 1,</span><br><span class="line">              &quot;legendFormat&quot;: &quot;&quot;,</span><br><span class="line">              &quot;refId&quot;: &quot;A&quot;,</span><br><span class="line">              &quot;step&quot;: 10</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;thresholds&quot;: &quot;0.025,0.1&quot;,</span><br><span class="line">          &quot;title&quot;: &quot;Cluster Capacity&quot;,</span><br><span class="line">          &quot;transparent&quot;: false,</span><br><span class="line">          &quot;type&quot;: &quot;singlestat&quot;,</span><br><span class="line">          &quot;valueFontSize&quot;: &quot;100%&quot;,</span><br><span class="line">          &quot;valueMaps&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;op&quot;: &quot;=&quot;,</span><br><span class="line">              &quot;text&quot;: &quot;N/A&quot;,</span><br><span class="line">              &quot;value&quot;: &quot;null&quot;</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;valueName&quot;: &quot;current&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;cacheTimeout&quot;: null,</span><br><span class="line">          &quot;colorBackground&quot;: false,</span><br><span class="line">          &quot;colorValue&quot;: false,</span><br><span class="line">          &quot;colors&quot;: [</span><br><span class="line">            &quot;rgba(50, 172, 45, 0.97)&quot;,</span><br><span class="line">            &quot;rgba(237, 129, 40, 0.89)&quot;,</span><br><span class="line">            &quot;rgba(245, 54, 54, 0.9)&quot;</span><br><span class="line">          ],</span><br><span class="line">          &quot;datasource&quot;: &quot;prometheus&quot;,</span><br><span class="line">          &quot;editable&quot;: true,</span><br><span class="line">          &quot;error&quot;: false,</span><br><span class="line">          &quot;format&quot;: &quot;bytes&quot;,</span><br><span class="line">          &quot;gauge&quot;: &#123;</span><br><span class="line">            &quot;maxValue&quot;: 100,</span><br><span class="line">            &quot;minValue&quot;: 0,</span><br><span class="line">            &quot;show&quot;: false,</span><br><span class="line">            &quot;thresholdLabels&quot;: false,</span><br><span class="line">            &quot;thresholdMarkers&quot;: true</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;id&quot;: 34,</span><br><span class="line">          &quot;interval&quot;: &quot;1m&quot;,</span><br><span class="line">          &quot;links&quot;: [],</span><br><span class="line">          &quot;mappingType&quot;: 1,</span><br><span class="line">          &quot;mappingTypes&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;name&quot;: &quot;value to text&quot;,</span><br><span class="line">              &quot;value&quot;: 1</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;name&quot;: &quot;range to text&quot;,</span><br><span class="line">              &quot;value&quot;: 2</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;maxDataPoints&quot;: 100,</span><br><span class="line">          &quot;nullPointMode&quot;: &quot;connected&quot;,</span><br><span class="line">          &quot;nullText&quot;: null,</span><br><span class="line">          &quot;postfix&quot;: &quot;&quot;,</span><br><span class="line">          &quot;postfixFontSize&quot;: &quot;50%&quot;,</span><br><span class="line">          &quot;prefix&quot;: &quot;&quot;,</span><br><span class="line">          &quot;prefixFontSize&quot;: &quot;50%&quot;,</span><br><span class="line">          &quot;rangeMaps&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;from&quot;: &quot;null&quot;,</span><br><span class="line">              &quot;text&quot;: &quot;N/A&quot;,</span><br><span class="line">              &quot;to&quot;: &quot;null&quot;</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;span&quot;: 2,</span><br><span class="line">          &quot;sparkline&quot;: &#123;</span><br><span class="line">            &quot;fillColor&quot;: &quot;rgba(31, 118, 189, 0.18)&quot;,</span><br><span class="line">            &quot;full&quot;: true,</span><br><span class="line">            &quot;lineColor&quot;: &quot;rgb(31, 120, 193)&quot;,</span><br><span class="line">            &quot;show&quot;: true</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;targets&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;expr&quot;: &quot;ceph_cluster_used_bytes&#123;job=\&quot;$export\&quot;&#125;&quot;,</span><br><span class="line">              &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">              &quot;intervalFactor&quot;: 1,</span><br><span class="line">              &quot;legendFormat&quot;: &quot;&quot;,</span><br><span class="line">              &quot;refId&quot;: &quot;A&quot;,</span><br><span class="line">              &quot;step&quot;: 10</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;thresholds&quot;: &quot;0.025,0.1&quot;,</span><br><span class="line">          &quot;title&quot;: &quot;Used Capacity&quot;,</span><br><span class="line">          &quot;transparent&quot;: false,</span><br><span class="line">          &quot;type&quot;: &quot;singlestat&quot;,</span><br><span class="line">          &quot;valueFontSize&quot;: &quot;100%&quot;,</span><br><span class="line">          &quot;valueMaps&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;op&quot;: &quot;=&quot;,</span><br><span class="line">              &quot;text&quot;: &quot;N/A&quot;,</span><br><span class="line">              &quot;value&quot;: &quot;null&quot;</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;valueName&quot;: &quot;current&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;cacheTimeout&quot;: null,</span><br><span class="line">          &quot;colorBackground&quot;: false,</span><br><span class="line">          &quot;colorValue&quot;: true,</span><br><span class="line">          &quot;colors&quot;: [</span><br><span class="line">            &quot;rgba(50, 172, 45, 0.97)&quot;,</span><br><span class="line">            &quot;rgba(237, 129, 40, 0.89)&quot;,</span><br><span class="line">            &quot;rgba(245, 54, 54, 0.9)&quot;</span><br><span class="line">          ],</span><br><span class="line">          &quot;datasource&quot;: &quot;prometheus&quot;,</span><br><span class="line">          &quot;editable&quot;: true,</span><br><span class="line">          &quot;error&quot;: false,</span><br><span class="line">          &quot;format&quot;: &quot;percentunit&quot;,</span><br><span class="line">          &quot;gauge&quot;: &#123;</span><br><span class="line">            &quot;maxValue&quot;: 100,</span><br><span class="line">            &quot;minValue&quot;: 0,</span><br><span class="line">            &quot;show&quot;: true,</span><br><span class="line">            &quot;thresholdLabels&quot;: false,</span><br><span class="line">            &quot;thresholdMarkers&quot;: true</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;id&quot;: 23,</span><br><span class="line">          &quot;interval&quot;: &quot;1m&quot;,</span><br><span class="line">          &quot;links&quot;: [],</span><br><span class="line">          &quot;mappingType&quot;: 1,</span><br><span class="line">          &quot;mappingTypes&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;name&quot;: &quot;value to text&quot;,</span><br><span class="line">              &quot;value&quot;: 1</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;name&quot;: &quot;range to text&quot;,</span><br><span class="line">              &quot;value&quot;: 2</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;maxDataPoints&quot;: 100,</span><br><span class="line">          &quot;nullPointMode&quot;: &quot;connected&quot;,</span><br><span class="line">          &quot;nullText&quot;: null,</span><br><span class="line">          &quot;postfix&quot;: &quot;&quot;,</span><br><span class="line">          &quot;postfixFontSize&quot;: &quot;50%&quot;,</span><br><span class="line">          &quot;prefix&quot;: &quot;&quot;,</span><br><span class="line">          &quot;prefixFontSize&quot;: &quot;50%&quot;,</span><br><span class="line">          &quot;rangeMaps&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;from&quot;: &quot;null&quot;,</span><br><span class="line">              &quot;text&quot;: &quot;N/A&quot;,</span><br><span class="line">              &quot;to&quot;: &quot;null&quot;</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;span&quot;: 2,</span><br><span class="line">          &quot;sparkline&quot;: &#123;</span><br><span class="line">            &quot;fillColor&quot;: &quot;rgba(31, 118, 189, 0.18)&quot;,</span><br><span class="line">            &quot;full&quot;: true,</span><br><span class="line">            &quot;lineColor&quot;: &quot;rgb(31, 120, 193)&quot;,</span><br><span class="line">            &quot;show&quot;: false</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;targets&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;expr&quot;: &quot;ceph_cluster_available_bytes&#123;job=\&quot;$export\&quot;&#125;/ceph_cluster_capacity_bytes&#123;job=\&quot;$export\&quot;&#125;&quot;,</span><br><span class="line">              &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">              &quot;intervalFactor&quot;: 1,</span><br><span class="line">              &quot;legendFormat&quot;: &quot;&quot;,</span><br><span class="line">              &quot;refId&quot;: &quot;A&quot;,</span><br><span class="line">              &quot;step&quot;: 10</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;thresholds&quot;: &quot;70,80&quot;,</span><br><span class="line">          &quot;title&quot;: &quot;Available Capacity&quot;,</span><br><span class="line">          &quot;transparent&quot;: false,</span><br><span class="line">          &quot;type&quot;: &quot;singlestat&quot;,</span><br><span class="line">          &quot;valueFontSize&quot;: &quot;100%&quot;,</span><br><span class="line">          &quot;valueMaps&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;op&quot;: &quot;=&quot;,</span><br><span class="line">              &quot;text&quot;: &quot;N/A&quot;,</span><br><span class="line">              &quot;value&quot;: &quot;null&quot;</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;valueName&quot;: &quot;current&quot;</span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      &quot;repeat&quot;: null,</span><br><span class="line">      &quot;repeatIteration&quot;: null,</span><br><span class="line">      &quot;repeatRowId&quot;: null,</span><br><span class="line">      &quot;showTitle&quot;: false,</span><br><span class="line">      &quot;title&quot;: &quot;New row&quot;,</span><br><span class="line">      &quot;titleSize&quot;: &quot;h6&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;collapse&quot;: false,</span><br><span class="line">      &quot;height&quot;: &quot;100px&quot;,</span><br><span class="line">      &quot;panels&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;cacheTimeout&quot;: null,</span><br><span class="line">          &quot;colorBackground&quot;: false,</span><br><span class="line">          &quot;colorValue&quot;: false,</span><br><span class="line">          &quot;colors&quot;: [</span><br><span class="line">            &quot;rgba(245, 54, 54, 0.9)&quot;,</span><br><span class="line">            &quot;rgba(237, 129, 40, 0.89)&quot;,</span><br><span class="line">            &quot;rgba(50, 172, 45, 0.97)&quot;</span><br><span class="line">          ],</span><br><span class="line">          &quot;datasource&quot;: &quot;prometheus&quot;,</span><br><span class="line">          &quot;editable&quot;: true,</span><br><span class="line">          &quot;error&quot;: false,</span><br><span class="line">          &quot;format&quot;: &quot;none&quot;,</span><br><span class="line">          &quot;gauge&quot;: &#123;</span><br><span class="line">            &quot;maxValue&quot;: 100,</span><br><span class="line">            &quot;minValue&quot;: 0,</span><br><span class="line">            &quot;show&quot;: false,</span><br><span class="line">            &quot;thresholdLabels&quot;: false,</span><br><span class="line">            &quot;thresholdMarkers&quot;: true</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;id&quot;: 26,</span><br><span class="line">          &quot;interval&quot;: null,</span><br><span class="line">          &quot;links&quot;: [],</span><br><span class="line">          &quot;mappingType&quot;: 1,</span><br><span class="line">          &quot;mappingTypes&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;name&quot;: &quot;value to text&quot;,</span><br><span class="line">              &quot;value&quot;: 1</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;name&quot;: &quot;range to text&quot;,</span><br><span class="line">              &quot;value&quot;: 2</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;maxDataPoints&quot;: 100,</span><br><span class="line">          &quot;nullPointMode&quot;: &quot;connected&quot;,</span><br><span class="line">          &quot;nullText&quot;: null,</span><br><span class="line">          &quot;postfix&quot;: &quot;&quot;,</span><br><span class="line">          &quot;postfixFontSize&quot;: &quot;50%&quot;,</span><br><span class="line">          &quot;prefix&quot;: &quot;&quot;,</span><br><span class="line">          &quot;prefixFontSize&quot;: &quot;50%&quot;,</span><br><span class="line">          &quot;rangeMaps&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;from&quot;: &quot;null&quot;,</span><br><span class="line">              &quot;text&quot;: &quot;N/A&quot;,</span><br><span class="line">              &quot;to&quot;: &quot;null&quot;</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;span&quot;: 1,</span><br><span class="line">          &quot;sparkline&quot;: &#123;</span><br><span class="line">            &quot;fillColor&quot;: &quot;rgba(31, 118, 189, 0.18)&quot;,</span><br><span class="line">            &quot;full&quot;: false,</span><br><span class="line">            &quot;lineColor&quot;: &quot;rgb(31, 120, 193)&quot;,</span><br><span class="line">            &quot;show&quot;: false</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;targets&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;expr&quot;: &quot;ceph_osds_in&#123;job=\&quot;$export\&quot;&#125;&quot;,</span><br><span class="line">              &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">              &quot;intervalFactor&quot;: 1,</span><br><span class="line">              &quot;legendFormat&quot;: &quot;&quot;,</span><br><span class="line">              &quot;refId&quot;: &quot;A&quot;,</span><br><span class="line">              &quot;step&quot;: 10</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;thresholds&quot;: &quot;&quot;,</span><br><span class="line">          &quot;title&quot;: &quot;OSDs IN&quot;,</span><br><span class="line">          &quot;type&quot;: &quot;singlestat&quot;,</span><br><span class="line">          &quot;valueFontSize&quot;: &quot;80%&quot;,</span><br><span class="line">          &quot;valueMaps&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;op&quot;: &quot;=&quot;,</span><br><span class="line">              &quot;text&quot;: &quot;N/A&quot;,</span><br><span class="line">              &quot;value&quot;: &quot;null&quot;</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;valueName&quot;: &quot;current&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;cacheTimeout&quot;: null,</span><br><span class="line">          &quot;colorBackground&quot;: true,</span><br><span class="line">          &quot;colorValue&quot;: false,</span><br><span class="line">          &quot;colors&quot;: [</span><br><span class="line">            &quot;rgba(50, 172, 45, 0.97)&quot;,</span><br><span class="line">            &quot;rgba(237, 40, 40, 0.89)&quot;,</span><br><span class="line">            &quot;rgba(245, 54, 54, 0.9)&quot;</span><br><span class="line">          ],</span><br><span class="line">          &quot;datasource&quot;: &quot;prometheus&quot;,</span><br><span class="line">          &quot;editable&quot;: true,</span><br><span class="line">          &quot;error&quot;: false,</span><br><span class="line">          &quot;format&quot;: &quot;none&quot;,</span><br><span class="line">          &quot;gauge&quot;: &#123;</span><br><span class="line">            &quot;maxValue&quot;: 100,</span><br><span class="line">            &quot;minValue&quot;: 0,</span><br><span class="line">            &quot;show&quot;: false,</span><br><span class="line">            &quot;thresholdLabels&quot;: false,</span><br><span class="line">            &quot;thresholdMarkers&quot;: true</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;id&quot;: 27,</span><br><span class="line">          &quot;interval&quot;: null,</span><br><span class="line">          &quot;links&quot;: [],</span><br><span class="line">          &quot;mappingType&quot;: 1,</span><br><span class="line">          &quot;mappingTypes&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;name&quot;: &quot;value to text&quot;,</span><br><span class="line">              &quot;value&quot;: 1</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;name&quot;: &quot;range to text&quot;,</span><br><span class="line">              &quot;value&quot;: 2</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;maxDataPoints&quot;: 100,</span><br><span class="line">          &quot;nullPointMode&quot;: &quot;connected&quot;,</span><br><span class="line">          &quot;nullText&quot;: null,</span><br><span class="line">          &quot;postfix&quot;: &quot;&quot;,</span><br><span class="line">          &quot;postfixFontSize&quot;: &quot;50%&quot;,</span><br><span class="line">          &quot;prefix&quot;: &quot;&quot;,</span><br><span class="line">          &quot;prefixFontSize&quot;: &quot;50%&quot;,</span><br><span class="line">          &quot;rangeMaps&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;from&quot;: &quot;null&quot;,</span><br><span class="line">              &quot;text&quot;: &quot;N/A&quot;,</span><br><span class="line">              &quot;to&quot;: &quot;null&quot;</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;span&quot;: 1,</span><br><span class="line">          &quot;sparkline&quot;: &#123;</span><br><span class="line">            &quot;fillColor&quot;: &quot;rgba(31, 118, 189, 0.18)&quot;,</span><br><span class="line">            &quot;full&quot;: false,</span><br><span class="line">            &quot;lineColor&quot;: &quot;rgb(31, 120, 193)&quot;,</span><br><span class="line">            &quot;show&quot;: false</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;targets&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;expr&quot;: &quot;ceph_osds - ceph_osds_in&#123;job=\&quot;$export\&quot;&#125;&quot;,</span><br><span class="line">              &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">              &quot;intervalFactor&quot;: 1,</span><br><span class="line">              &quot;legendFormat&quot;: &quot;&quot;,</span><br><span class="line">              &quot;refId&quot;: &quot;A&quot;,</span><br><span class="line">              &quot;step&quot;: 10</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;thresholds&quot;: &quot;1,1&quot;,</span><br><span class="line">          &quot;title&quot;: &quot;OSDs OUT&quot;,</span><br><span class="line">          &quot;type&quot;: &quot;singlestat&quot;,</span><br><span class="line">          &quot;valueFontSize&quot;: &quot;80%&quot;,</span><br><span class="line">          &quot;valueMaps&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;op&quot;: &quot;=&quot;,</span><br><span class="line">              &quot;text&quot;: &quot;N/A&quot;,</span><br><span class="line">              &quot;value&quot;: &quot;null&quot;</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;valueName&quot;: &quot;current&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;cacheTimeout&quot;: null,</span><br><span class="line">          &quot;colorBackground&quot;: false,</span><br><span class="line">          &quot;colorValue&quot;: false,</span><br><span class="line">          &quot;colors&quot;: [</span><br><span class="line">            &quot;rgba(245, 54, 54, 0.9)&quot;,</span><br><span class="line">            &quot;rgba(237, 129, 40, 0.89)&quot;,</span><br><span class="line">            &quot;rgba(50, 172, 45, 0.97)&quot;</span><br><span class="line">          ],</span><br><span class="line">          &quot;datasource&quot;: &quot;prometheus&quot;,</span><br><span class="line">          &quot;editable&quot;: true,</span><br><span class="line">          &quot;error&quot;: false,</span><br><span class="line">          &quot;format&quot;: &quot;none&quot;,</span><br><span class="line">          &quot;gauge&quot;: &#123;</span><br><span class="line">            &quot;maxValue&quot;: 100,</span><br><span class="line">            &quot;minValue&quot;: 0,</span><br><span class="line">            &quot;show&quot;: false,</span><br><span class="line">            &quot;thresholdLabels&quot;: false,</span><br><span class="line">            &quot;thresholdMarkers&quot;: true</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;id&quot;: 28,</span><br><span class="line">          &quot;interval&quot;: null,</span><br><span class="line">          &quot;links&quot;: [],</span><br><span class="line">          &quot;mappingType&quot;: 1,</span><br><span class="line">          &quot;mappingTypes&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;name&quot;: &quot;value to text&quot;,</span><br><span class="line">              &quot;value&quot;: 1</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;name&quot;: &quot;range to text&quot;,</span><br><span class="line">              &quot;value&quot;: 2</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;maxDataPoints&quot;: 100,</span><br><span class="line">          &quot;nullPointMode&quot;: &quot;connected&quot;,</span><br><span class="line">          &quot;nullText&quot;: null,</span><br><span class="line">          &quot;postfix&quot;: &quot;&quot;,</span><br><span class="line">          &quot;postfixFontSize&quot;: &quot;50%&quot;,</span><br><span class="line">          &quot;prefix&quot;: &quot;&quot;,</span><br><span class="line">          &quot;prefixFontSize&quot;: &quot;50%&quot;,</span><br><span class="line">          &quot;rangeMaps&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;from&quot;: &quot;null&quot;,</span><br><span class="line">              &quot;text&quot;: &quot;N/A&quot;,</span><br><span class="line">              &quot;to&quot;: &quot;null&quot;</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;span&quot;: 1,</span><br><span class="line">          &quot;sparkline&quot;: &#123;</span><br><span class="line">            &quot;fillColor&quot;: &quot;rgba(31, 118, 189, 0.18)&quot;,</span><br><span class="line">            &quot;full&quot;: false,</span><br><span class="line">            &quot;lineColor&quot;: &quot;rgb(31, 120, 193)&quot;,</span><br><span class="line">            &quot;show&quot;: false</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;targets&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;expr&quot;: &quot;sum(ceph_osd_up&#123;job=\&quot;$export\&quot;&#125;)&quot;,</span><br><span class="line">              &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">              &quot;intervalFactor&quot;: 1,</span><br><span class="line">              &quot;legendFormat&quot;: &quot;&quot;,</span><br><span class="line">              &quot;refId&quot;: &quot;A&quot;,</span><br><span class="line">              &quot;step&quot;: 10</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;thresholds&quot;: &quot;&quot;,</span><br><span class="line">          &quot;title&quot;: &quot;OSDs UP&quot;,</span><br><span class="line">          &quot;type&quot;: &quot;singlestat&quot;,</span><br><span class="line">          &quot;valueFontSize&quot;: &quot;80%&quot;,</span><br><span class="line">          &quot;valueMaps&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;op&quot;: &quot;=&quot;,</span><br><span class="line">              &quot;text&quot;: &quot;N/A&quot;,</span><br><span class="line">              &quot;value&quot;: &quot;null&quot;</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;valueName&quot;: &quot;current&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;cacheTimeout&quot;: null,</span><br><span class="line">          &quot;colorBackground&quot;: true,</span><br><span class="line">          &quot;colorValue&quot;: false,</span><br><span class="line">          &quot;colors&quot;: [</span><br><span class="line">            &quot;rgba(50, 172, 45, 0.97)&quot;,</span><br><span class="line">            &quot;rgba(237, 40, 40, 0.89)&quot;,</span><br><span class="line">            &quot;rgba(245, 54, 54, 0.9)&quot;</span><br><span class="line">          ],</span><br><span class="line">          &quot;datasource&quot;: &quot;prometheus&quot;,</span><br><span class="line">          &quot;editable&quot;: true,</span><br><span class="line">          &quot;error&quot;: false,</span><br><span class="line">          &quot;format&quot;: &quot;none&quot;,</span><br><span class="line">          &quot;gauge&quot;: &#123;</span><br><span class="line">            &quot;maxValue&quot;: 100,</span><br><span class="line">            &quot;minValue&quot;: 0,</span><br><span class="line">            &quot;show&quot;: false,</span><br><span class="line">            &quot;thresholdLabels&quot;: false,</span><br><span class="line">            &quot;thresholdMarkers&quot;: true</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;id&quot;: 29,</span><br><span class="line">          &quot;interval&quot;: null,</span><br><span class="line">          &quot;links&quot;: [],</span><br><span class="line">          &quot;mappingType&quot;: 1,</span><br><span class="line">          &quot;mappingTypes&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;name&quot;: &quot;value to text&quot;,</span><br><span class="line">              &quot;value&quot;: 1</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;name&quot;: &quot;range to text&quot;,</span><br><span class="line">              &quot;value&quot;: 2</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;maxDataPoints&quot;: 100,</span><br><span class="line">          &quot;nullPointMode&quot;: &quot;connected&quot;,</span><br><span class="line">          &quot;nullText&quot;: null,</span><br><span class="line">          &quot;postfix&quot;: &quot;&quot;,</span><br><span class="line">          &quot;postfixFontSize&quot;: &quot;50%&quot;,</span><br><span class="line">          &quot;prefix&quot;: &quot;&quot;,</span><br><span class="line">          &quot;prefixFontSize&quot;: &quot;50%&quot;,</span><br><span class="line">          &quot;rangeMaps&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;from&quot;: &quot;null&quot;,</span><br><span class="line">              &quot;text&quot;: &quot;N/A&quot;,</span><br><span class="line">              &quot;to&quot;: &quot;null&quot;</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;span&quot;: 1,</span><br><span class="line">          &quot;sparkline&quot;: &#123;</span><br><span class="line">            &quot;fillColor&quot;: &quot;rgba(31, 118, 189, 0.18)&quot;,</span><br><span class="line">            &quot;full&quot;: false,</span><br><span class="line">            &quot;lineColor&quot;: &quot;rgb(31, 120, 193)&quot;,</span><br><span class="line">            &quot;show&quot;: false</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;targets&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;expr&quot;: &quot;ceph_osds_down&#123;job=\&quot;$export\&quot;&#125;&quot;,</span><br><span class="line">              &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">              &quot;intervalFactor&quot;: 1,</span><br><span class="line">              &quot;legendFormat&quot;: &quot;&quot;,</span><br><span class="line">              &quot;refId&quot;: &quot;A&quot;,</span><br><span class="line">              &quot;step&quot;: 10</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;thresholds&quot;: &quot;1,1&quot;,</span><br><span class="line">          &quot;title&quot;: &quot;OSDs DOWN&quot;,</span><br><span class="line">          &quot;type&quot;: &quot;singlestat&quot;,</span><br><span class="line">          &quot;valueFontSize&quot;: &quot;80%&quot;,</span><br><span class="line">          &quot;valueMaps&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;op&quot;: &quot;=&quot;,</span><br><span class="line">              &quot;text&quot;: &quot;N/A&quot;,</span><br><span class="line">              &quot;value&quot;: &quot;null&quot;</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;valueName&quot;: &quot;current&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;cacheTimeout&quot;: null,</span><br><span class="line">          &quot;colorBackground&quot;: false,</span><br><span class="line">          &quot;colorValue&quot;: true,</span><br><span class="line">          &quot;colors&quot;: [</span><br><span class="line">            &quot;rgba(50, 172, 45, 0.97)&quot;,</span><br><span class="line">            &quot;rgba(237, 129, 40, 0.89)&quot;,</span><br><span class="line">            &quot;rgba(245, 54, 54, 0.9)&quot;</span><br><span class="line">          ],</span><br><span class="line">          &quot;datasource&quot;: &quot;prometheus&quot;,</span><br><span class="line">          &quot;editable&quot;: true,</span><br><span class="line">          &quot;error&quot;: false,</span><br><span class="line">          &quot;format&quot;: &quot;none&quot;,</span><br><span class="line">          &quot;gauge&quot;: &#123;</span><br><span class="line">            &quot;maxValue&quot;: 100,</span><br><span class="line">            &quot;minValue&quot;: 0,</span><br><span class="line">            &quot;show&quot;: false,</span><br><span class="line">            &quot;thresholdLabels&quot;: false,</span><br><span class="line">            &quot;thresholdMarkers&quot;: true</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;id&quot;: 30,</span><br><span class="line">          &quot;interval&quot;: null,</span><br><span class="line">          &quot;links&quot;: [],</span><br><span class="line">          &quot;mappingType&quot;: 1,</span><br><span class="line">          &quot;mappingTypes&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;name&quot;: &quot;value to text&quot;,</span><br><span class="line">              &quot;value&quot;: 1</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;name&quot;: &quot;range to text&quot;,</span><br><span class="line">              &quot;value&quot;: 2</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;maxDataPoints&quot;: 100,</span><br><span class="line">          &quot;nullPointMode&quot;: &quot;connected&quot;,</span><br><span class="line">          &quot;nullText&quot;: null,</span><br><span class="line">          &quot;postfix&quot;: &quot;&quot;,</span><br><span class="line">          &quot;postfixFontSize&quot;: &quot;50%&quot;,</span><br><span class="line">          &quot;prefix&quot;: &quot;&quot;,</span><br><span class="line">          &quot;prefixFontSize&quot;: &quot;50%&quot;,</span><br><span class="line">          &quot;rangeMaps&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;from&quot;: &quot;null&quot;,</span><br><span class="line">              &quot;text&quot;: &quot;N/A&quot;,</span><br><span class="line">              &quot;to&quot;: &quot;null&quot;</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;span&quot;: 2,</span><br><span class="line">          &quot;sparkline&quot;: &#123;</span><br><span class="line">            &quot;fillColor&quot;: &quot;rgba(31, 118, 189, 0.18)&quot;,</span><br><span class="line">            &quot;full&quot;: true,</span><br><span class="line">            &quot;lineColor&quot;: &quot;rgb(31, 120, 193)&quot;,</span><br><span class="line">            &quot;show&quot;: true</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;targets&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;expr&quot;: &quot;avg(ceph_osd_pgs&#123;job=\&quot;$export\&quot;&#125;)&quot;,</span><br><span class="line">              &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">              &quot;intervalFactor&quot;: 1,</span><br><span class="line">              &quot;legendFormat&quot;: &quot;&quot;,</span><br><span class="line">              &quot;refId&quot;: &quot;A&quot;,</span><br><span class="line">              &quot;step&quot;: 10</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;thresholds&quot;: &quot;250,300&quot;,</span><br><span class="line">          &quot;title&quot;: &quot;Agerage PGs per OSD&quot;,</span><br><span class="line">          &quot;type&quot;: &quot;singlestat&quot;,</span><br><span class="line">          &quot;valueFontSize&quot;: &quot;80%&quot;,</span><br><span class="line">          &quot;valueMaps&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;op&quot;: &quot;=&quot;,</span><br><span class="line">              &quot;text&quot;: &quot;N/A&quot;,</span><br><span class="line">              &quot;value&quot;: &quot;null&quot;</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;valueName&quot;: &quot;current&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;cacheTimeout&quot;: null,</span><br><span class="line">          &quot;colorBackground&quot;: false,</span><br><span class="line">          &quot;colorValue&quot;: true,</span><br><span class="line">          &quot;colors&quot;: [</span><br><span class="line">            &quot;rgba(50, 172, 45, 0.97)&quot;,</span><br><span class="line">            &quot;rgba(237, 129, 40, 0.89)&quot;,</span><br><span class="line">            &quot;rgba(245, 54, 54, 0.9)&quot;</span><br><span class="line">          ],</span><br><span class="line">          &quot;datasource&quot;: &quot;prometheus&quot;,</span><br><span class="line">          &quot;editable&quot;: true,</span><br><span class="line">          &quot;error&quot;: false,</span><br><span class="line">          &quot;format&quot;: &quot;s&quot;,</span><br><span class="line">          &quot;gauge&quot;: &#123;</span><br><span class="line">            &quot;maxValue&quot;: 100,</span><br><span class="line">            &quot;minValue&quot;: 0,</span><br><span class="line">            &quot;show&quot;: false,</span><br><span class="line">            &quot;thresholdLabels&quot;: false,</span><br><span class="line">            &quot;thresholdMarkers&quot;: true</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;id&quot;: 31,</span><br><span class="line">          &quot;interval&quot;: null,</span><br><span class="line">          &quot;links&quot;: [],</span><br><span class="line">          &quot;mappingType&quot;: 1,</span><br><span class="line">          &quot;mappingTypes&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;name&quot;: &quot;value to text&quot;,</span><br><span class="line">              &quot;value&quot;: 1</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;name&quot;: &quot;range to text&quot;,</span><br><span class="line">              &quot;value&quot;: 2</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;maxDataPoints&quot;: 100,</span><br><span class="line">          &quot;nullPointMode&quot;: &quot;connected&quot;,</span><br><span class="line">          &quot;nullText&quot;: null,</span><br><span class="line">          &quot;postfix&quot;: &quot;&quot;,</span><br><span class="line">          &quot;postfixFontSize&quot;: &quot;50%&quot;,</span><br><span class="line">          &quot;prefix&quot;: &quot;&quot;,</span><br><span class="line">          &quot;prefixFontSize&quot;: &quot;50%&quot;,</span><br><span class="line">          &quot;rangeMaps&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;from&quot;: &quot;null&quot;,</span><br><span class="line">              &quot;text&quot;: &quot;N/A&quot;,</span><br><span class="line">              &quot;to&quot;: &quot;null&quot;</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;span&quot;: 2,</span><br><span class="line">          &quot;sparkline&quot;: &#123;</span><br><span class="line">            &quot;fillColor&quot;: &quot;rgba(31, 118, 189, 0.18)&quot;,</span><br><span class="line">            &quot;full&quot;: true,</span><br><span class="line">            &quot;lineColor&quot;: &quot;rgb(31, 120, 193)&quot;,</span><br><span class="line">            &quot;show&quot;: true</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;targets&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;expr&quot;: &quot;avg(ceph_osd_perf_apply_latency_seconds&#123;job=\&quot;$export\&quot;&#125;)&quot;,</span><br><span class="line">              &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">              &quot;intervalFactor&quot;: 1,</span><br><span class="line">              &quot;legendFormat&quot;: &quot;&quot;,</span><br><span class="line">              &quot;refId&quot;: &quot;A&quot;,</span><br><span class="line">              &quot;step&quot;: 10</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;thresholds&quot;: &quot;0.01,0.05&quot;,</span><br><span class="line">          &quot;title&quot;: &quot;Agerage OSD Apply Latency&quot;,</span><br><span class="line">          &quot;type&quot;: &quot;singlestat&quot;,</span><br><span class="line">          &quot;valueFontSize&quot;: &quot;80%&quot;,</span><br><span class="line">          &quot;valueMaps&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;op&quot;: &quot;=&quot;,</span><br><span class="line">              &quot;text&quot;: &quot;N/A&quot;,</span><br><span class="line">              &quot;value&quot;: &quot;null&quot;</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;valueName&quot;: &quot;avg&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;cacheTimeout&quot;: null,</span><br><span class="line">          &quot;colorBackground&quot;: false,</span><br><span class="line">          &quot;colorValue&quot;: true,</span><br><span class="line">          &quot;colors&quot;: [</span><br><span class="line">            &quot;rgba(50, 172, 45, 0.97)&quot;,</span><br><span class="line">            &quot;rgba(237, 129, 40, 0.89)&quot;,</span><br><span class="line">            &quot;rgba(245, 54, 54, 0.9)&quot;</span><br><span class="line">          ],</span><br><span class="line">          &quot;datasource&quot;: &quot;prometheus&quot;,</span><br><span class="line">          &quot;editable&quot;: true,</span><br><span class="line">          &quot;error&quot;: false,</span><br><span class="line">          &quot;format&quot;: &quot;s&quot;,</span><br><span class="line">          &quot;gauge&quot;: &#123;</span><br><span class="line">            &quot;maxValue&quot;: 100,</span><br><span class="line">            &quot;minValue&quot;: 0,</span><br><span class="line">            &quot;show&quot;: false,</span><br><span class="line">            &quot;thresholdLabels&quot;: false,</span><br><span class="line">            &quot;thresholdMarkers&quot;: true</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;id&quot;: 32,</span><br><span class="line">          &quot;interval&quot;: null,</span><br><span class="line">          &quot;links&quot;: [],</span><br><span class="line">          &quot;mappingType&quot;: 1,</span><br><span class="line">          &quot;mappingTypes&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;name&quot;: &quot;value to text&quot;,</span><br><span class="line">              &quot;value&quot;: 1</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;name&quot;: &quot;range to text&quot;,</span><br><span class="line">              &quot;value&quot;: 2</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;maxDataPoints&quot;: 100,</span><br><span class="line">          &quot;nullPointMode&quot;: &quot;connected&quot;,</span><br><span class="line">          &quot;nullText&quot;: null,</span><br><span class="line">          &quot;postfix&quot;: &quot;&quot;,</span><br><span class="line">          &quot;postfixFontSize&quot;: &quot;50%&quot;,</span><br><span class="line">          &quot;prefix&quot;: &quot;&quot;,</span><br><span class="line">          &quot;prefixFontSize&quot;: &quot;50%&quot;,</span><br><span class="line">          &quot;rangeMaps&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;from&quot;: &quot;null&quot;,</span><br><span class="line">              &quot;text&quot;: &quot;N/A&quot;,</span><br><span class="line">              &quot;to&quot;: &quot;null&quot;</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;span&quot;: 2,</span><br><span class="line">          &quot;sparkline&quot;: &#123;</span><br><span class="line">            &quot;fillColor&quot;: &quot;rgba(31, 118, 189, 0.18)&quot;,</span><br><span class="line">            &quot;full&quot;: true,</span><br><span class="line">            &quot;lineColor&quot;: &quot;rgb(31, 120, 193)&quot;,</span><br><span class="line">            &quot;show&quot;: true</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;targets&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;expr&quot;: &quot;avg(ceph_osd_perf_commit_latency_seconds&#123;job=\&quot;$export\&quot;&#125;)&quot;,</span><br><span class="line">              &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">              &quot;intervalFactor&quot;: 1,</span><br><span class="line">              &quot;legendFormat&quot;: &quot;&quot;,</span><br><span class="line">              &quot;refId&quot;: &quot;A&quot;,</span><br><span class="line">              &quot;step&quot;: 10</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;thresholds&quot;: &quot;0.01,0.05&quot;,</span><br><span class="line">          &quot;title&quot;: &quot;Agerage OSD Commit Latency&quot;,</span><br><span class="line">          &quot;type&quot;: &quot;singlestat&quot;,</span><br><span class="line">          &quot;valueFontSize&quot;: &quot;80%&quot;,</span><br><span class="line">          &quot;valueMaps&quot;: [],</span><br><span class="line">          &quot;valueName&quot;: &quot;avg&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;cacheTimeout&quot;: null,</span><br><span class="line">          &quot;colorBackground&quot;: false,</span><br><span class="line">          &quot;colorValue&quot;: true,</span><br><span class="line">          &quot;colors&quot;: [</span><br><span class="line">            &quot;rgba(50, 172, 45, 0.97)&quot;,</span><br><span class="line">            &quot;rgba(237, 129, 40, 0.89)&quot;,</span><br><span class="line">            &quot;rgba(245, 54, 54, 0.9)&quot;</span><br><span class="line">          ],</span><br><span class="line">          &quot;datasource&quot;: &quot;prometheus&quot;,</span><br><span class="line">          &quot;editable&quot;: true,</span><br><span class="line">          &quot;error&quot;: false,</span><br><span class="line">          &quot;format&quot;: &quot;s&quot;,</span><br><span class="line">          &quot;gauge&quot;: &#123;</span><br><span class="line">            &quot;maxValue&quot;: 100,</span><br><span class="line">            &quot;minValue&quot;: 0,</span><br><span class="line">            &quot;show&quot;: false,</span><br><span class="line">            &quot;thresholdLabels&quot;: false,</span><br><span class="line">            &quot;thresholdMarkers&quot;: true</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;id&quot;: 24,</span><br><span class="line">          &quot;interval&quot;: &quot;1m&quot;,</span><br><span class="line">          &quot;links&quot;: [],</span><br><span class="line">          &quot;mappingType&quot;: 1,</span><br><span class="line">          &quot;mappingTypes&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;name&quot;: &quot;value to text&quot;,</span><br><span class="line">              &quot;value&quot;: 1</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;name&quot;: &quot;range to text&quot;,</span><br><span class="line">              &quot;value&quot;: 2</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;maxDataPoints&quot;: 100,</span><br><span class="line">          &quot;nullPointMode&quot;: &quot;connected&quot;,</span><br><span class="line">          &quot;nullText&quot;: null,</span><br><span class="line">          &quot;postfix&quot;: &quot;&quot;,</span><br><span class="line">          &quot;postfixFontSize&quot;: &quot;50%&quot;,</span><br><span class="line">          &quot;prefix&quot;: &quot;&quot;,</span><br><span class="line">          &quot;prefixFontSize&quot;: &quot;50%&quot;,</span><br><span class="line">          &quot;rangeMaps&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;from&quot;: &quot;null&quot;,</span><br><span class="line">              &quot;text&quot;: &quot;N/A&quot;,</span><br><span class="line">              &quot;to&quot;: &quot;null&quot;</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;repeat&quot;: null,</span><br><span class="line">          &quot;span&quot;: 2,</span><br><span class="line">          &quot;sparkline&quot;: &#123;</span><br><span class="line">            &quot;fillColor&quot;: &quot;rgba(31, 118, 189, 0.18)&quot;,</span><br><span class="line">            &quot;full&quot;: true,</span><br><span class="line">            &quot;lineColor&quot;: &quot;rgb(31, 120, 193)&quot;,</span><br><span class="line">            &quot;show&quot;: true</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;targets&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;expr&quot;: &quot;avg(ceph_monitor_latency_seconds&#123;job=\&quot;$export\&quot;&#125;)&quot;,</span><br><span class="line">              &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">              &quot;intervalFactor&quot;: 1,</span><br><span class="line">              &quot;legendFormat&quot;: &quot;&quot;,</span><br><span class="line">              &quot;refId&quot;: &quot;A&quot;,</span><br><span class="line">              &quot;step&quot;: 10</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;thresholds&quot;: &quot;70,80&quot;,</span><br><span class="line">          &quot;title&quot;: &quot;Average Monitor Latency&quot;,</span><br><span class="line">          &quot;transparent&quot;: false,</span><br><span class="line">          &quot;type&quot;: &quot;singlestat&quot;,</span><br><span class="line">          &quot;valueFontSize&quot;: &quot;100%&quot;,</span><br><span class="line">          &quot;valueMaps&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;op&quot;: &quot;=&quot;,</span><br><span class="line">              &quot;text&quot;: &quot;N/A&quot;,</span><br><span class="line">              &quot;value&quot;: &quot;null&quot;</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;valueName&quot;: &quot;current&quot;</span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      &quot;repeat&quot;: null,</span><br><span class="line">      &quot;repeatIteration&quot;: null,</span><br><span class="line">      &quot;repeatRowId&quot;: null,</span><br><span class="line">      &quot;showTitle&quot;: false,</span><br><span class="line">      &quot;title&quot;: &quot;New row&quot;,</span><br><span class="line">      &quot;titleSize&quot;: &quot;h6&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;collapse&quot;: false,</span><br><span class="line">      &quot;height&quot;: &quot;250px&quot;,</span><br><span class="line">      &quot;panels&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;aliasColors&quot;: &#123;</span><br><span class="line">            &quot;Available&quot;: &quot;#EAB839&quot;,</span><br><span class="line">            &quot;Total Capacity&quot;: &quot;#447EBC&quot;,</span><br><span class="line">            &quot;Used&quot;: &quot;#BF1B00&quot;,</span><br><span class="line">            &quot;total_avail&quot;: &quot;#6ED0E0&quot;,</span><br><span class="line">            &quot;total_space&quot;: &quot;#7EB26D&quot;,</span><br><span class="line">            &quot;total_used&quot;: &quot;#890F02&quot;</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;bars&quot;: false,</span><br><span class="line">          &quot;datasource&quot;: &quot;prometheus&quot;,</span><br><span class="line">          &quot;editable&quot;: true,</span><br><span class="line">          &quot;error&quot;: false,</span><br><span class="line">          &quot;fill&quot;: 3,</span><br><span class="line">          &quot;grid&quot;: &#123;&#125;,</span><br><span class="line">          &quot;height&quot;: &quot;300&quot;,</span><br><span class="line">          &quot;id&quot;: 1,</span><br><span class="line">          &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">          &quot;legend&quot;: &#123;</span><br><span class="line">            &quot;alignAsTable&quot;: true,</span><br><span class="line">            &quot;avg&quot;: true,</span><br><span class="line">            &quot;current&quot;: true,</span><br><span class="line">            &quot;max&quot;: true,</span><br><span class="line">            &quot;min&quot;: true,</span><br><span class="line">            &quot;show&quot;: true,</span><br><span class="line">            &quot;total&quot;: false,</span><br><span class="line">            &quot;values&quot;: true</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;lines&quot;: true,</span><br><span class="line">          &quot;linewidth&quot;: 0,</span><br><span class="line">          &quot;links&quot;: [],</span><br><span class="line">          &quot;minSpan&quot;: null,</span><br><span class="line">          &quot;nullPointMode&quot;: &quot;connected&quot;,</span><br><span class="line">          &quot;percentage&quot;: false,</span><br><span class="line">          &quot;pointradius&quot;: 5,</span><br><span class="line">          &quot;points&quot;: false,</span><br><span class="line">          &quot;renderer&quot;: &quot;flot&quot;,</span><br><span class="line">          &quot;seriesOverrides&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;alias&quot;: &quot;Total Capacity&quot;,</span><br><span class="line">              &quot;fill&quot;: 0,</span><br><span class="line">              &quot;linewidth&quot;: 3,</span><br><span class="line">              &quot;stack&quot;: false</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;span&quot;: 4,</span><br><span class="line">          &quot;stack&quot;: true,</span><br><span class="line">          &quot;steppedLine&quot;: false,</span><br><span class="line">          &quot;targets&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;expr&quot;: &quot;ceph_cluster_available_bytes&#123;job=\&quot;$export\&quot;&#125;&quot;,</span><br><span class="line">              &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">              &quot;intervalFactor&quot;: 1,</span><br><span class="line">              &quot;legendFormat&quot;: &quot;Available&quot;,</span><br><span class="line">              &quot;refId&quot;: &quot;A&quot;,</span><br><span class="line">              &quot;step&quot;: 10</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;expr&quot;: &quot;ceph_cluster_used_bytes&#123;job=\&quot;$export\&quot;&#125;&quot;,</span><br><span class="line">              &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">              &quot;intervalFactor&quot;: 1,</span><br><span class="line">              &quot;legendFormat&quot;: &quot;Used&quot;,</span><br><span class="line">              &quot;refId&quot;: &quot;B&quot;,</span><br><span class="line">              &quot;step&quot;: 10</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;expr&quot;: &quot;ceph_cluster_capacity_bytes&#123;job=\&quot;$export\&quot;&#125;&quot;,</span><br><span class="line">              &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">              &quot;intervalFactor&quot;: 1,</span><br><span class="line">              &quot;legendFormat&quot;: &quot;Total Capacity&quot;,</span><br><span class="line">              &quot;refId&quot;: &quot;C&quot;,</span><br><span class="line">              &quot;step&quot;: 10</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;thresholds&quot;: [],</span><br><span class="line">          &quot;timeFrom&quot;: null,</span><br><span class="line">          &quot;timeShift&quot;: null,</span><br><span class="line">          &quot;title&quot;: &quot;Capacity&quot;,</span><br><span class="line">          &quot;tooltip&quot;: &#123;</span><br><span class="line">            &quot;msResolution&quot;: false,</span><br><span class="line">            &quot;shared&quot;: true,</span><br><span class="line">            &quot;sort&quot;: 2,</span><br><span class="line">            &quot;value_type&quot;: &quot;individual&quot;</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;type&quot;: &quot;graph&quot;,</span><br><span class="line">          &quot;xaxis&quot;: &#123;</span><br><span class="line">            &quot;mode&quot;: &quot;time&quot;,</span><br><span class="line">            &quot;name&quot;: null,</span><br><span class="line">            &quot;show&quot;: true,</span><br><span class="line">            &quot;values&quot;: []</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;yaxes&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;format&quot;: &quot;bytes&quot;,</span><br><span class="line">              &quot;label&quot;: null,</span><br><span class="line">              &quot;logBase&quot;: 1,</span><br><span class="line">              &quot;max&quot;: null,</span><br><span class="line">              &quot;min&quot;: null,</span><br><span class="line">              &quot;show&quot;: true</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;format&quot;: &quot;short&quot;,</span><br><span class="line">              &quot;label&quot;: null,</span><br><span class="line">              &quot;logBase&quot;: 1,</span><br><span class="line">              &quot;max&quot;: null,</span><br><span class="line">              &quot;min&quot;: null,</span><br><span class="line">              &quot;show&quot;: true</span><br><span class="line">            &#125;</span><br><span class="line">          ]</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;aliasColors&quot;: &#123;</span><br><span class="line">            &quot;Total Capacity&quot;: &quot;#7EB26D&quot;,</span><br><span class="line">            &quot;Used&quot;: &quot;#BF1B00&quot;,</span><br><span class="line">            &quot;total_avail&quot;: &quot;#6ED0E0&quot;,</span><br><span class="line">            &quot;total_space&quot;: &quot;#7EB26D&quot;,</span><br><span class="line">            &quot;total_used&quot;: &quot;#890F02&quot;</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;bars&quot;: false,</span><br><span class="line">          &quot;datasource&quot;: &quot;prometheus&quot;,</span><br><span class="line">          &quot;decimals&quot;: 0,</span><br><span class="line">          &quot;editable&quot;: true,</span><br><span class="line">          &quot;error&quot;: false,</span><br><span class="line">          &quot;fill&quot;: 1,</span><br><span class="line">          &quot;grid&quot;: &#123;&#125;,</span><br><span class="line">          &quot;height&quot;: &quot;300&quot;,</span><br><span class="line">          &quot;id&quot;: 3,</span><br><span class="line">          &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">          &quot;legend&quot;: &#123;</span><br><span class="line">            &quot;alignAsTable&quot;: true,</span><br><span class="line">            &quot;avg&quot;: true,</span><br><span class="line">            &quot;current&quot;: true,</span><br><span class="line">            &quot;max&quot;: true,</span><br><span class="line">            &quot;min&quot;: true,</span><br><span class="line">            &quot;show&quot;: true,</span><br><span class="line">            &quot;total&quot;: false,</span><br><span class="line">            &quot;values&quot;: true</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;lines&quot;: true,</span><br><span class="line">          &quot;linewidth&quot;: 1,</span><br><span class="line">          &quot;links&quot;: [],</span><br><span class="line">          &quot;minSpan&quot;: null,</span><br><span class="line">          &quot;nullPointMode&quot;: &quot;connected&quot;,</span><br><span class="line">          &quot;percentage&quot;: false,</span><br><span class="line">          &quot;pointradius&quot;: 5,</span><br><span class="line">          &quot;points&quot;: false,</span><br><span class="line">          &quot;renderer&quot;: &quot;flot&quot;,</span><br><span class="line">          &quot;seriesOverrides&quot;: [],</span><br><span class="line">          &quot;span&quot;: 4,</span><br><span class="line">          &quot;stack&quot;: true,</span><br><span class="line">          &quot;steppedLine&quot;: false,</span><br><span class="line">          &quot;targets&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;expr&quot;: &quot;ceph_client_io_write_ops&#123;job=\&quot;$export\&quot;&#125;&quot;,</span><br><span class="line">              &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">              &quot;intervalFactor&quot;: 1,</span><br><span class="line">              &quot;legendFormat&quot;: &quot;Write&quot;,</span><br><span class="line">              &quot;refId&quot;: &quot;A&quot;,</span><br><span class="line">              &quot;step&quot;: 10</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;expr&quot;: &quot;ceph_client_io_read_ops&#123;job=\&quot;$export\&quot;&#125;&quot;,</span><br><span class="line">              &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">              &quot;intervalFactor&quot;: 1,</span><br><span class="line">              &quot;legendFormat&quot;: &quot;Read&quot;,</span><br><span class="line">              &quot;refId&quot;: &quot;B&quot;,</span><br><span class="line">              &quot;step&quot;: 10</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;thresholds&quot;: [],</span><br><span class="line">          &quot;timeFrom&quot;: null,</span><br><span class="line">          &quot;timeShift&quot;: null,</span><br><span class="line">          &quot;title&quot;: &quot;IOPS&quot;,</span><br><span class="line">          &quot;tooltip&quot;: &#123;</span><br><span class="line">            &quot;msResolution&quot;: true,</span><br><span class="line">            &quot;shared&quot;: true,</span><br><span class="line">            &quot;sort&quot;: 2,</span><br><span class="line">            &quot;value_type&quot;: &quot;individual&quot;</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;type&quot;: &quot;graph&quot;,</span><br><span class="line">          &quot;xaxis&quot;: &#123;</span><br><span class="line">            &quot;mode&quot;: &quot;time&quot;,</span><br><span class="line">            &quot;name&quot;: null,</span><br><span class="line">            &quot;show&quot;: true,</span><br><span class="line">            &quot;values&quot;: []</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;yaxes&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;format&quot;: &quot;none&quot;,</span><br><span class="line">              &quot;label&quot;: &quot;&quot;,</span><br><span class="line">              &quot;logBase&quot;: 1,</span><br><span class="line">              &quot;max&quot;: null,</span><br><span class="line">              &quot;min&quot;: 0,</span><br><span class="line">              &quot;show&quot;: true</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;format&quot;: &quot;short&quot;,</span><br><span class="line">              &quot;label&quot;: null,</span><br><span class="line">              &quot;logBase&quot;: 1,</span><br><span class="line">              &quot;max&quot;: null,</span><br><span class="line">              &quot;min&quot;: 0,</span><br><span class="line">              &quot;show&quot;: true</span><br><span class="line">            &#125;</span><br><span class="line">          ]</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;aliasColors&quot;: &#123;&#125;,</span><br><span class="line">          &quot;bars&quot;: false,</span><br><span class="line">          &quot;datasource&quot;: &quot;prometheus&quot;,</span><br><span class="line">          &quot;editable&quot;: true,</span><br><span class="line">          &quot;error&quot;: false,</span><br><span class="line">          &quot;fill&quot;: 1,</span><br><span class="line">          &quot;grid&quot;: &#123;&#125;,</span><br><span class="line">          &quot;height&quot;: &quot;300&quot;,</span><br><span class="line">          &quot;id&quot;: 7,</span><br><span class="line">          &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">          &quot;legend&quot;: &#123;</span><br><span class="line">            &quot;alignAsTable&quot;: true,</span><br><span class="line">            &quot;avg&quot;: true,</span><br><span class="line">            &quot;current&quot;: true,</span><br><span class="line">            &quot;max&quot;: true,</span><br><span class="line">            &quot;min&quot;: true,</span><br><span class="line">            &quot;show&quot;: true,</span><br><span class="line">            &quot;total&quot;: false,</span><br><span class="line">            &quot;values&quot;: true</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;lines&quot;: true,</span><br><span class="line">          &quot;linewidth&quot;: 1,</span><br><span class="line">          &quot;links&quot;: [],</span><br><span class="line">          &quot;nullPointMode&quot;: &quot;connected&quot;,</span><br><span class="line">          &quot;percentage&quot;: false,</span><br><span class="line">          &quot;pointradius&quot;: 5,</span><br><span class="line">          &quot;points&quot;: false,</span><br><span class="line">          &quot;renderer&quot;: &quot;flot&quot;,</span><br><span class="line">          &quot;seriesOverrides&quot;: [],</span><br><span class="line">          &quot;span&quot;: 4,</span><br><span class="line">          &quot;stack&quot;: true,</span><br><span class="line">          &quot;steppedLine&quot;: false,</span><br><span class="line">          &quot;targets&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;expr&quot;: &quot;ceph_client_io_write_bytes&#123;job=\&quot;$export\&quot;&#125;&quot;,</span><br><span class="line">              &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">              &quot;intervalFactor&quot;: 1,</span><br><span class="line">              &quot;legendFormat&quot;: &quot;Write&quot;,</span><br><span class="line">              &quot;refId&quot;: &quot;A&quot;,</span><br><span class="line">              &quot;step&quot;: 10</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;expr&quot;: &quot;ceph_client_io_read_bytes&#123;job=\&quot;$export\&quot;&#125;&quot;,</span><br><span class="line">              &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">              &quot;intervalFactor&quot;: 1,</span><br><span class="line">              &quot;legendFormat&quot;: &quot;Read&quot;,</span><br><span class="line">              &quot;refId&quot;: &quot;B&quot;,</span><br><span class="line">              &quot;step&quot;: 10</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;thresholds&quot;: [],</span><br><span class="line">          &quot;timeFrom&quot;: null,</span><br><span class="line">          &quot;timeShift&quot;: null,</span><br><span class="line">          &quot;title&quot;: &quot;Throughput&quot;,</span><br><span class="line">          &quot;tooltip&quot;: &#123;</span><br><span class="line">            &quot;msResolution&quot;: false,</span><br><span class="line">            &quot;shared&quot;: true,</span><br><span class="line">            &quot;sort&quot;: 2,</span><br><span class="line">            &quot;value_type&quot;: &quot;individual&quot;</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;type&quot;: &quot;graph&quot;,</span><br><span class="line">          &quot;xaxis&quot;: &#123;</span><br><span class="line">            &quot;mode&quot;: &quot;time&quot;,</span><br><span class="line">            &quot;name&quot;: null,</span><br><span class="line">            &quot;show&quot;: true,</span><br><span class="line">            &quot;values&quot;: []</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;yaxes&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;format&quot;: &quot;Bps&quot;,</span><br><span class="line">              &quot;label&quot;: null,</span><br><span class="line">              &quot;logBase&quot;: 1,</span><br><span class="line">              &quot;max&quot;: null,</span><br><span class="line">              &quot;min&quot;: 0,</span><br><span class="line">              &quot;show&quot;: true</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;format&quot;: &quot;short&quot;,</span><br><span class="line">              &quot;label&quot;: null,</span><br><span class="line">              &quot;logBase&quot;: 1,</span><br><span class="line">              &quot;max&quot;: null,</span><br><span class="line">              &quot;min&quot;: 0,</span><br><span class="line">              &quot;show&quot;: true</span><br><span class="line">            &#125;</span><br><span class="line">          ]</span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      &quot;repeat&quot;: null,</span><br><span class="line">      &quot;repeatIteration&quot;: null,</span><br><span class="line">      &quot;repeatRowId&quot;: null,</span><br><span class="line">      &quot;showTitle&quot;: true,</span><br><span class="line">      &quot;title&quot;: &quot;CLUSTER&quot;,</span><br><span class="line">      &quot;titleSize&quot;: &quot;h6&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;collapse&quot;: false,</span><br><span class="line">      &quot;height&quot;: &quot;250px&quot;,</span><br><span class="line">      &quot;panels&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;aliasColors&quot;: &#123;&#125;,</span><br><span class="line">          &quot;bars&quot;: false,</span><br><span class="line">          &quot;datasource&quot;: &quot;prometheus&quot;,</span><br><span class="line">          &quot;editable&quot;: true,</span><br><span class="line">          &quot;error&quot;: false,</span><br><span class="line">          &quot;fill&quot;: 1,</span><br><span class="line">          &quot;grid&quot;: &#123;&#125;,</span><br><span class="line">          &quot;id&quot;: 18,</span><br><span class="line">          &quot;legend&quot;: &#123;</span><br><span class="line">            &quot;alignAsTable&quot;: true,</span><br><span class="line">            &quot;avg&quot;: true,</span><br><span class="line">            &quot;current&quot;: true,</span><br><span class="line">            &quot;max&quot;: false,</span><br><span class="line">            &quot;min&quot;: false,</span><br><span class="line">            &quot;rightSide&quot;: true,</span><br><span class="line">            &quot;show&quot;: true,</span><br><span class="line">            &quot;total&quot;: false,</span><br><span class="line">            &quot;values&quot;: true</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;lines&quot;: true,</span><br><span class="line">          &quot;linewidth&quot;: 2,</span><br><span class="line">          &quot;links&quot;: [],</span><br><span class="line">          &quot;nullPointMode&quot;: &quot;connected&quot;,</span><br><span class="line">          &quot;percentage&quot;: false,</span><br><span class="line">          &quot;pointradius&quot;: 5,</span><br><span class="line">          &quot;points&quot;: false,</span><br><span class="line">          &quot;renderer&quot;: &quot;flot&quot;,</span><br><span class="line">          &quot;seriesOverrides&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;alias&quot;: &quot;/^Total.*$/&quot;,</span><br><span class="line">              &quot;stack&quot;: false</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;span&quot;: 12,</span><br><span class="line">          &quot;stack&quot;: true,</span><br><span class="line">          &quot;steppedLine&quot;: false,</span><br><span class="line">          &quot;targets&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;expr&quot;: &quot;ceph_cluster_objects&#123;job=\&quot;$export\&quot;&#125;&quot;,</span><br><span class="line">              &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">              &quot;intervalFactor&quot;: 1,</span><br><span class="line">              &quot;legendFormat&quot;: &quot;Total&quot;,</span><br><span class="line">              &quot;refId&quot;: &quot;A&quot;,</span><br><span class="line">              &quot;step&quot;: 10</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;expr&quot;: &quot;ceph_degraded_objects&#123;job=\&quot;$export\&quot;&#125;&quot;,</span><br><span class="line">              &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">              &quot;intervalFactor&quot;: 1,</span><br><span class="line">              &quot;legendFormat&quot;: &quot;Degraded&quot;,</span><br><span class="line">              &quot;refId&quot;: &quot;B&quot;,</span><br><span class="line">              &quot;step&quot;: 10</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;expr&quot;: &quot;ceph_misplaced_objects&#123;job=\&quot;$export\&quot;&#125;&quot;,</span><br><span class="line">              &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">              &quot;intervalFactor&quot;: 1,</span><br><span class="line">              &quot;legendFormat&quot;: &quot;Misplaced&quot;,</span><br><span class="line">              &quot;refId&quot;: &quot;C&quot;,</span><br><span class="line">              &quot;step&quot;: 10</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;thresholds&quot;: [],</span><br><span class="line">          &quot;timeFrom&quot;: null,</span><br><span class="line">          &quot;timeShift&quot;: null,</span><br><span class="line">          &quot;title&quot;: &quot;Objects in the Cluster&quot;,</span><br><span class="line">          &quot;tooltip&quot;: &#123;</span><br><span class="line">            &quot;msResolution&quot;: false,</span><br><span class="line">            &quot;shared&quot;: true,</span><br><span class="line">            &quot;sort&quot;: 1,</span><br><span class="line">            &quot;value_type&quot;: &quot;individual&quot;</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;type&quot;: &quot;graph&quot;,</span><br><span class="line">          &quot;xaxis&quot;: &#123;</span><br><span class="line">            &quot;mode&quot;: &quot;time&quot;,</span><br><span class="line">            &quot;name&quot;: null,</span><br><span class="line">            &quot;show&quot;: true,</span><br><span class="line">            &quot;values&quot;: []</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;yaxes&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;format&quot;: &quot;short&quot;,</span><br><span class="line">              &quot;label&quot;: null,</span><br><span class="line">              &quot;logBase&quot;: 1,</span><br><span class="line">              &quot;max&quot;: null,</span><br><span class="line">              &quot;min&quot;: null,</span><br><span class="line">              &quot;show&quot;: true</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;format&quot;: &quot;short&quot;,</span><br><span class="line">              &quot;label&quot;: null,</span><br><span class="line">              &quot;logBase&quot;: 1,</span><br><span class="line">              &quot;max&quot;: null,</span><br><span class="line">              &quot;min&quot;: null,</span><br><span class="line">              &quot;show&quot;: true</span><br><span class="line">            &#125;</span><br><span class="line">          ]</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;aliasColors&quot;: &#123;&#125;,</span><br><span class="line">          &quot;bars&quot;: false,</span><br><span class="line">          &quot;datasource&quot;: &quot;prometheus&quot;,</span><br><span class="line">          &quot;editable&quot;: true,</span><br><span class="line">          &quot;error&quot;: false,</span><br><span class="line">          &quot;fill&quot;: 1,</span><br><span class="line">          &quot;grid&quot;: &#123;&#125;,</span><br><span class="line">          &quot;id&quot;: 19,</span><br><span class="line">          &quot;legend&quot;: &#123;</span><br><span class="line">            &quot;alignAsTable&quot;: true,</span><br><span class="line">            &quot;avg&quot;: true,</span><br><span class="line">            &quot;current&quot;: true,</span><br><span class="line">            &quot;max&quot;: false,</span><br><span class="line">            &quot;min&quot;: false,</span><br><span class="line">            &quot;rightSide&quot;: true,</span><br><span class="line">            &quot;show&quot;: true,</span><br><span class="line">            &quot;total&quot;: false,</span><br><span class="line">            &quot;values&quot;: true</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;lines&quot;: true,</span><br><span class="line">          &quot;linewidth&quot;: 2,</span><br><span class="line">          &quot;links&quot;: [],</span><br><span class="line">          &quot;nullPointMode&quot;: &quot;connected&quot;,</span><br><span class="line">          &quot;percentage&quot;: false,</span><br><span class="line">          &quot;pointradius&quot;: 5,</span><br><span class="line">          &quot;points&quot;: false,</span><br><span class="line">          &quot;renderer&quot;: &quot;flot&quot;,</span><br><span class="line">          &quot;seriesOverrides&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;alias&quot;: &quot;/^Total.*$/&quot;,</span><br><span class="line">              &quot;stack&quot;: false</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;span&quot;: 6,</span><br><span class="line">          &quot;stack&quot;: true,</span><br><span class="line">          &quot;steppedLine&quot;: false,</span><br><span class="line">          &quot;targets&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;expr&quot;: &quot;sum(ceph_osd_pgs&#123;job=\&quot;$export\&quot;&#125;)&quot;,</span><br><span class="line">              &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">              &quot;intervalFactor&quot;: 1,</span><br><span class="line">              &quot;legendFormat&quot;: &quot;Total&quot;,</span><br><span class="line">              &quot;refId&quot;: &quot;A&quot;,</span><br><span class="line">              &quot;step&quot;: 10</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;expr&quot;: &quot;ceph_degraded_pgs&#123;job=\&quot;$export\&quot;&#125;&quot;,</span><br><span class="line">              &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">              &quot;intervalFactor&quot;: 1,</span><br><span class="line">              &quot;legendFormat&quot;: &quot;Degraded&quot;,</span><br><span class="line">              &quot;refId&quot;: &quot;B&quot;,</span><br><span class="line">              &quot;step&quot;: 10</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;expr&quot;: &quot;ceph_stale_pgs&#123;job=\&quot;$export\&quot;&#125;&quot;,</span><br><span class="line">              &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">              &quot;intervalFactor&quot;: 1,</span><br><span class="line">              &quot;legendFormat&quot;: &quot;Stale&quot;,</span><br><span class="line">              &quot;refId&quot;: &quot;C&quot;,</span><br><span class="line">              &quot;step&quot;: 10</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;expr&quot;: &quot;ceph_unclean_pgs&#123;job=\&quot;$export\&quot;&#125;&quot;,</span><br><span class="line">              &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">              &quot;intervalFactor&quot;: 1,</span><br><span class="line">              &quot;legendFormat&quot;: &quot;Unclean&quot;,</span><br><span class="line">              &quot;refId&quot;: &quot;D&quot;,</span><br><span class="line">              &quot;step&quot;: 10</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;expr&quot;: &quot;ceph_undersized_pgs&#123;job=\&quot;$export\&quot;&#125;&quot;,</span><br><span class="line">              &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">              &quot;intervalFactor&quot;: 1,</span><br><span class="line">              &quot;legendFormat&quot;: &quot;Undersized&quot;,</span><br><span class="line">              &quot;refId&quot;: &quot;E&quot;,</span><br><span class="line">              &quot;step&quot;: 10</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;expr&quot;: &quot;ceph_stuck_degraded_pgs&#123;job=\&quot;$export\&quot;&#125;+ ceph_stuck_stale_pgs&#123;job=\&quot;$export\&quot;&#125; + ceph_stuck_unclean_pgs&#123;job=\&quot;$export\&quot;&#125; + ceph_stuck_undersized_pgs&#123;job=\&quot;$export\&quot;&#125;&quot;,</span><br><span class="line">              &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">              &quot;intervalFactor&quot;: 1,</span><br><span class="line">              &quot;legendFormat&quot;: &quot;Stuck&quot;,</span><br><span class="line">              &quot;refId&quot;: &quot;F&quot;,</span><br><span class="line">              &quot;step&quot;: 10</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;thresholds&quot;: [],</span><br><span class="line">          &quot;timeFrom&quot;: null,</span><br><span class="line">          &quot;timeShift&quot;: null,</span><br><span class="line">          &quot;title&quot;: &quot;PGs&quot;,</span><br><span class="line">          &quot;tooltip&quot;: &#123;</span><br><span class="line">            &quot;msResolution&quot;: false,</span><br><span class="line">            &quot;shared&quot;: true,</span><br><span class="line">            &quot;sort&quot;: 1,</span><br><span class="line">            &quot;value_type&quot;: &quot;individual&quot;</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;type&quot;: &quot;graph&quot;,</span><br><span class="line">          &quot;xaxis&quot;: &#123;</span><br><span class="line">            &quot;mode&quot;: &quot;time&quot;,</span><br><span class="line">            &quot;name&quot;: null,</span><br><span class="line">            &quot;show&quot;: true,</span><br><span class="line">            &quot;values&quot;: []</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;yaxes&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;format&quot;: &quot;short&quot;,</span><br><span class="line">              &quot;label&quot;: null,</span><br><span class="line">              &quot;logBase&quot;: 1,</span><br><span class="line">              &quot;max&quot;: null,</span><br><span class="line">              &quot;min&quot;: 0,</span><br><span class="line">              &quot;show&quot;: true</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;format&quot;: &quot;short&quot;,</span><br><span class="line">              &quot;label&quot;: null,</span><br><span class="line">              &quot;logBase&quot;: 1,</span><br><span class="line">              &quot;max&quot;: null,</span><br><span class="line">              &quot;min&quot;: null,</span><br><span class="line">              &quot;show&quot;: true</span><br><span class="line">            &#125;</span><br><span class="line">          ]</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;aliasColors&quot;: &#123;&#125;,</span><br><span class="line">          &quot;bars&quot;: false,</span><br><span class="line">          &quot;datasource&quot;: &quot;prometheus&quot;,</span><br><span class="line">          &quot;editable&quot;: true,</span><br><span class="line">          &quot;error&quot;: false,</span><br><span class="line">          &quot;fill&quot;: 1,</span><br><span class="line">          &quot;grid&quot;: &#123;&#125;,</span><br><span class="line">          &quot;id&quot;: 20,</span><br><span class="line">          &quot;legend&quot;: &#123;</span><br><span class="line">            &quot;alignAsTable&quot;: true,</span><br><span class="line">            &quot;avg&quot;: true,</span><br><span class="line">            &quot;current&quot;: true,</span><br><span class="line">            &quot;max&quot;: false,</span><br><span class="line">            &quot;min&quot;: false,</span><br><span class="line">            &quot;rightSide&quot;: true,</span><br><span class="line">            &quot;show&quot;: true,</span><br><span class="line">            &quot;total&quot;: false,</span><br><span class="line">            &quot;values&quot;: true</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;lines&quot;: true,</span><br><span class="line">          &quot;linewidth&quot;: 2,</span><br><span class="line">          &quot;links&quot;: [],</span><br><span class="line">          &quot;nullPointMode&quot;: &quot;connected&quot;,</span><br><span class="line">          &quot;percentage&quot;: false,</span><br><span class="line">          &quot;pointradius&quot;: 5,</span><br><span class="line">          &quot;points&quot;: false,</span><br><span class="line">          &quot;renderer&quot;: &quot;flot&quot;,</span><br><span class="line">          &quot;seriesOverrides&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;alias&quot;: &quot;/^Total.*$/&quot;,</span><br><span class="line">              &quot;stack&quot;: false</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;span&quot;: 6,</span><br><span class="line">          &quot;stack&quot;: true,</span><br><span class="line">          &quot;steppedLine&quot;: false,</span><br><span class="line">          &quot;targets&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;expr&quot;: &quot;ceph_stuck_degraded_pgs&#123;job=\&quot;$export\&quot;&#125;&quot;,</span><br><span class="line">              &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">              &quot;intervalFactor&quot;: 1,</span><br><span class="line">              &quot;legendFormat&quot;: &quot;Degraded&quot;,</span><br><span class="line">              &quot;refId&quot;: &quot;F&quot;,</span><br><span class="line">              &quot;step&quot;: 10</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;expr&quot;: &quot;ceph_stuck_stale_pgs&#123;job=\&quot;$export\&quot;&#125;&quot;,</span><br><span class="line">              &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">              &quot;intervalFactor&quot;: 1,</span><br><span class="line">              &quot;legendFormat&quot;: &quot;Stale&quot;,</span><br><span class="line">              &quot;refId&quot;: &quot;A&quot;,</span><br><span class="line">              &quot;step&quot;: 10</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;expr&quot;: &quot;ceph_stuck_unclean_pgs&#123;job=\&quot;$export\&quot;&#125;&quot;,</span><br><span class="line">              &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">              &quot;intervalFactor&quot;: 1,</span><br><span class="line">              &quot;legendFormat&quot;: &quot;Unclean&quot;,</span><br><span class="line">              &quot;refId&quot;: &quot;B&quot;,</span><br><span class="line">              &quot;step&quot;: 10</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;expr&quot;: &quot;ceph_stuck_undersized_pgs&#123;job=\&quot;$export\&quot;&#125;&quot;,</span><br><span class="line">              &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">              &quot;intervalFactor&quot;: 1,</span><br><span class="line">              &quot;legendFormat&quot;: &quot;Undersized&quot;,</span><br><span class="line">              &quot;refId&quot;: &quot;C&quot;,</span><br><span class="line">              &quot;step&quot;: 10</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;thresholds&quot;: [],</span><br><span class="line">          &quot;timeFrom&quot;: null,</span><br><span class="line">          &quot;timeShift&quot;: null,</span><br><span class="line">          &quot;title&quot;: &quot;Stuck PGs&quot;,</span><br><span class="line">          &quot;tooltip&quot;: &#123;</span><br><span class="line">            &quot;msResolution&quot;: false,</span><br><span class="line">            &quot;shared&quot;: true,</span><br><span class="line">            &quot;sort&quot;: 1,</span><br><span class="line">            &quot;value_type&quot;: &quot;individual&quot;</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;type&quot;: &quot;graph&quot;,</span><br><span class="line">          &quot;xaxis&quot;: &#123;</span><br><span class="line">            &quot;mode&quot;: &quot;time&quot;,</span><br><span class="line">            &quot;name&quot;: null,</span><br><span class="line">            &quot;show&quot;: true,</span><br><span class="line">            &quot;values&quot;: []</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;yaxes&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;format&quot;: &quot;short&quot;,</span><br><span class="line">              &quot;label&quot;: null,</span><br><span class="line">              &quot;logBase&quot;: 1,</span><br><span class="line">              &quot;max&quot;: null,</span><br><span class="line">              &quot;min&quot;: 0,</span><br><span class="line">              &quot;show&quot;: true</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;format&quot;: &quot;short&quot;,</span><br><span class="line">              &quot;label&quot;: null,</span><br><span class="line">              &quot;logBase&quot;: 1,</span><br><span class="line">              &quot;max&quot;: null,</span><br><span class="line">              &quot;min&quot;: null,</span><br><span class="line">              &quot;show&quot;: true</span><br><span class="line">            &#125;</span><br><span class="line">          ]</span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      &quot;repeat&quot;: null,</span><br><span class="line">      &quot;repeatIteration&quot;: null,</span><br><span class="line">      &quot;repeatRowId&quot;: null,</span><br><span class="line">      &quot;showTitle&quot;: false,</span><br><span class="line">      &quot;title&quot;: &quot;New row&quot;,</span><br><span class="line">      &quot;titleSize&quot;: &quot;h6&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;collapse&quot;: false,</span><br><span class="line">      &quot;height&quot;: &quot;150px&quot;,</span><br><span class="line">      &quot;panels&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;aliasColors&quot;: &#123;&#125;,</span><br><span class="line">          &quot;bars&quot;: false,</span><br><span class="line">          &quot;datasource&quot;: &quot;prometheus&quot;,</span><br><span class="line">          &quot;editable&quot;: true,</span><br><span class="line">          &quot;error&quot;: false,</span><br><span class="line">          &quot;fill&quot;: 1,</span><br><span class="line">          &quot;grid&quot;: &#123;&#125;,</span><br><span class="line">          &quot;id&quot;: 15,</span><br><span class="line">          &quot;legend&quot;: &#123;</span><br><span class="line">            &quot;avg&quot;: false,</span><br><span class="line">            &quot;current&quot;: false,</span><br><span class="line">            &quot;max&quot;: false,</span><br><span class="line">            &quot;min&quot;: false,</span><br><span class="line">            &quot;show&quot;: false,</span><br><span class="line">            &quot;total&quot;: false,</span><br><span class="line">            &quot;values&quot;: false</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;lines&quot;: true,</span><br><span class="line">          &quot;linewidth&quot;: 2,</span><br><span class="line">          &quot;links&quot;: [],</span><br><span class="line">          &quot;nullPointMode&quot;: &quot;connected&quot;,</span><br><span class="line">          &quot;percentage&quot;: false,</span><br><span class="line">          &quot;pointradius&quot;: 5,</span><br><span class="line">          &quot;points&quot;: false,</span><br><span class="line">          &quot;renderer&quot;: &quot;flot&quot;,</span><br><span class="line">          &quot;seriesOverrides&quot;: [],</span><br><span class="line">          &quot;span&quot;: 4,</span><br><span class="line">          &quot;stack&quot;: false,</span><br><span class="line">          &quot;steppedLine&quot;: false,</span><br><span class="line">          &quot;targets&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;expr&quot;: &quot;ceph_recovery_io_bytes&#123;job=\&quot;$export\&quot;&#125;&quot;,</span><br><span class="line">              &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">              &quot;intervalFactor&quot;: 1,</span><br><span class="line">              &quot;legendFormat&quot;: &quot;Bytes&quot;,</span><br><span class="line">              &quot;refId&quot;: &quot;A&quot;,</span><br><span class="line">              &quot;step&quot;: 10</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;thresholds&quot;: [],</span><br><span class="line">          &quot;timeFrom&quot;: null,</span><br><span class="line">          &quot;timeShift&quot;: null,</span><br><span class="line">          &quot;title&quot;: &quot;Bytes&quot;,</span><br><span class="line">          &quot;tooltip&quot;: &#123;</span><br><span class="line">            &quot;msResolution&quot;: false,</span><br><span class="line">            &quot;shared&quot;: true,</span><br><span class="line">            &quot;sort&quot;: 0,</span><br><span class="line">            &quot;value_type&quot;: &quot;cumulative&quot;</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;type&quot;: &quot;graph&quot;,</span><br><span class="line">          &quot;xaxis&quot;: &#123;</span><br><span class="line">            &quot;mode&quot;: &quot;time&quot;,</span><br><span class="line">            &quot;name&quot;: null,</span><br><span class="line">            &quot;show&quot;: true,</span><br><span class="line">            &quot;values&quot;: []</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;yaxes&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;format&quot;: &quot;short&quot;,</span><br><span class="line">              &quot;label&quot;: null,</span><br><span class="line">              &quot;logBase&quot;: 1,</span><br><span class="line">              &quot;max&quot;: null,</span><br><span class="line">              &quot;min&quot;: 0,</span><br><span class="line">              &quot;show&quot;: true</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;format&quot;: &quot;short&quot;,</span><br><span class="line">              &quot;label&quot;: null,</span><br><span class="line">              &quot;logBase&quot;: 1,</span><br><span class="line">              &quot;max&quot;: null,</span><br><span class="line">              &quot;min&quot;: null,</span><br><span class="line">              &quot;show&quot;: true</span><br><span class="line">            &#125;</span><br><span class="line">          ]</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;aliasColors&quot;: &#123;&#125;,</span><br><span class="line">          &quot;bars&quot;: false,</span><br><span class="line">          &quot;datasource&quot;: &quot;prometheus&quot;,</span><br><span class="line">          &quot;editable&quot;: true,</span><br><span class="line">          &quot;error&quot;: false,</span><br><span class="line">          &quot;fill&quot;: 1,</span><br><span class="line">          &quot;grid&quot;: &#123;&#125;,</span><br><span class="line">          &quot;id&quot;: 16,</span><br><span class="line">          &quot;legend&quot;: &#123;</span><br><span class="line">            &quot;avg&quot;: false,</span><br><span class="line">            &quot;current&quot;: false,</span><br><span class="line">            &quot;max&quot;: false,</span><br><span class="line">            &quot;min&quot;: false,</span><br><span class="line">            &quot;show&quot;: false,</span><br><span class="line">            &quot;total&quot;: false,</span><br><span class="line">            &quot;values&quot;: false</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;lines&quot;: true,</span><br><span class="line">          &quot;linewidth&quot;: 2,</span><br><span class="line">          &quot;links&quot;: [],</span><br><span class="line">          &quot;nullPointMode&quot;: &quot;connected&quot;,</span><br><span class="line">          &quot;percentage&quot;: false,</span><br><span class="line">          &quot;pointradius&quot;: 5,</span><br><span class="line">          &quot;points&quot;: false,</span><br><span class="line">          &quot;renderer&quot;: &quot;flot&quot;,</span><br><span class="line">          &quot;seriesOverrides&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;alias&quot;: &quot;/^.*/&quot;,</span><br><span class="line">              &quot;color&quot;: &quot;#E0752D&quot;</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;span&quot;: 4,</span><br><span class="line">          &quot;stack&quot;: false,</span><br><span class="line">          &quot;steppedLine&quot;: false,</span><br><span class="line">          &quot;targets&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;expr&quot;: &quot;ceph_recovery_io_keys&#123;job=\&quot;$export\&quot;&#125;&quot;,</span><br><span class="line">              &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">              &quot;intervalFactor&quot;: 1,</span><br><span class="line">              &quot;legendFormat&quot;: &quot;Keys&quot;,</span><br><span class="line">              &quot;refId&quot;: &quot;A&quot;,</span><br><span class="line">              &quot;step&quot;: 10</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;thresholds&quot;: [],</span><br><span class="line">          &quot;timeFrom&quot;: null,</span><br><span class="line">          &quot;timeShift&quot;: null,</span><br><span class="line">          &quot;title&quot;: &quot;Keys&quot;,</span><br><span class="line">          &quot;tooltip&quot;: &#123;</span><br><span class="line">            &quot;msResolution&quot;: false,</span><br><span class="line">            &quot;shared&quot;: true,</span><br><span class="line">            &quot;sort&quot;: 0,</span><br><span class="line">            &quot;value_type&quot;: &quot;cumulative&quot;</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;type&quot;: &quot;graph&quot;,</span><br><span class="line">          &quot;xaxis&quot;: &#123;</span><br><span class="line">            &quot;mode&quot;: &quot;time&quot;,</span><br><span class="line">            &quot;name&quot;: null,</span><br><span class="line">            &quot;show&quot;: true,</span><br><span class="line">            &quot;values&quot;: []</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;yaxes&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;format&quot;: &quot;short&quot;,</span><br><span class="line">              &quot;label&quot;: null,</span><br><span class="line">              &quot;logBase&quot;: 1,</span><br><span class="line">              &quot;max&quot;: null,</span><br><span class="line">              &quot;min&quot;: 0,</span><br><span class="line">              &quot;show&quot;: true</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;format&quot;: &quot;short&quot;,</span><br><span class="line">              &quot;label&quot;: null,</span><br><span class="line">              &quot;logBase&quot;: 1,</span><br><span class="line">              &quot;max&quot;: null,</span><br><span class="line">              &quot;min&quot;: null,</span><br><span class="line">              &quot;show&quot;: true</span><br><span class="line">            &#125;</span><br><span class="line">          ]</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;aliasColors&quot;: &#123;&#125;,</span><br><span class="line">          &quot;bars&quot;: false,</span><br><span class="line">          &quot;datasource&quot;: &quot;prometheus&quot;,</span><br><span class="line">          &quot;editable&quot;: true,</span><br><span class="line">          &quot;error&quot;: false,</span><br><span class="line">          &quot;fill&quot;: 1,</span><br><span class="line">          &quot;grid&quot;: &#123;&#125;,</span><br><span class="line">          &quot;id&quot;: 17,</span><br><span class="line">          &quot;legend&quot;: &#123;</span><br><span class="line">            &quot;avg&quot;: false,</span><br><span class="line">            &quot;current&quot;: false,</span><br><span class="line">            &quot;max&quot;: false,</span><br><span class="line">            &quot;min&quot;: false,</span><br><span class="line">            &quot;show&quot;: false,</span><br><span class="line">            &quot;total&quot;: false,</span><br><span class="line">            &quot;values&quot;: false</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;lines&quot;: true,</span><br><span class="line">          &quot;linewidth&quot;: 2,</span><br><span class="line">          &quot;links&quot;: [],</span><br><span class="line">          &quot;nullPointMode&quot;: &quot;connected&quot;,</span><br><span class="line">          &quot;percentage&quot;: false,</span><br><span class="line">          &quot;pointradius&quot;: 5,</span><br><span class="line">          &quot;points&quot;: false,</span><br><span class="line">          &quot;renderer&quot;: &quot;flot&quot;,</span><br><span class="line">          &quot;seriesOverrides&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;alias&quot;: &quot;/^.*$/&quot;,</span><br><span class="line">              &quot;color&quot;: &quot;#890F02&quot;</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;span&quot;: 4,</span><br><span class="line">          &quot;stack&quot;: false,</span><br><span class="line">          &quot;steppedLine&quot;: false,</span><br><span class="line">          &quot;targets&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;expr&quot;: &quot;ceph_recovery_io_objects&#123;job=\&quot;$export\&quot;&#125;&quot;,</span><br><span class="line">              &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">              &quot;intervalFactor&quot;: 1,</span><br><span class="line">              &quot;legendFormat&quot;: &quot;Objects&quot;,</span><br><span class="line">              &quot;refId&quot;: &quot;A&quot;,</span><br><span class="line">              &quot;step&quot;: 10</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;thresholds&quot;: [],</span><br><span class="line">          &quot;timeFrom&quot;: null,</span><br><span class="line">          &quot;timeShift&quot;: null,</span><br><span class="line">          &quot;title&quot;: &quot;Objects&quot;,</span><br><span class="line">          &quot;tooltip&quot;: &#123;</span><br><span class="line">            &quot;msResolution&quot;: false,</span><br><span class="line">            &quot;shared&quot;: true,</span><br><span class="line">            &quot;sort&quot;: 0,</span><br><span class="line">            &quot;value_type&quot;: &quot;cumulative&quot;</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;type&quot;: &quot;graph&quot;,</span><br><span class="line">          &quot;xaxis&quot;: &#123;</span><br><span class="line">            &quot;mode&quot;: &quot;time&quot;,</span><br><span class="line">            &quot;name&quot;: null,</span><br><span class="line">            &quot;show&quot;: true,</span><br><span class="line">            &quot;values&quot;: []</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;yaxes&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;format&quot;: &quot;short&quot;,</span><br><span class="line">              &quot;label&quot;: null,</span><br><span class="line">              &quot;logBase&quot;: 1,</span><br><span class="line">              &quot;max&quot;: null,</span><br><span class="line">              &quot;min&quot;: 0,</span><br><span class="line">              &quot;show&quot;: true</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;format&quot;: &quot;short&quot;,</span><br><span class="line">              &quot;label&quot;: null,</span><br><span class="line">              &quot;logBase&quot;: 1,</span><br><span class="line">              &quot;max&quot;: null,</span><br><span class="line">              &quot;min&quot;: null,</span><br><span class="line">              &quot;show&quot;: true</span><br><span class="line">            &#125;</span><br><span class="line">          ]</span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      &quot;repeat&quot;: null,</span><br><span class="line">      &quot;repeatIteration&quot;: null,</span><br><span class="line">      &quot;repeatRowId&quot;: null,</span><br><span class="line">      &quot;showTitle&quot;: true,</span><br><span class="line">      &quot;title&quot;: &quot;Recovery&quot;,</span><br><span class="line">      &quot;titleSize&quot;: &quot;h6&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  &quot;schemaVersion&quot;: 14,</span><br><span class="line">  &quot;style&quot;: &quot;dark&quot;,</span><br><span class="line">  &quot;tags&quot;: [</span><br><span class="line">    &quot;ceph&quot;,</span><br><span class="line">    &quot;cluster&quot;</span><br><span class="line">  ],</span><br><span class="line">  &quot;templating&quot;: &#123;</span><br><span class="line">    &quot;list&quot;: [</span><br><span class="line">      &#123;</span><br><span class="line">        &quot;auto&quot;: true,</span><br><span class="line">        &quot;auto_count&quot;: 10,</span><br><span class="line">        &quot;auto_min&quot;: &quot;1m&quot;,</span><br><span class="line">        &quot;current&quot;: &#123;</span><br><span class="line">          &quot;text&quot;: &quot;10s&quot;,</span><br><span class="line">          &quot;value&quot;: &quot;10s&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;datasource&quot;: null,</span><br><span class="line">        &quot;hide&quot;: 0,</span><br><span class="line">        &quot;includeAll&quot;: false,</span><br><span class="line">        &quot;label&quot;: &quot;Interval&quot;,</span><br><span class="line">        &quot;multi&quot;: false,</span><br><span class="line">        &quot;name&quot;: &quot;interval&quot;,</span><br><span class="line">        &quot;options&quot;: [</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;selected&quot;: false,</span><br><span class="line">            &quot;text&quot;: &quot;auto&quot;,</span><br><span class="line">            &quot;value&quot;: &quot;$__auto_interval&quot;</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;selected&quot;: true,</span><br><span class="line">            &quot;text&quot;: &quot;10s&quot;,</span><br><span class="line">            &quot;value&quot;: &quot;10s&quot;</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;selected&quot;: false,</span><br><span class="line">            &quot;text&quot;: &quot;30s&quot;,</span><br><span class="line">            &quot;value&quot;: &quot;30s&quot;</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;selected&quot;: false,</span><br><span class="line">            &quot;text&quot;: &quot;1m&quot;,</span><br><span class="line">            &quot;value&quot;: &quot;1m&quot;</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;selected&quot;: false,</span><br><span class="line">            &quot;text&quot;: &quot;10m&quot;,</span><br><span class="line">            &quot;value&quot;: &quot;10m&quot;</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;selected&quot;: false,</span><br><span class="line">            &quot;text&quot;: &quot;30m&quot;,</span><br><span class="line">            &quot;value&quot;: &quot;30m&quot;</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;selected&quot;: false,</span><br><span class="line">            &quot;text&quot;: &quot;1h&quot;,</span><br><span class="line">            &quot;value&quot;: &quot;1h&quot;</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;selected&quot;: false,</span><br><span class="line">            &quot;text&quot;: &quot;6h&quot;,</span><br><span class="line">            &quot;value&quot;: &quot;6h&quot;</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;selected&quot;: false,</span><br><span class="line">            &quot;text&quot;: &quot;12h&quot;,</span><br><span class="line">            &quot;value&quot;: &quot;12h&quot;</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;selected&quot;: false,</span><br><span class="line">            &quot;text&quot;: &quot;1d&quot;,</span><br><span class="line">            &quot;value&quot;: &quot;1d&quot;</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;selected&quot;: false,</span><br><span class="line">            &quot;text&quot;: &quot;7d&quot;,</span><br><span class="line">            &quot;value&quot;: &quot;7d&quot;</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;selected&quot;: false,</span><br><span class="line">            &quot;text&quot;: &quot;14d&quot;,</span><br><span class="line">            &quot;value&quot;: &quot;14d&quot;</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;selected&quot;: false,</span><br><span class="line">            &quot;text&quot;: &quot;30d&quot;,</span><br><span class="line">            &quot;value&quot;: &quot;30d&quot;</span><br><span class="line">          &#125;</span><br><span class="line">        ],</span><br><span class="line">        &quot;query&quot;: &quot;10s,30s,1m,10m,30m,1h,6h,12h,1d,7d,14d,30d&quot;,</span><br><span class="line">        &quot;refresh&quot;: 2,</span><br><span class="line">        &quot;type&quot;: &quot;interval&quot;</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        &quot;allValue&quot;: null,</span><br><span class="line">        &quot;current&quot;: &#123;</span><br><span class="line">          &quot;tags&quot;: [],</span><br><span class="line">          &quot;text&quot;: &quot;ocata-ceph&quot;,</span><br><span class="line">          &quot;value&quot;: &quot;ocata-ceph&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;datasource&quot;: &quot;prometheus&quot;,</span><br><span class="line">        &quot;hide&quot;: 0,</span><br><span class="line">        &quot;includeAll&quot;: false,</span><br><span class="line">        &quot;label&quot;: &quot;exporter&quot;,</span><br><span class="line">        &quot;multi&quot;: false,</span><br><span class="line">        &quot;name&quot;: &quot;export&quot;,</span><br><span class="line">        &quot;options&quot;: [</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;selected&quot;: true,</span><br><span class="line">            &quot;text&quot;: &quot;ocata-ceph&quot;,</span><br><span class="line">            &quot;value&quot;: &quot;ocata-ceph&quot;</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;selected&quot;: false,</span><br><span class="line">            &quot;text&quot;: &quot;ocata-ceph-cl&quot;,</span><br><span class="line">            &quot;value&quot;: &quot;ocata-ceph-cl&quot;</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;selected&quot;: false,</span><br><span class="line">            &quot;text&quot;: &quot;ceph-exporter&quot;,</span><br><span class="line">            &quot;value&quot;: &quot;ceph-exporter&quot;</span><br><span class="line">          &#125;</span><br><span class="line">        ],</span><br><span class="line">        &quot;query&quot;: &quot;label_values(ceph_health_status, job)&quot;,</span><br><span class="line">        &quot;refresh&quot;: 0,</span><br><span class="line">        &quot;regex&quot;: &quot;&quot;,</span><br><span class="line">        &quot;sort&quot;: 0,</span><br><span class="line">        &quot;tagValuesQuery&quot;: &quot;&quot;,</span><br><span class="line">        &quot;tags&quot;: [],</span><br><span class="line">        &quot;tagsQuery&quot;: &quot;&quot;,</span><br><span class="line">        &quot;type&quot;: &quot;query&quot;,</span><br><span class="line">        &quot;useTags&quot;: false</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;time&quot;: &#123;</span><br><span class="line">    &quot;from&quot;: &quot;now-3h&quot;,</span><br><span class="line">    &quot;to&quot;: &quot;now&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;timepicker&quot;: &#123;</span><br><span class="line">    &quot;refresh_intervals&quot;: [</span><br><span class="line">      &quot;5s&quot;,</span><br><span class="line">      &quot;10s&quot;,</span><br><span class="line">      &quot;30s&quot;,</span><br><span class="line">      &quot;1m&quot;,</span><br><span class="line">      &quot;5m&quot;,</span><br><span class="line">      &quot;15m&quot;,</span><br><span class="line">      &quot;30m&quot;,</span><br><span class="line">      &quot;1h&quot;,</span><br><span class="line">      &quot;2h&quot;,</span><br><span class="line">      &quot;1d&quot;</span><br><span class="line">    ],</span><br><span class="line">    &quot;time_options&quot;: [</span><br><span class="line">      &quot;5m&quot;,</span><br><span class="line">      &quot;15m&quot;,</span><br><span class="line">      &quot;1h&quot;,</span><br><span class="line">      &quot;6h&quot;,</span><br><span class="line">      &quot;12h&quot;,</span><br><span class="line">      &quot;24h&quot;,</span><br><span class="line">      &quot;2d&quot;,</span><br><span class="line">      &quot;7d&quot;,</span><br><span class="line">      &quot;30d&quot;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;timezone&quot;: &quot;browser&quot;,</span><br><span class="line">  &quot;title&quot;: &quot;Ceph - Cluster&quot;,</span><br><span class="line">  &quot;version&quot;: 65</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ceph-osd"><a href="#ceph-osd" class="headerlink" title="ceph-osd"></a>ceph-osd</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br><span class="line">911</span><br><span class="line">912</span><br><span class="line">913</span><br><span class="line">914</span><br><span class="line">915</span><br><span class="line">916</span><br><span class="line">917</span><br><span class="line">918</span><br><span class="line">919</span><br><span class="line">920</span><br><span class="line">921</span><br><span class="line">922</span><br><span class="line">923</span><br><span class="line">924</span><br><span class="line">925</span><br><span class="line">926</span><br><span class="line">927</span><br><span class="line">928</span><br><span class="line">929</span><br><span class="line">930</span><br><span class="line">931</span><br><span class="line">932</span><br><span class="line">933</span><br><span class="line">934</span><br><span class="line">935</span><br><span class="line">936</span><br><span class="line">937</span><br><span class="line">938</span><br><span class="line">939</span><br><span class="line">940</span><br><span class="line">941</span><br><span class="line">942</span><br><span class="line">943</span><br><span class="line">944</span><br><span class="line">945</span><br><span class="line">946</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;annotations&quot;: &#123;</span><br><span class="line">    &quot;list&quot;: []</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;description&quot;: &quot;CEPH OSD Status.&quot;,</span><br><span class="line">  &quot;editable&quot;: true,</span><br><span class="line">  &quot;gnetId&quot;: 923,</span><br><span class="line">  &quot;graphTooltip&quot;: 0,</span><br><span class="line">  &quot;hideControls&quot;: false,</span><br><span class="line">  &quot;id&quot;: 11,</span><br><span class="line">  &quot;links&quot;: [],</span><br><span class="line">  &quot;refresh&quot;: &quot;15m&quot;,</span><br><span class="line">  &quot;rows&quot;: [</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;collapse&quot;: false,</span><br><span class="line">      &quot;height&quot;: &quot;100px&quot;,</span><br><span class="line">      &quot;panels&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;cacheTimeout&quot;: null,</span><br><span class="line">          &quot;colorBackground&quot;: true,</span><br><span class="line">          &quot;colorValue&quot;: false,</span><br><span class="line">          &quot;colors&quot;: [</span><br><span class="line">            &quot;rgba(245, 54, 54, 0.9)&quot;,</span><br><span class="line">            &quot;rgba(237, 40, 40, 0.89)&quot;,</span><br><span class="line">            &quot;rgba(50, 172, 45, 0.97)&quot;</span><br><span class="line">          ],</span><br><span class="line">          &quot;datasource&quot;: &quot;prometheus&quot;,</span><br><span class="line">          &quot;editable&quot;: true,</span><br><span class="line">          &quot;error&quot;: false,</span><br><span class="line">          &quot;format&quot;: &quot;none&quot;,</span><br><span class="line">          &quot;gauge&quot;: &#123;</span><br><span class="line">            &quot;maxValue&quot;: 100,</span><br><span class="line">            &quot;minValue&quot;: 0,</span><br><span class="line">            &quot;show&quot;: false,</span><br><span class="line">            &quot;thresholdLabels&quot;: false,</span><br><span class="line">            &quot;thresholdMarkers&quot;: true</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;id&quot;: 6,</span><br><span class="line">          &quot;interval&quot;: null,</span><br><span class="line">          &quot;links&quot;: [],</span><br><span class="line">          &quot;mappingType&quot;: 2,</span><br><span class="line">          &quot;mappingTypes&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;name&quot;: &quot;value to text&quot;,</span><br><span class="line">              &quot;value&quot;: 1</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;name&quot;: &quot;range to text&quot;,</span><br><span class="line">              &quot;value&quot;: 2</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;maxDataPoints&quot;: 100,</span><br><span class="line">          &quot;nullPointMode&quot;: &quot;connected&quot;,</span><br><span class="line">          &quot;nullText&quot;: null,</span><br><span class="line">          &quot;postfix&quot;: &quot;&quot;,</span><br><span class="line">          &quot;postfixFontSize&quot;: &quot;50%&quot;,</span><br><span class="line">          &quot;prefix&quot;: &quot;&quot;,</span><br><span class="line">          &quot;prefixFontSize&quot;: &quot;50%&quot;,</span><br><span class="line">          &quot;rangeMaps&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;from&quot;: &quot;null&quot;,</span><br><span class="line">              &quot;text&quot;: &quot;N/A&quot;,</span><br><span class="line">              &quot;to&quot;: &quot;null&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;from&quot;: &quot;0&quot;,</span><br><span class="line">              &quot;text&quot;: &quot;DOWN&quot;,</span><br><span class="line">              &quot;to&quot;: &quot;0.99&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;from&quot;: &quot;0.99&quot;,</span><br><span class="line">              &quot;text&quot;: &quot;UP&quot;,</span><br><span class="line">              &quot;to&quot;: &quot;1&quot;</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;span&quot;: 1,</span><br><span class="line">          &quot;sparkline&quot;: &#123;</span><br><span class="line">            &quot;fillColor&quot;: &quot;rgba(31, 118, 189, 0.18)&quot;,</span><br><span class="line">            &quot;full&quot;: false,</span><br><span class="line">            &quot;lineColor&quot;: &quot;rgb(31, 120, 193)&quot;,</span><br><span class="line">            &quot;show&quot;: false</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;targets&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;expr&quot;: &quot;ceph_osd_up&#123;osd=\&quot;$osd\&quot;, job=\&quot;$export\&quot;&#125;&quot;,</span><br><span class="line">              &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">              &quot;intervalFactor&quot;: 1,</span><br><span class="line">              &quot;refId&quot;: &quot;A&quot;,</span><br><span class="line">              &quot;step&quot;: 60</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;thresholds&quot;: &quot;0,1&quot;,</span><br><span class="line">          &quot;timeFrom&quot;: null,</span><br><span class="line">          &quot;title&quot;: &quot;Status&quot;,</span><br><span class="line">          &quot;transparent&quot;: false,</span><br><span class="line">          &quot;type&quot;: &quot;singlestat&quot;,</span><br><span class="line">          &quot;valueFontSize&quot;: &quot;80%&quot;,</span><br><span class="line">          &quot;valueMaps&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;op&quot;: &quot;=&quot;,</span><br><span class="line">              &quot;text&quot;: &quot;DOWN&quot;,</span><br><span class="line">              &quot;value&quot;: &quot;0&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;op&quot;: &quot;=&quot;,</span><br><span class="line">              &quot;text&quot;: &quot;UP&quot;,</span><br><span class="line">              &quot;value&quot;: &quot;1&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;op&quot;: &quot;=&quot;,</span><br><span class="line">              &quot;text&quot;: &quot;N/A&quot;,</span><br><span class="line">              &quot;value&quot;: &quot;null&quot;</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;valueName&quot;: &quot;current&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;cacheTimeout&quot;: null,</span><br><span class="line">          &quot;colorBackground&quot;: true,</span><br><span class="line">          &quot;colorValue&quot;: false,</span><br><span class="line">          &quot;colors&quot;: [</span><br><span class="line">            &quot;rgba(245, 54, 54, 0.9)&quot;,</span><br><span class="line">            &quot;rgba(237, 40, 40, 0.89)&quot;,</span><br><span class="line">            &quot;rgba(50, 172, 45, 0.97)&quot;</span><br><span class="line">          ],</span><br><span class="line">          &quot;datasource&quot;: &quot;prometheus&quot;,</span><br><span class="line">          &quot;editable&quot;: true,</span><br><span class="line">          &quot;error&quot;: false,</span><br><span class="line">          &quot;format&quot;: &quot;none&quot;,</span><br><span class="line">          &quot;gauge&quot;: &#123;</span><br><span class="line">            &quot;maxValue&quot;: 100,</span><br><span class="line">            &quot;minValue&quot;: 0,</span><br><span class="line">            &quot;show&quot;: false,</span><br><span class="line">            &quot;thresholdLabels&quot;: false,</span><br><span class="line">            &quot;thresholdMarkers&quot;: true</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;id&quot;: 8,</span><br><span class="line">          &quot;interval&quot;: null,</span><br><span class="line">          &quot;links&quot;: [],</span><br><span class="line">          &quot;mappingType&quot;: 2,</span><br><span class="line">          &quot;mappingTypes&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;name&quot;: &quot;value to text&quot;,</span><br><span class="line">              &quot;value&quot;: 1</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;name&quot;: &quot;range to text&quot;,</span><br><span class="line">              &quot;value&quot;: 2</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;maxDataPoints&quot;: 100,</span><br><span class="line">          &quot;nullPointMode&quot;: &quot;connected&quot;,</span><br><span class="line">          &quot;nullText&quot;: null,</span><br><span class="line">          &quot;postfix&quot;: &quot;&quot;,</span><br><span class="line">          &quot;postfixFontSize&quot;: &quot;50%&quot;,</span><br><span class="line">          &quot;prefix&quot;: &quot;&quot;,</span><br><span class="line">          &quot;prefixFontSize&quot;: &quot;50%&quot;,</span><br><span class="line">          &quot;rangeMaps&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;from&quot;: &quot;null&quot;,</span><br><span class="line">              &quot;text&quot;: &quot;N/A&quot;,</span><br><span class="line">              &quot;to&quot;: &quot;null&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;from&quot;: &quot;0&quot;,</span><br><span class="line">              &quot;text&quot;: &quot;OUT&quot;,</span><br><span class="line">              &quot;to&quot;: &quot;0.99&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;from&quot;: &quot;0.99&quot;,</span><br><span class="line">              &quot;text&quot;: &quot;IN&quot;,</span><br><span class="line">              &quot;to&quot;: &quot;1&quot;</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;span&quot;: 1,</span><br><span class="line">          &quot;sparkline&quot;: &#123;</span><br><span class="line">            &quot;fillColor&quot;: &quot;rgba(31, 118, 189, 0.18)&quot;,</span><br><span class="line">            &quot;full&quot;: false,</span><br><span class="line">            &quot;lineColor&quot;: &quot;rgb(31, 120, 193)&quot;,</span><br><span class="line">            &quot;show&quot;: false</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;targets&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;expr&quot;: &quot;ceph_osd_in&#123;osd=\&quot;$osd\&quot;, job=\&quot;$export\&quot;&#125;&quot;,</span><br><span class="line">              &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">              &quot;intervalFactor&quot;: 1,</span><br><span class="line">              &quot;refId&quot;: &quot;A&quot;,</span><br><span class="line">              &quot;step&quot;: 60</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;thresholds&quot;: &quot;0,1&quot;,</span><br><span class="line">          &quot;timeFrom&quot;: null,</span><br><span class="line">          &quot;title&quot;: &quot;Available&quot;,</span><br><span class="line">          &quot;transparent&quot;: false,</span><br><span class="line">          &quot;type&quot;: &quot;singlestat&quot;,</span><br><span class="line">          &quot;valueFontSize&quot;: &quot;80%&quot;,</span><br><span class="line">          &quot;valueMaps&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;op&quot;: &quot;=&quot;,</span><br><span class="line">              &quot;text&quot;: &quot;DOWN&quot;,</span><br><span class="line">              &quot;value&quot;: &quot;0&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;op&quot;: &quot;=&quot;,</span><br><span class="line">              &quot;text&quot;: &quot;UP&quot;,</span><br><span class="line">              &quot;value&quot;: &quot;1&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;op&quot;: &quot;=&quot;,</span><br><span class="line">              &quot;text&quot;: &quot;N/A&quot;,</span><br><span class="line">              &quot;value&quot;: &quot;null&quot;</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;valueName&quot;: &quot;current&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;cacheTimeout&quot;: null,</span><br><span class="line">          &quot;colorBackground&quot;: false,</span><br><span class="line">          &quot;colorValue&quot;: false,</span><br><span class="line">          &quot;colors&quot;: [</span><br><span class="line">            &quot;rgba(245, 54, 54, 0.9)&quot;,</span><br><span class="line">            &quot;rgba(237, 129, 40, 0.89)&quot;,</span><br><span class="line">            &quot;rgba(50, 172, 45, 0.97)&quot;</span><br><span class="line">          ],</span><br><span class="line">          &quot;datasource&quot;: &quot;prometheus&quot;,</span><br><span class="line">          &quot;editable&quot;: true,</span><br><span class="line">          &quot;error&quot;: false,</span><br><span class="line">          &quot;format&quot;: &quot;none&quot;,</span><br><span class="line">          &quot;gauge&quot;: &#123;</span><br><span class="line">            &quot;maxValue&quot;: 100,</span><br><span class="line">            &quot;minValue&quot;: 0,</span><br><span class="line">            &quot;show&quot;: false,</span><br><span class="line">            &quot;thresholdLabels&quot;: false,</span><br><span class="line">            &quot;thresholdMarkers&quot;: true</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;id&quot;: 10,</span><br><span class="line">          &quot;interval&quot;: null,</span><br><span class="line">          &quot;links&quot;: [],</span><br><span class="line">          &quot;mappingType&quot;: 2,</span><br><span class="line">          &quot;mappingTypes&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;name&quot;: &quot;value to text&quot;,</span><br><span class="line">              &quot;value&quot;: 1</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;name&quot;: &quot;range to text&quot;,</span><br><span class="line">              &quot;value&quot;: 2</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;maxDataPoints&quot;: 100,</span><br><span class="line">          &quot;nullPointMode&quot;: &quot;connected&quot;,</span><br><span class="line">          &quot;nullText&quot;: null,</span><br><span class="line">          &quot;postfix&quot;: &quot;&quot;,</span><br><span class="line">          &quot;postfixFontSize&quot;: &quot;50%&quot;,</span><br><span class="line">          &quot;prefix&quot;: &quot;&quot;,</span><br><span class="line">          &quot;prefixFontSize&quot;: &quot;50%&quot;,</span><br><span class="line">          &quot;rangeMaps&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;from&quot;: &quot;null&quot;,</span><br><span class="line">              &quot;text&quot;: &quot;N/A&quot;,</span><br><span class="line">              &quot;to&quot;: &quot;null&quot;</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;span&quot;: 1,</span><br><span class="line">          &quot;sparkline&quot;: &#123;</span><br><span class="line">            &quot;fillColor&quot;: &quot;rgba(31, 118, 189, 0.18)&quot;,</span><br><span class="line">            &quot;full&quot;: false,</span><br><span class="line">            &quot;lineColor&quot;: &quot;rgb(31, 120, 193)&quot;,</span><br><span class="line">            &quot;show&quot;: false</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;targets&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;expr&quot;: &quot;ceph_osds&#123;job=\&quot;$export\&quot;&#125;&quot;,</span><br><span class="line">              &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">              &quot;intervalFactor&quot;: 1,</span><br><span class="line">              &quot;refId&quot;: &quot;A&quot;,</span><br><span class="line">              &quot;step&quot;: 60</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;thresholds&quot;: &quot;0,1&quot;,</span><br><span class="line">          &quot;timeFrom&quot;: null,</span><br><span class="line">          &quot;title&quot;: &quot;Total OSDs&quot;,</span><br><span class="line">          &quot;transparent&quot;: false,</span><br><span class="line">          &quot;type&quot;: &quot;singlestat&quot;,</span><br><span class="line">          &quot;valueFontSize&quot;: &quot;80%&quot;,</span><br><span class="line">          &quot;valueMaps&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;op&quot;: &quot;=&quot;,</span><br><span class="line">              &quot;text&quot;: &quot;DOWN&quot;,</span><br><span class="line">              &quot;value&quot;: &quot;0&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;op&quot;: &quot;=&quot;,</span><br><span class="line">              &quot;text&quot;: &quot;UP&quot;,</span><br><span class="line">              &quot;value&quot;: &quot;1&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;op&quot;: &quot;=&quot;,</span><br><span class="line">              &quot;text&quot;: &quot;N/A&quot;,</span><br><span class="line">              &quot;value&quot;: &quot;null&quot;</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;valueName&quot;: &quot;current&quot;</span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      &quot;repeat&quot;: null,</span><br><span class="line">      &quot;repeatIteration&quot;: null,</span><br><span class="line">      &quot;repeatRowId&quot;: null,</span><br><span class="line">      &quot;showTitle&quot;: false,</span><br><span class="line">      &quot;title&quot;: &quot;New row&quot;,</span><br><span class="line">      &quot;titleSize&quot;: &quot;h6&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;collapse&quot;: false,</span><br><span class="line">      &quot;height&quot;: &quot;250px&quot;,</span><br><span class="line">      &quot;panels&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;aliasColors&quot;: &#123;&#125;,</span><br><span class="line">          &quot;bars&quot;: false,</span><br><span class="line">          &quot;datasource&quot;: &quot;prometheus&quot;,</span><br><span class="line">          &quot;decimals&quot;: 2,</span><br><span class="line">          &quot;editable&quot;: true,</span><br><span class="line">          &quot;error&quot;: false,</span><br><span class="line">          &quot;fill&quot;: 1,</span><br><span class="line">          &quot;grid&quot;: &#123;&#125;,</span><br><span class="line">          &quot;id&quot;: 5,</span><br><span class="line">          &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">          &quot;legend&quot;: &#123;</span><br><span class="line">            &quot;alignAsTable&quot;: true,</span><br><span class="line">            &quot;avg&quot;: true,</span><br><span class="line">            &quot;current&quot;: true,</span><br><span class="line">            &quot;max&quot;: true,</span><br><span class="line">            &quot;min&quot;: true,</span><br><span class="line">            &quot;show&quot;: true,</span><br><span class="line">            &quot;total&quot;: false,</span><br><span class="line">            &quot;values&quot;: true</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;lines&quot;: true,</span><br><span class="line">          &quot;linewidth&quot;: 2,</span><br><span class="line">          &quot;links&quot;: [],</span><br><span class="line">          &quot;nullPointMode&quot;: &quot;connected&quot;,</span><br><span class="line">          &quot;percentage&quot;: false,</span><br><span class="line">          &quot;pointradius&quot;: 5,</span><br><span class="line">          &quot;points&quot;: false,</span><br><span class="line">          &quot;renderer&quot;: &quot;flot&quot;,</span><br><span class="line">          &quot;seriesOverrides&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;alias&quot;: &quot;/^Average.*/&quot;,</span><br><span class="line">              &quot;fill&quot;: 0,</span><br><span class="line">              &quot;stack&quot;: false</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;span&quot;: 10,</span><br><span class="line">          &quot;stack&quot;: true,</span><br><span class="line">          &quot;steppedLine&quot;: false,</span><br><span class="line">          &quot;targets&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;expr&quot;: &quot;ceph_osd_pgs&#123;osd=~\&quot;$osd\&quot;, job=\&quot;$export\&quot;&#125;&quot;,</span><br><span class="line">              &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">              &quot;intervalFactor&quot;: 1,</span><br><span class="line">              &quot;legendFormat&quot;: &quot;Number of PGs - &#123;&#123; osd&#125;&#125;&quot;,</span><br><span class="line">              &quot;refId&quot;: &quot;A&quot;,</span><br><span class="line">              &quot;step&quot;: 60</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;expr&quot;: &quot;avg(ceph_osd_pgs&#123;job=\&quot;$export\&quot;&#125;)&quot;,</span><br><span class="line">              &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">              &quot;intervalFactor&quot;: 1,</span><br><span class="line">              &quot;legendFormat&quot;: &quot;Average Number of PGs in the Cluster&quot;,</span><br><span class="line">              &quot;refId&quot;: &quot;B&quot;,</span><br><span class="line">              &quot;step&quot;: 60</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;thresholds&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;colorMode&quot;: &quot;custom&quot;,</span><br><span class="line">              &quot;line&quot;: true,</span><br><span class="line">              &quot;lineColor&quot;: &quot;rgba(216, 200, 27, 0.27)&quot;,</span><br><span class="line">              &quot;op&quot;: &quot;gt&quot;,</span><br><span class="line">              &quot;value&quot;: 250</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;colorMode&quot;: &quot;custom&quot;,</span><br><span class="line">              &quot;line&quot;: true,</span><br><span class="line">              &quot;lineColor&quot;: &quot;rgba(234, 112, 112, 0.22)&quot;,</span><br><span class="line">              &quot;op&quot;: &quot;gt&quot;,</span><br><span class="line">              &quot;value&quot;: 300</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;timeFrom&quot;: null,</span><br><span class="line">          &quot;timeShift&quot;: null,</span><br><span class="line">          &quot;title&quot;: &quot;PGs&quot;,</span><br><span class="line">          &quot;tooltip&quot;: &#123;</span><br><span class="line">            &quot;msResolution&quot;: false,</span><br><span class="line">            &quot;shared&quot;: true,</span><br><span class="line">            &quot;sort&quot;: 0,</span><br><span class="line">            &quot;value_type&quot;: &quot;individual&quot;</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;type&quot;: &quot;graph&quot;,</span><br><span class="line">          &quot;xaxis&quot;: &#123;</span><br><span class="line">            &quot;mode&quot;: &quot;time&quot;,</span><br><span class="line">            &quot;name&quot;: null,</span><br><span class="line">            &quot;show&quot;: true,</span><br><span class="line">            &quot;values&quot;: []</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;yaxes&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;format&quot;: &quot;short&quot;,</span><br><span class="line">              &quot;label&quot;: null,</span><br><span class="line">              &quot;logBase&quot;: 1,</span><br><span class="line">              &quot;max&quot;: null,</span><br><span class="line">              &quot;min&quot;: 0,</span><br><span class="line">              &quot;show&quot;: true</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;format&quot;: &quot;short&quot;,</span><br><span class="line">              &quot;label&quot;: null,</span><br><span class="line">              &quot;logBase&quot;: 1,</span><br><span class="line">              &quot;max&quot;: null,</span><br><span class="line">              &quot;min&quot;: 0,</span><br><span class="line">              &quot;show&quot;: true</span><br><span class="line">            &#125;</span><br><span class="line">          ]</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;cacheTimeout&quot;: null,</span><br><span class="line">          &quot;colorBackground&quot;: false,</span><br><span class="line">          &quot;colorValue&quot;: true,</span><br><span class="line">          &quot;colors&quot;: [</span><br><span class="line">            &quot;rgba(50, 172, 45, 0.97)&quot;,</span><br><span class="line">            &quot;rgba(237, 129, 40, 0.89)&quot;,</span><br><span class="line">            &quot;rgba(245, 54, 54, 0.9)&quot;</span><br><span class="line">          ],</span><br><span class="line">          &quot;datasource&quot;: &quot;prometheus&quot;,</span><br><span class="line">          &quot;editable&quot;: true,</span><br><span class="line">          &quot;error&quot;: false,</span><br><span class="line">          &quot;format&quot;: &quot;percent&quot;,</span><br><span class="line">          &quot;gauge&quot;: &#123;</span><br><span class="line">            &quot;maxValue&quot;: 100,</span><br><span class="line">            &quot;minValue&quot;: 0,</span><br><span class="line">            &quot;show&quot;: true,</span><br><span class="line">            &quot;thresholdLabels&quot;: false,</span><br><span class="line">            &quot;thresholdMarkers&quot;: true</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;id&quot;: 7,</span><br><span class="line">          &quot;interval&quot;: null,</span><br><span class="line">          &quot;links&quot;: [],</span><br><span class="line">          &quot;mappingType&quot;: 1,</span><br><span class="line">          &quot;mappingTypes&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;name&quot;: &quot;value to text&quot;,</span><br><span class="line">              &quot;value&quot;: 1</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;name&quot;: &quot;range to text&quot;,</span><br><span class="line">              &quot;value&quot;: 2</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;maxDataPoints&quot;: 100,</span><br><span class="line">          &quot;nullPointMode&quot;: &quot;connected&quot;,</span><br><span class="line">          &quot;nullText&quot;: null,</span><br><span class="line">          &quot;postfix&quot;: &quot;&quot;,</span><br><span class="line">          &quot;postfixFontSize&quot;: &quot;50%&quot;,</span><br><span class="line">          &quot;prefix&quot;: &quot;&quot;,</span><br><span class="line">          &quot;prefixFontSize&quot;: &quot;50%&quot;,</span><br><span class="line">          &quot;rangeMaps&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;from&quot;: &quot;null&quot;,</span><br><span class="line">              &quot;text&quot;: &quot;N/A&quot;,</span><br><span class="line">              &quot;to&quot;: &quot;null&quot;</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;span&quot;: 2,</span><br><span class="line">          &quot;sparkline&quot;: &#123;</span><br><span class="line">            &quot;fillColor&quot;: &quot;rgba(31, 118, 189, 0.18)&quot;,</span><br><span class="line">            &quot;full&quot;: false,</span><br><span class="line">            &quot;lineColor&quot;: &quot;rgb(31, 120, 193)&quot;,</span><br><span class="line">            &quot;show&quot;: true</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;targets&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;expr&quot;: &quot;ceph_osd_utilization&#123;osd=\&quot;$osd\&quot;, job=\&quot;$export\&quot;&#125;&quot;,</span><br><span class="line">              &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">              &quot;intervalFactor&quot;: 1,</span><br><span class="line">              &quot;legendFormat&quot;: &quot;&quot;,</span><br><span class="line">              &quot;refId&quot;: &quot;A&quot;,</span><br><span class="line">              &quot;step&quot;: 60</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;thresholds&quot;: &quot;60,80&quot;,</span><br><span class="line">          &quot;timeFrom&quot;: null,</span><br><span class="line">          &quot;title&quot;: &quot;Utilization&quot;,</span><br><span class="line">          &quot;transparent&quot;: false,</span><br><span class="line">          &quot;type&quot;: &quot;singlestat&quot;,</span><br><span class="line">          &quot;valueFontSize&quot;: &quot;80%&quot;,</span><br><span class="line">          &quot;valueMaps&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;op&quot;: &quot;=&quot;,</span><br><span class="line">              &quot;text&quot;: &quot;N/A&quot;,</span><br><span class="line">              &quot;value&quot;: &quot;null&quot;</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;valueName&quot;: &quot;current&quot;</span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      &quot;repeat&quot;: null,</span><br><span class="line">      &quot;repeatIteration&quot;: null,</span><br><span class="line">      &quot;repeatRowId&quot;: null,</span><br><span class="line">      &quot;showTitle&quot;: true,</span><br><span class="line">      &quot;title&quot;: &quot;OSD: $osd&quot;,</span><br><span class="line">      &quot;titleSize&quot;: &quot;h6&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;collapse&quot;: false,</span><br><span class="line">      &quot;height&quot;: &quot;250px&quot;,</span><br><span class="line">      &quot;panels&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;aliasColors&quot;: &#123;&#125;,</span><br><span class="line">          &quot;bars&quot;: false,</span><br><span class="line">          &quot;datasource&quot;: &quot;prometheus&quot;,</span><br><span class="line">          &quot;decimals&quot;: 2,</span><br><span class="line">          &quot;editable&quot;: true,</span><br><span class="line">          &quot;error&quot;: false,</span><br><span class="line">          &quot;fill&quot;: 1,</span><br><span class="line">          &quot;grid&quot;: &#123;&#125;,</span><br><span class="line">          &quot;id&quot;: 4,</span><br><span class="line">          &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">          &quot;legend&quot;: &#123;</span><br><span class="line">            &quot;alignAsTable&quot;: true,</span><br><span class="line">            &quot;avg&quot;: true,</span><br><span class="line">            &quot;current&quot;: true,</span><br><span class="line">            &quot;max&quot;: true,</span><br><span class="line">            &quot;min&quot;: true,</span><br><span class="line">            &quot;show&quot;: true,</span><br><span class="line">            &quot;total&quot;: false,</span><br><span class="line">            &quot;values&quot;: true</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;lines&quot;: false,</span><br><span class="line">          &quot;linewidth&quot;: 2,</span><br><span class="line">          &quot;links&quot;: [],</span><br><span class="line">          &quot;nullPointMode&quot;: &quot;connected&quot;,</span><br><span class="line">          &quot;percentage&quot;: false,</span><br><span class="line">          &quot;pointradius&quot;: 2,</span><br><span class="line">          &quot;points&quot;: true,</span><br><span class="line">          &quot;renderer&quot;: &quot;flot&quot;,</span><br><span class="line">          &quot;seriesOverrides&quot;: [],</span><br><span class="line">          &quot;span&quot;: 4,</span><br><span class="line">          &quot;stack&quot;: false,</span><br><span class="line">          &quot;steppedLine&quot;: false,</span><br><span class="line">          &quot;targets&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;expr&quot;: &quot;ceph_osd_perf_apply_latency_seconds&#123;osd=~\&quot;$osd\&quot;, job=\&quot;$export\&quot;&#125;&quot;,</span><br><span class="line">              &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">              &quot;intervalFactor&quot;: 1,</span><br><span class="line">              &quot;legendFormat&quot;: &quot;Apply Latency (s) - &#123;&#123; osd &#125;&#125;&quot;,</span><br><span class="line">              &quot;refId&quot;: &quot;A&quot;,</span><br><span class="line">              &quot;step&quot;: 60</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;expr&quot;: &quot;ceph_osd_perf_commit_latency_seconds&#123;osd=~\&quot;$osd\&quot;, job=\&quot;$export\&quot;&#125;&quot;,</span><br><span class="line">              &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">              &quot;intervalFactor&quot;: 1,</span><br><span class="line">              &quot;legendFormat&quot;: &quot;Commit Latency (s) - &#123;&#123; osd &#125;&#125;&quot;,</span><br><span class="line">              &quot;refId&quot;: &quot;B&quot;,</span><br><span class="line">              &quot;step&quot;: 60</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;thresholds&quot;: [],</span><br><span class="line">          &quot;timeFrom&quot;: null,</span><br><span class="line">          &quot;timeShift&quot;: null,</span><br><span class="line">          &quot;title&quot;: &quot;Latency&quot;,</span><br><span class="line">          &quot;tooltip&quot;: &#123;</span><br><span class="line">            &quot;msResolution&quot;: false,</span><br><span class="line">            &quot;shared&quot;: true,</span><br><span class="line">            &quot;sort&quot;: 0,</span><br><span class="line">            &quot;value_type&quot;: &quot;individual&quot;</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;type&quot;: &quot;graph&quot;,</span><br><span class="line">          &quot;xaxis&quot;: &#123;</span><br><span class="line">            &quot;mode&quot;: &quot;time&quot;,</span><br><span class="line">            &quot;name&quot;: null,</span><br><span class="line">            &quot;show&quot;: true,</span><br><span class="line">            &quot;values&quot;: []</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;yaxes&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;format&quot;: &quot;s&quot;,</span><br><span class="line">              &quot;label&quot;: null,</span><br><span class="line">              &quot;logBase&quot;: 1,</span><br><span class="line">              &quot;max&quot;: null,</span><br><span class="line">              &quot;min&quot;: 0,</span><br><span class="line">              &quot;show&quot;: true</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;format&quot;: &quot;s&quot;,</span><br><span class="line">              &quot;label&quot;: null,</span><br><span class="line">              &quot;logBase&quot;: 1,</span><br><span class="line">              &quot;max&quot;: null,</span><br><span class="line">              &quot;min&quot;: 0,</span><br><span class="line">              &quot;show&quot;: true</span><br><span class="line">            &#125;</span><br><span class="line">          ]</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;aliasColors&quot;: &#123;&#125;,</span><br><span class="line">          &quot;bars&quot;: false,</span><br><span class="line">          &quot;datasource&quot;: &quot;prometheus&quot;,</span><br><span class="line">          &quot;decimals&quot;: 2,</span><br><span class="line">          &quot;editable&quot;: true,</span><br><span class="line">          &quot;error&quot;: false,</span><br><span class="line">          &quot;fill&quot;: 1,</span><br><span class="line">          &quot;grid&quot;: &#123;&#125;,</span><br><span class="line">          &quot;id&quot;: 2,</span><br><span class="line">          &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">          &quot;legend&quot;: &#123;</span><br><span class="line">            &quot;alignAsTable&quot;: true,</span><br><span class="line">            &quot;avg&quot;: true,</span><br><span class="line">            &quot;current&quot;: true,</span><br><span class="line">            &quot;max&quot;: true,</span><br><span class="line">            &quot;min&quot;: true,</span><br><span class="line">            &quot;show&quot;: true,</span><br><span class="line">            &quot;total&quot;: false,</span><br><span class="line">            &quot;values&quot;: true</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;lines&quot;: true,</span><br><span class="line">          &quot;linewidth&quot;: 2,</span><br><span class="line">          &quot;links&quot;: [],</span><br><span class="line">          &quot;nullPointMode&quot;: &quot;connected&quot;,</span><br><span class="line">          &quot;percentage&quot;: false,</span><br><span class="line">          &quot;pointradius&quot;: 5,</span><br><span class="line">          &quot;points&quot;: false,</span><br><span class="line">          &quot;renderer&quot;: &quot;flot&quot;,</span><br><span class="line">          &quot;seriesOverrides&quot;: [],</span><br><span class="line">          &quot;span&quot;: 4,</span><br><span class="line">          &quot;stack&quot;: true,</span><br><span class="line">          &quot;steppedLine&quot;: false,</span><br><span class="line">          &quot;targets&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;expr&quot;: &quot;ceph_osd_avail_bytes&#123;osd=~\&quot;$osd\&quot;, job=\&quot;$export\&quot;&#125;&quot;,</span><br><span class="line">              &quot;hide&quot;: false,</span><br><span class="line">              &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">              &quot;intervalFactor&quot;: 1,</span><br><span class="line">              &quot;legendFormat&quot;: &quot;Available - &#123;&#123; osd &#125;&#125;&quot;,</span><br><span class="line">              &quot;metric&quot;: &quot;ceph_osd_avail_bytes&quot;,</span><br><span class="line">              &quot;refId&quot;: &quot;A&quot;,</span><br><span class="line">              &quot;step&quot;: 60</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;expr&quot;: &quot;ceph_osd_used_bytes&#123;osd=~\&quot;$osd\&quot;, job=\&quot;$export\&quot;&#125;&quot;,</span><br><span class="line">              &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">              &quot;intervalFactor&quot;: 1,</span><br><span class="line">              &quot;legendFormat&quot;: &quot;Used - &#123;&#123; osd &#125;&#125;&quot;,</span><br><span class="line">              &quot;metric&quot;: &quot;ceph_osd_avail_bytes&quot;,</span><br><span class="line">              &quot;refId&quot;: &quot;B&quot;,</span><br><span class="line">              &quot;step&quot;: 60</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;thresholds&quot;: [],</span><br><span class="line">          &quot;timeFrom&quot;: null,</span><br><span class="line">          &quot;timeShift&quot;: null,</span><br><span class="line">          &quot;title&quot;: &quot;OSD Storage&quot;,</span><br><span class="line">          &quot;tooltip&quot;: &#123;</span><br><span class="line">            &quot;msResolution&quot;: false,</span><br><span class="line">            &quot;shared&quot;: true,</span><br><span class="line">            &quot;sort&quot;: 0,</span><br><span class="line">            &quot;value_type&quot;: &quot;individual&quot;</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;type&quot;: &quot;graph&quot;,</span><br><span class="line">          &quot;xaxis&quot;: &#123;</span><br><span class="line">            &quot;mode&quot;: &quot;time&quot;,</span><br><span class="line">            &quot;name&quot;: null,</span><br><span class="line">            &quot;show&quot;: true,</span><br><span class="line">            &quot;values&quot;: []</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;yaxes&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;format&quot;: &quot;bytes&quot;,</span><br><span class="line">              &quot;label&quot;: null,</span><br><span class="line">              &quot;logBase&quot;: 1,</span><br><span class="line">              &quot;max&quot;: null,</span><br><span class="line">              &quot;min&quot;: 0,</span><br><span class="line">              &quot;show&quot;: true</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;format&quot;: &quot;short&quot;,</span><br><span class="line">              &quot;label&quot;: null,</span><br><span class="line">              &quot;logBase&quot;: 1,</span><br><span class="line">              &quot;max&quot;: null,</span><br><span class="line">              &quot;min&quot;: 0,</span><br><span class="line">              &quot;show&quot;: true</span><br><span class="line">            &#125;</span><br><span class="line">          ]</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;aliasColors&quot;: &#123;&#125;,</span><br><span class="line">          &quot;bars&quot;: false,</span><br><span class="line">          &quot;datasource&quot;: &quot;prometheus&quot;,</span><br><span class="line">          &quot;decimals&quot;: 5,</span><br><span class="line">          &quot;editable&quot;: true,</span><br><span class="line">          &quot;error&quot;: false,</span><br><span class="line">          &quot;fill&quot;: 1,</span><br><span class="line">          &quot;grid&quot;: &#123;&#125;,</span><br><span class="line">          &quot;id&quot;: 9,</span><br><span class="line">          &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">          &quot;legend&quot;: &#123;</span><br><span class="line">            &quot;alignAsTable&quot;: true,</span><br><span class="line">            &quot;avg&quot;: true,</span><br><span class="line">            &quot;current&quot;: true,</span><br><span class="line">            &quot;max&quot;: true,</span><br><span class="line">            &quot;min&quot;: true,</span><br><span class="line">            &quot;show&quot;: true,</span><br><span class="line">            &quot;total&quot;: false,</span><br><span class="line">            &quot;values&quot;: true</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;lines&quot;: false,</span><br><span class="line">          &quot;linewidth&quot;: 2,</span><br><span class="line">          &quot;links&quot;: [],</span><br><span class="line">          &quot;nullPointMode&quot;: &quot;connected&quot;,</span><br><span class="line">          &quot;percentage&quot;: false,</span><br><span class="line">          &quot;pointradius&quot;: 2,</span><br><span class="line">          &quot;points&quot;: true,</span><br><span class="line">          &quot;renderer&quot;: &quot;flot&quot;,</span><br><span class="line">          &quot;seriesOverrides&quot;: [],</span><br><span class="line">          &quot;span&quot;: 4,</span><br><span class="line">          &quot;stack&quot;: false,</span><br><span class="line">          &quot;steppedLine&quot;: false,</span><br><span class="line">          &quot;targets&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;expr&quot;: &quot;ceph_osd_variance&#123;osd=~\&quot;$osd\&quot;, job=\&quot;$export\&quot;&#125;&quot;,</span><br><span class="line">              &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">              &quot;intervalFactor&quot;: 1,</span><br><span class="line">              &quot;legendFormat&quot;: &quot;Available - &#123;&#123; osd &#125;&#125;&quot;,</span><br><span class="line">              &quot;metric&quot;: &quot;ceph_osd_avail_bytes&quot;,</span><br><span class="line">              &quot;refId&quot;: &quot;A&quot;,</span><br><span class="line">              &quot;step&quot;: 60</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;thresholds&quot;: [],</span><br><span class="line">          &quot;timeFrom&quot;: null,</span><br><span class="line">          &quot;timeShift&quot;: null,</span><br><span class="line">          &quot;title&quot;: &quot;Utilization Variance&quot;,</span><br><span class="line">          &quot;tooltip&quot;: &#123;</span><br><span class="line">            &quot;msResolution&quot;: false,</span><br><span class="line">            &quot;shared&quot;: true,</span><br><span class="line">            &quot;sort&quot;: 0,</span><br><span class="line">            &quot;value_type&quot;: &quot;cumulative&quot;</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;type&quot;: &quot;graph&quot;,</span><br><span class="line">          &quot;xaxis&quot;: &#123;</span><br><span class="line">            &quot;mode&quot;: &quot;time&quot;,</span><br><span class="line">            &quot;name&quot;: null,</span><br><span class="line">            &quot;show&quot;: true,</span><br><span class="line">            &quot;values&quot;: []</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;yaxes&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;format&quot;: &quot;none&quot;,</span><br><span class="line">              &quot;label&quot;: null,</span><br><span class="line">              &quot;logBase&quot;: 1,</span><br><span class="line">              &quot;max&quot;: null,</span><br><span class="line">              &quot;min&quot;: null,</span><br><span class="line">              &quot;show&quot;: true</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;format&quot;: &quot;none&quot;,</span><br><span class="line">              &quot;label&quot;: null,</span><br><span class="line">              &quot;logBase&quot;: 1,</span><br><span class="line">              &quot;max&quot;: null,</span><br><span class="line">              &quot;min&quot;: null,</span><br><span class="line">              &quot;show&quot;: true</span><br><span class="line">            &#125;</span><br><span class="line">          ]</span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      &quot;repeat&quot;: null,</span><br><span class="line">      &quot;repeatIteration&quot;: null,</span><br><span class="line">      &quot;repeatRowId&quot;: null,</span><br><span class="line">      &quot;showTitle&quot;: false,</span><br><span class="line">      &quot;title&quot;: &quot;New row&quot;,</span><br><span class="line">      &quot;titleSize&quot;: &quot;h6&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  &quot;schemaVersion&quot;: 14,</span><br><span class="line">  &quot;style&quot;: &quot;dark&quot;,</span><br><span class="line">  &quot;tags&quot;: [</span><br><span class="line">    &quot;ceph&quot;,</span><br><span class="line">    &quot;osd&quot;</span><br><span class="line">  ],</span><br><span class="line">  &quot;templating&quot;: &#123;</span><br><span class="line">    &quot;list&quot;: [</span><br><span class="line">      &#123;</span><br><span class="line">        &quot;auto&quot;: true,</span><br><span class="line">        &quot;auto_count&quot;: 10,</span><br><span class="line">        &quot;auto_min&quot;: &quot;1m&quot;,</span><br><span class="line">        &quot;current&quot;: &#123;</span><br><span class="line">          &quot;text&quot;: &quot;1m&quot;,</span><br><span class="line">          &quot;value&quot;: &quot;1m&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;datasource&quot;: null,</span><br><span class="line">        &quot;hide&quot;: 0,</span><br><span class="line">        &quot;includeAll&quot;: false,</span><br><span class="line">        &quot;label&quot;: &quot;Interval&quot;,</span><br><span class="line">        &quot;multi&quot;: false,</span><br><span class="line">        &quot;name&quot;: &quot;interval&quot;,</span><br><span class="line">        &quot;options&quot;: [</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;selected&quot;: false,</span><br><span class="line">            &quot;text&quot;: &quot;auto&quot;,</span><br><span class="line">            &quot;value&quot;: &quot;$__auto_interval&quot;</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;selected&quot;: true,</span><br><span class="line">            &quot;text&quot;: &quot;1m&quot;,</span><br><span class="line">            &quot;value&quot;: &quot;1m&quot;</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;selected&quot;: false,</span><br><span class="line">            &quot;text&quot;: &quot;10m&quot;,</span><br><span class="line">            &quot;value&quot;: &quot;10m&quot;</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;selected&quot;: false,</span><br><span class="line">            &quot;text&quot;: &quot;30m&quot;,</span><br><span class="line">            &quot;value&quot;: &quot;30m&quot;</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;selected&quot;: false,</span><br><span class="line">            &quot;text&quot;: &quot;1h&quot;,</span><br><span class="line">            &quot;value&quot;: &quot;1h&quot;</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;selected&quot;: false,</span><br><span class="line">            &quot;text&quot;: &quot;6h&quot;,</span><br><span class="line">            &quot;value&quot;: &quot;6h&quot;</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;selected&quot;: false,</span><br><span class="line">            &quot;text&quot;: &quot;12h&quot;,</span><br><span class="line">            &quot;value&quot;: &quot;12h&quot;</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;selected&quot;: false,</span><br><span class="line">            &quot;text&quot;: &quot;1d&quot;,</span><br><span class="line">            &quot;value&quot;: &quot;1d&quot;</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;selected&quot;: false,</span><br><span class="line">            &quot;text&quot;: &quot;7d&quot;,</span><br><span class="line">            &quot;value&quot;: &quot;7d&quot;</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;selected&quot;: false,</span><br><span class="line">            &quot;text&quot;: &quot;14d&quot;,</span><br><span class="line">            &quot;value&quot;: &quot;14d&quot;</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;selected&quot;: false,</span><br><span class="line">            &quot;text&quot;: &quot;30d&quot;,</span><br><span class="line">            &quot;value&quot;: &quot;30d&quot;</span><br><span class="line">          &#125;</span><br><span class="line">        ],</span><br><span class="line">        &quot;query&quot;: &quot;1m,10m,30m,1h,6h,12h,1d,7d,14d,30d&quot;,</span><br><span class="line">        &quot;refresh&quot;: 2,</span><br><span class="line">        &quot;type&quot;: &quot;interval&quot;</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        &quot;allValue&quot;: null,</span><br><span class="line">        &quot;current&quot;: &#123;</span><br><span class="line">          &quot;text&quot;: &quot;ceph-exporter&quot;,</span><br><span class="line">          &quot;value&quot;: &quot;ceph-exporter&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;datasource&quot;: &quot;prometheus&quot;,</span><br><span class="line">        &quot;hide&quot;: 0,</span><br><span class="line">        &quot;includeAll&quot;: false,</span><br><span class="line">        &quot;label&quot;: &quot;exporter&quot;,</span><br><span class="line">        &quot;multi&quot;: false,</span><br><span class="line">        &quot;name&quot;: &quot;export&quot;,</span><br><span class="line">        &quot;options&quot;: [],</span><br><span class="line">        &quot;query&quot;: &quot;label_values(ceph_health_status, job)&quot;,</span><br><span class="line">        &quot;refresh&quot;: 1,</span><br><span class="line">        &quot;regex&quot;: &quot;&quot;,</span><br><span class="line">        &quot;sort&quot;: 0,</span><br><span class="line">        &quot;tagValuesQuery&quot;: &quot;&quot;,</span><br><span class="line">        &quot;tags&quot;: [],</span><br><span class="line">        &quot;tagsQuery&quot;: &quot;&quot;,</span><br><span class="line">        &quot;type&quot;: &quot;query&quot;,</span><br><span class="line">        &quot;useTags&quot;: false</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        &quot;allValue&quot;: null,</span><br><span class="line">        &quot;current&quot;: &#123;</span><br><span class="line">          &quot;text&quot;: &quot;osd.0&quot;,</span><br><span class="line">          &quot;value&quot;: &quot;osd.0&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;datasource&quot;: &quot;prometheus&quot;,</span><br><span class="line">        &quot;hide&quot;: 0,</span><br><span class="line">        &quot;includeAll&quot;: false,</span><br><span class="line">        &quot;label&quot;: &quot;OSD&quot;,</span><br><span class="line">        &quot;multi&quot;: false,</span><br><span class="line">        &quot;name&quot;: &quot;osd&quot;,</span><br><span class="line">        &quot;options&quot;: [],</span><br><span class="line">        &quot;query&quot;: &quot;label_values(ceph_osd_up&#123;job=\&quot;$export\&quot;&#125;,  osd)&quot;,</span><br><span class="line">        &quot;refresh&quot;: 1,</span><br><span class="line">        &quot;regex&quot;: &quot;&quot;,</span><br><span class="line">        &quot;sort&quot;: 0,</span><br><span class="line">        &quot;tagValuesQuery&quot;: &quot;&quot;,</span><br><span class="line">        &quot;tags&quot;: [],</span><br><span class="line">        &quot;tagsQuery&quot;: &quot;&quot;,</span><br><span class="line">        &quot;type&quot;: &quot;query&quot;,</span><br><span class="line">        &quot;useTags&quot;: false</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;time&quot;: &#123;</span><br><span class="line">    &quot;from&quot;: &quot;now-1h&quot;,</span><br><span class="line">    &quot;to&quot;: &quot;now&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;timepicker&quot;: &#123;</span><br><span class="line">    &quot;refresh_intervals&quot;: [</span><br><span class="line">      &quot;5s&quot;,</span><br><span class="line">      &quot;10s&quot;,</span><br><span class="line">      &quot;30s&quot;,</span><br><span class="line">      &quot;1m&quot;,</span><br><span class="line">      &quot;5m&quot;,</span><br><span class="line">      &quot;15m&quot;,</span><br><span class="line">      &quot;30m&quot;,</span><br><span class="line">      &quot;1h&quot;,</span><br><span class="line">      &quot;2h&quot;,</span><br><span class="line">      &quot;1d&quot;</span><br><span class="line">    ],</span><br><span class="line">    &quot;time_options&quot;: [</span><br><span class="line">      &quot;5m&quot;,</span><br><span class="line">      &quot;15m&quot;,</span><br><span class="line">      &quot;1h&quot;,</span><br><span class="line">      &quot;6h&quot;,</span><br><span class="line">      &quot;12h&quot;,</span><br><span class="line">      &quot;24h&quot;,</span><br><span class="line">      &quot;2d&quot;,</span><br><span class="line">      &quot;7d&quot;,</span><br><span class="line">      &quot;30d&quot;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;timezone&quot;: &quot;browser&quot;,</span><br><span class="line">  &quot;title&quot;: &quot;Ceph - OSD&quot;,</span><br><span class="line">  &quot;version&quot;: 16</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ceph-pool"><a href="#ceph-pool" class="headerlink" title="ceph-pool"></a>ceph-pool</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;annotations&quot;: &#123;</span><br><span class="line">    &quot;list&quot;: []</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;description&quot;: &quot;Ceph Pools dashboard.&quot;,</span><br><span class="line">  &quot;editable&quot;: true,</span><br><span class="line">  &quot;gnetId&quot;: 926,</span><br><span class="line">  &quot;graphTooltip&quot;: 0,</span><br><span class="line">  &quot;hideControls&quot;: false,</span><br><span class="line">  &quot;id&quot;: 12,</span><br><span class="line">  &quot;links&quot;: [],</span><br><span class="line">  &quot;refresh&quot;: &quot;1m&quot;,</span><br><span class="line">  &quot;rows&quot;: [</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;collapse&quot;: false,</span><br><span class="line">      &quot;height&quot;: &quot;250px&quot;,</span><br><span class="line">      &quot;panels&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;aliasColors&quot;: &#123;&#125;,</span><br><span class="line">          &quot;bars&quot;: false,</span><br><span class="line">          &quot;datasource&quot;: &quot;prometheus&quot;,</span><br><span class="line">          &quot;decimals&quot;: 2,</span><br><span class="line">          &quot;editable&quot;: true,</span><br><span class="line">          &quot;error&quot;: false,</span><br><span class="line">          &quot;fill&quot;: 4,</span><br><span class="line">          &quot;grid&quot;: &#123;&#125;,</span><br><span class="line">          &quot;height&quot;: &quot;&quot;,</span><br><span class="line">          &quot;id&quot;: 2,</span><br><span class="line">          &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">          &quot;legend&quot;: &#123;</span><br><span class="line">            &quot;alignAsTable&quot;: true,</span><br><span class="line">            &quot;avg&quot;: true,</span><br><span class="line">            &quot;current&quot;: true,</span><br><span class="line">            &quot;max&quot;: true,</span><br><span class="line">            &quot;min&quot;: true,</span><br><span class="line">            &quot;rightSide&quot;: true,</span><br><span class="line">            &quot;show&quot;: true,</span><br><span class="line">            &quot;total&quot;: false,</span><br><span class="line">            &quot;values&quot;: true</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;lines&quot;: true,</span><br><span class="line">          &quot;linewidth&quot;: 0,</span><br><span class="line">          &quot;links&quot;: [],</span><br><span class="line">          &quot;nullPointMode&quot;: &quot;connected&quot;,</span><br><span class="line">          &quot;percentage&quot;: false,</span><br><span class="line">          &quot;pointradius&quot;: 5,</span><br><span class="line">          &quot;points&quot;: false,</span><br><span class="line">          &quot;renderer&quot;: &quot;flot&quot;,</span><br><span class="line">          &quot;seriesOverrides&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;alias&quot;: &quot;/^Total.*$/&quot;,</span><br><span class="line">              &quot;fill&quot;: 0,</span><br><span class="line">              &quot;linewidth&quot;: 4,</span><br><span class="line">              &quot;stack&quot;: false</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;alias&quot;: &quot;/^Raw.*$/&quot;,</span><br><span class="line">              &quot;color&quot;: &quot;#BF1B00&quot;,</span><br><span class="line">              &quot;fill&quot;: 0,</span><br><span class="line">              &quot;linewidth&quot;: 4</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;span&quot;: 10,</span><br><span class="line">          &quot;stack&quot;: true,</span><br><span class="line">          &quot;steppedLine&quot;: false,</span><br><span class="line">          &quot;targets&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;expr&quot;: &quot;ceph_pool_available_bytes&#123;pool=~\&quot;$pool\&quot;, job=\&quot;$export\&quot;&#125;&quot;,</span><br><span class="line">              &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">              &quot;intervalFactor&quot;: 1,</span><br><span class="line">              &quot;legendFormat&quot;: &quot;Avilable - &#123;&#123; pool &#125;&#125;&quot;,</span><br><span class="line">              &quot;metric&quot;: &quot;ceph_pool_available_bytes&quot;,</span><br><span class="line">              &quot;refId&quot;: &quot;A&quot;,</span><br><span class="line">              &quot;step&quot;: 60</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;expr&quot;: &quot;ceph_pool_used_bytes&#123;pool=~\&quot;$pool\&quot;, job=\&quot;$export\&quot;&#125;&quot;,</span><br><span class="line">              &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">              &quot;intervalFactor&quot;: 1,</span><br><span class="line">              &quot;legendFormat&quot;: &quot;Used - &#123;&#123; pool &#125;&#125;&quot;,</span><br><span class="line">              &quot;metric&quot;: &quot;ceph_pool&quot;,</span><br><span class="line">              &quot;refId&quot;: &quot;B&quot;,</span><br><span class="line">              &quot;step&quot;: 60</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;expr&quot;: &quot;ceph_pool_used_bytes&#123;pool=~\&quot;$pool\&quot;, job=\&quot;$export\&quot;&#125; + ceph_pool_available_bytes&#123;pool=~\&quot;$pool\&quot;, job=\&quot;$export\&quot;&#125;&quot;,</span><br><span class="line">              &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">              &quot;intervalFactor&quot;: 1,</span><br><span class="line">              &quot;legendFormat&quot;: &quot;Total - &#123;&#123; pool &#125;&#125;&quot;,</span><br><span class="line">              &quot;metric&quot;: &quot;ceph_pool&quot;,</span><br><span class="line">              &quot;refId&quot;: &quot;C&quot;,</span><br><span class="line">              &quot;step&quot;: 60</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;expr&quot;: &quot;ceph_pool_raw_used_bytes&#123;pool=~\&quot;$pool\&quot;, job=\&quot;$export\&quot;&#125;&quot;,</span><br><span class="line">              &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">              &quot;intervalFactor&quot;: 1,</span><br><span class="line">              &quot;legendFormat&quot;: &quot;Raw - &#123;&#123; pool &#125;&#125;&quot;,</span><br><span class="line">              &quot;metric&quot;: &quot;ceph_pool&quot;,</span><br><span class="line">              &quot;refId&quot;: &quot;D&quot;,</span><br><span class="line">              &quot;step&quot;: 60</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;thresholds&quot;: [],</span><br><span class="line">          &quot;timeFrom&quot;: null,</span><br><span class="line">          &quot;timeShift&quot;: null,</span><br><span class="line">          &quot;title&quot;: &quot;Pool Storage&quot;,</span><br><span class="line">          &quot;tooltip&quot;: &#123;</span><br><span class="line">            &quot;msResolution&quot;: false,</span><br><span class="line">            &quot;shared&quot;: true,</span><br><span class="line">            &quot;sort&quot;: 0,</span><br><span class="line">            &quot;value_type&quot;: &quot;individual&quot;</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;type&quot;: &quot;graph&quot;,</span><br><span class="line">          &quot;xaxis&quot;: &#123;</span><br><span class="line">            &quot;mode&quot;: &quot;time&quot;,</span><br><span class="line">            &quot;name&quot;: null,</span><br><span class="line">            &quot;show&quot;: true,</span><br><span class="line">            &quot;values&quot;: []</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;yaxes&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;format&quot;: &quot;bytes&quot;,</span><br><span class="line">              &quot;label&quot;: null,</span><br><span class="line">              &quot;logBase&quot;: 1,</span><br><span class="line">              &quot;max&quot;: null,</span><br><span class="line">              &quot;min&quot;: 0,</span><br><span class="line">              &quot;show&quot;: true</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;format&quot;: &quot;short&quot;,</span><br><span class="line">              &quot;label&quot;: null,</span><br><span class="line">              &quot;logBase&quot;: 1,</span><br><span class="line">              &quot;max&quot;: null,</span><br><span class="line">              &quot;min&quot;: 0,</span><br><span class="line">              &quot;show&quot;: true</span><br><span class="line">            &#125;</span><br><span class="line">          ]</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;cacheTimeout&quot;: null,</span><br><span class="line">          &quot;colorBackground&quot;: false,</span><br><span class="line">          &quot;colorValue&quot;: true,</span><br><span class="line">          &quot;colors&quot;: [</span><br><span class="line">            &quot;rgba(245, 54, 54, 0.9)&quot;,</span><br><span class="line">            &quot;rgba(237, 129, 40, 0.89)&quot;,</span><br><span class="line">            &quot;rgba(50, 172, 45, 0.97)&quot;</span><br><span class="line">          ],</span><br><span class="line">          &quot;datasource&quot;: &quot;prometheus&quot;,</span><br><span class="line">          &quot;decimals&quot;: 2,</span><br><span class="line">          &quot;editable&quot;: true,</span><br><span class="line">          &quot;error&quot;: false,</span><br><span class="line">          &quot;format&quot;: &quot;percentunit&quot;,</span><br><span class="line">          &quot;gauge&quot;: &#123;</span><br><span class="line">            &quot;maxValue&quot;: 1,</span><br><span class="line">            &quot;minValue&quot;: 0,</span><br><span class="line">            &quot;show&quot;: true,</span><br><span class="line">            &quot;thresholdLabels&quot;: false,</span><br><span class="line">            &quot;thresholdMarkers&quot;: true</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;id&quot;: 10,</span><br><span class="line">          &quot;interval&quot;: null,</span><br><span class="line">          &quot;links&quot;: [],</span><br><span class="line">          &quot;mappingType&quot;: 1,</span><br><span class="line">          &quot;mappingTypes&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;name&quot;: &quot;value to text&quot;,</span><br><span class="line">              &quot;value&quot;: 1</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;name&quot;: &quot;range to text&quot;,</span><br><span class="line">              &quot;value&quot;: 2</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;maxDataPoints&quot;: 100,</span><br><span class="line">          &quot;nullPointMode&quot;: &quot;connected&quot;,</span><br><span class="line">          &quot;nullText&quot;: null,</span><br><span class="line">          &quot;postfix&quot;: &quot;&quot;,</span><br><span class="line">          &quot;postfixFontSize&quot;: &quot;50%&quot;,</span><br><span class="line">          &quot;prefix&quot;: &quot;&quot;,</span><br><span class="line">          &quot;prefixFontSize&quot;: &quot;50%&quot;,</span><br><span class="line">          &quot;rangeMaps&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;from&quot;: &quot;null&quot;,</span><br><span class="line">              &quot;text&quot;: &quot;N/A&quot;,</span><br><span class="line">              &quot;to&quot;: &quot;null&quot;</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;span&quot;: 2,</span><br><span class="line">          &quot;sparkline&quot;: &#123;</span><br><span class="line">            &quot;fillColor&quot;: &quot;rgba(31, 118, 189, 0.18)&quot;,</span><br><span class="line">            &quot;full&quot;: false,</span><br><span class="line">            &quot;lineColor&quot;: &quot;rgb(31, 120, 193)&quot;,</span><br><span class="line">            &quot;show&quot;: false</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;targets&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;expr&quot;: &quot; ceph_pool_used_bytes&#123;pool=\&quot;$pool\&quot;, job=\&quot;$export\&quot;&#125; / (ceph_pool_available_bytes&#123;pool=\&quot;$pool\&quot;, job=\&quot;$export\&quot;&#125; + ceph_pool_used_bytes&#123;pool=\&quot;$pool\&quot;, job=\&quot;$export\&quot;&#125;)&quot;,</span><br><span class="line">              &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">              &quot;intervalFactor&quot;: 1,</span><br><span class="line">              &quot;refId&quot;: &quot;A&quot;,</span><br><span class="line">              &quot;step&quot;: 60</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;thresholds&quot;: &quot;&quot;,</span><br><span class="line">          &quot;title&quot;: &quot;Usage&quot;,</span><br><span class="line">          &quot;type&quot;: &quot;singlestat&quot;,</span><br><span class="line">          &quot;valueFontSize&quot;: &quot;80%&quot;,</span><br><span class="line">          &quot;valueMaps&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;op&quot;: &quot;=&quot;,</span><br><span class="line">              &quot;text&quot;: &quot;N/A&quot;,</span><br><span class="line">              &quot;value&quot;: &quot;null&quot;</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;valueName&quot;: &quot;current&quot;</span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      &quot;repeat&quot;: null,</span><br><span class="line">      &quot;repeatIteration&quot;: null,</span><br><span class="line">      &quot;repeatRowId&quot;: null,</span><br><span class="line">      &quot;showTitle&quot;: true,</span><br><span class="line">      &quot;title&quot;: &quot;Pool: $pool&quot;,</span><br><span class="line">      &quot;titleSize&quot;: &quot;h6&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;collapse&quot;: false,</span><br><span class="line">      &quot;height&quot;: &quot;250px&quot;,</span><br><span class="line">      &quot;panels&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;aliasColors&quot;: &#123;&#125;,</span><br><span class="line">          &quot;bars&quot;: false,</span><br><span class="line">          &quot;datasource&quot;: &quot;prometheus&quot;,</span><br><span class="line">          &quot;editable&quot;: true,</span><br><span class="line">          &quot;error&quot;: false,</span><br><span class="line">          &quot;fill&quot;: 1,</span><br><span class="line">          &quot;grid&quot;: &#123;&#125;,</span><br><span class="line">          &quot;height&quot;: &quot;&quot;,</span><br><span class="line">          &quot;id&quot;: 7,</span><br><span class="line">          &quot;legend&quot;: &#123;</span><br><span class="line">            &quot;avg&quot;: false,</span><br><span class="line">            &quot;current&quot;: false,</span><br><span class="line">            &quot;max&quot;: false,</span><br><span class="line">            &quot;min&quot;: false,</span><br><span class="line">            &quot;show&quot;: true,</span><br><span class="line">            &quot;total&quot;: false,</span><br><span class="line">            &quot;values&quot;: false</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;lines&quot;: true,</span><br><span class="line">          &quot;linewidth&quot;: 2,</span><br><span class="line">          &quot;links&quot;: [],</span><br><span class="line">          &quot;nullPointMode&quot;: &quot;connected&quot;,</span><br><span class="line">          &quot;percentage&quot;: false,</span><br><span class="line">          &quot;pointradius&quot;: 5,</span><br><span class="line">          &quot;points&quot;: false,</span><br><span class="line">          &quot;renderer&quot;: &quot;flot&quot;,</span><br><span class="line">          &quot;seriesOverrides&quot;: [],</span><br><span class="line">          &quot;span&quot;: 6,</span><br><span class="line">          &quot;stack&quot;: false,</span><br><span class="line">          &quot;steppedLine&quot;: false,</span><br><span class="line">          &quot;targets&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;expr&quot;: &quot;ceph_pool_objects_total&#123;pool=~\&quot;$pool\&quot;, job=\&quot;$export\&quot;&#125;&quot;,</span><br><span class="line">              &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">              &quot;intervalFactor&quot;: 1,</span><br><span class="line">              &quot;legendFormat&quot;: &quot;Objects - &#123;&#123; pool &#125;&#125;&quot;,</span><br><span class="line">              &quot;refId&quot;: &quot;A&quot;,</span><br><span class="line">              &quot;step&quot;: 60</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;expr&quot;: &quot;ceph_pool_dirty_objects_total&#123;pool=~\&quot;$pool\&quot;, job=\&quot;$export\&quot;&#125;&quot;,</span><br><span class="line">              &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">              &quot;intervalFactor&quot;: 1,</span><br><span class="line">              &quot;legendFormat&quot;: &quot;Dirty Objects - &#123;&#123; pool &#125;&#125;&quot;,</span><br><span class="line">              &quot;refId&quot;: &quot;B&quot;,</span><br><span class="line">              &quot;step&quot;: 60</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;thresholds&quot;: [],</span><br><span class="line">          &quot;timeFrom&quot;: null,</span><br><span class="line">          &quot;timeShift&quot;: null,</span><br><span class="line">          &quot;title&quot;: &quot;Objects in Pool&quot;,</span><br><span class="line">          &quot;tooltip&quot;: &#123;</span><br><span class="line">            &quot;msResolution&quot;: false,</span><br><span class="line">            &quot;shared&quot;: true,</span><br><span class="line">            &quot;sort&quot;: 0,</span><br><span class="line">            &quot;value_type&quot;: &quot;cumulative&quot;</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;type&quot;: &quot;graph&quot;,</span><br><span class="line">          &quot;xaxis&quot;: &#123;</span><br><span class="line">            &quot;mode&quot;: &quot;time&quot;,</span><br><span class="line">            &quot;name&quot;: null,</span><br><span class="line">            &quot;show&quot;: true,</span><br><span class="line">            &quot;values&quot;: []</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;yaxes&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;format&quot;: &quot;short&quot;,</span><br><span class="line">              &quot;label&quot;: null,</span><br><span class="line">              &quot;logBase&quot;: 1,</span><br><span class="line">              &quot;max&quot;: null,</span><br><span class="line">              &quot;min&quot;: 0,</span><br><span class="line">              &quot;show&quot;: true</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;format&quot;: &quot;short&quot;,</span><br><span class="line">              &quot;label&quot;: null,</span><br><span class="line">              &quot;logBase&quot;: 1,</span><br><span class="line">              &quot;max&quot;: null,</span><br><span class="line">              &quot;min&quot;: 0,</span><br><span class="line">              &quot;show&quot;: true</span><br><span class="line">            &#125;</span><br><span class="line">          ]</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;aliasColors&quot;: &#123;&#125;,</span><br><span class="line">          &quot;bars&quot;: false,</span><br><span class="line">          &quot;datasource&quot;: &quot;prometheus&quot;,</span><br><span class="line">          &quot;decimals&quot;: 2,</span><br><span class="line">          &quot;editable&quot;: true,</span><br><span class="line">          &quot;error&quot;: false,</span><br><span class="line">          &quot;fill&quot;: 1,</span><br><span class="line">          &quot;grid&quot;: &#123;&#125;,</span><br><span class="line">          &quot;id&quot;: 4,</span><br><span class="line">          &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">          &quot;legend&quot;: &#123;</span><br><span class="line">            &quot;alignAsTable&quot;: true,</span><br><span class="line">            &quot;avg&quot;: true,</span><br><span class="line">            &quot;current&quot;: true,</span><br><span class="line">            &quot;max&quot;: true,</span><br><span class="line">            &quot;min&quot;: true,</span><br><span class="line">            &quot;show&quot;: true,</span><br><span class="line">            &quot;total&quot;: false,</span><br><span class="line">            &quot;values&quot;: true</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;lines&quot;: true,</span><br><span class="line">          &quot;linewidth&quot;: 2,</span><br><span class="line">          &quot;links&quot;: [],</span><br><span class="line">          &quot;nullPointMode&quot;: &quot;connected&quot;,</span><br><span class="line">          &quot;percentage&quot;: false,</span><br><span class="line">          &quot;pointradius&quot;: 5,</span><br><span class="line">          &quot;points&quot;: false,</span><br><span class="line">          &quot;renderer&quot;: &quot;flot&quot;,</span><br><span class="line">          &quot;seriesOverrides&quot;: [],</span><br><span class="line">          &quot;span&quot;: 6,</span><br><span class="line">          &quot;stack&quot;: true,</span><br><span class="line">          &quot;steppedLine&quot;: false,</span><br><span class="line">          &quot;targets&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;expr&quot;: &quot;irate(ceph_pool_read_total&#123;pool=~\&quot;$pool\&quot;, job=\&quot;$export\&quot;&#125;[3m])&quot;,</span><br><span class="line">              &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">              &quot;intervalFactor&quot;: 1,</span><br><span class="line">              &quot;legendFormat&quot;: &quot;Read - &#123;&#123; pool &#125;&#125;&quot;,</span><br><span class="line">              &quot;refId&quot;: &quot;B&quot;,</span><br><span class="line">              &quot;step&quot;: 60</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;expr&quot;: &quot;irate(ceph_pool_write_total&#123;pool=~\&quot;$pool\&quot;, job=\&quot;$export\&quot;&#125;[3m])&quot;,</span><br><span class="line">              &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">              &quot;intervalFactor&quot;: 1,</span><br><span class="line">              &quot;legendFormat&quot;: &quot;Write - &#123;&#123; pool &#125;&#125;&quot;,</span><br><span class="line">              &quot;refId&quot;: &quot;A&quot;,</span><br><span class="line">              &quot;step&quot;: 60</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;thresholds&quot;: [],</span><br><span class="line">          &quot;timeFrom&quot;: null,</span><br><span class="line">          &quot;timeShift&quot;: null,</span><br><span class="line">          &quot;title&quot;: &quot;IOPS&quot;,</span><br><span class="line">          &quot;tooltip&quot;: &#123;</span><br><span class="line">            &quot;msResolution&quot;: false,</span><br><span class="line">            &quot;shared&quot;: true,</span><br><span class="line">            &quot;sort&quot;: 0,</span><br><span class="line">            &quot;value_type&quot;: &quot;individual&quot;</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;type&quot;: &quot;graph&quot;,</span><br><span class="line">          &quot;xaxis&quot;: &#123;</span><br><span class="line">            &quot;mode&quot;: &quot;time&quot;,</span><br><span class="line">            &quot;name&quot;: null,</span><br><span class="line">            &quot;show&quot;: true,</span><br><span class="line">            &quot;values&quot;: []</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;yaxes&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;format&quot;: &quot;none&quot;,</span><br><span class="line">              &quot;label&quot;: &quot;IOPS&quot;,</span><br><span class="line">              &quot;logBase&quot;: 1,</span><br><span class="line">              &quot;max&quot;: null,</span><br><span class="line">              &quot;min&quot;: 0,</span><br><span class="line">              &quot;show&quot;: true</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;format&quot;: &quot;short&quot;,</span><br><span class="line">              &quot;label&quot;: &quot;IOPS&quot;,</span><br><span class="line">              &quot;logBase&quot;: 1,</span><br><span class="line">              &quot;max&quot;: null,</span><br><span class="line">              &quot;min&quot;: 0,</span><br><span class="line">              &quot;show&quot;: false</span><br><span class="line">            &#125;</span><br><span class="line">          ]</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;aliasColors&quot;: &#123;&#125;,</span><br><span class="line">          &quot;bars&quot;: false,</span><br><span class="line">          &quot;datasource&quot;: &quot;prometheus&quot;,</span><br><span class="line">          &quot;decimals&quot;: 2,</span><br><span class="line">          &quot;editable&quot;: true,</span><br><span class="line">          &quot;error&quot;: false,</span><br><span class="line">          &quot;fill&quot;: 1,</span><br><span class="line">          &quot;grid&quot;: &#123;&#125;,</span><br><span class="line">          &quot;id&quot;: 5,</span><br><span class="line">          &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">          &quot;legend&quot;: &#123;</span><br><span class="line">            &quot;alignAsTable&quot;: true,</span><br><span class="line">            &quot;avg&quot;: true,</span><br><span class="line">            &quot;current&quot;: true,</span><br><span class="line">            &quot;max&quot;: true,</span><br><span class="line">            &quot;min&quot;: true,</span><br><span class="line">            &quot;show&quot;: true,</span><br><span class="line">            &quot;total&quot;: false,</span><br><span class="line">            &quot;values&quot;: true</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;lines&quot;: true,</span><br><span class="line">          &quot;linewidth&quot;: 2,</span><br><span class="line">          &quot;links&quot;: [],</span><br><span class="line">          &quot;nullPointMode&quot;: &quot;connected&quot;,</span><br><span class="line">          &quot;percentage&quot;: false,</span><br><span class="line">          &quot;pointradius&quot;: 5,</span><br><span class="line">          &quot;points&quot;: false,</span><br><span class="line">          &quot;renderer&quot;: &quot;flot&quot;,</span><br><span class="line">          &quot;seriesOverrides&quot;: [],</span><br><span class="line">          &quot;span&quot;: 12,</span><br><span class="line">          &quot;stack&quot;: true,</span><br><span class="line">          &quot;steppedLine&quot;: false,</span><br><span class="line">          &quot;targets&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;expr&quot;: &quot;irate(ceph_pool_read_bytes_total&#123;pool=\&quot;$pool\&quot;, job=\&quot;$export\&quot;&#125;[3m])&quot;,</span><br><span class="line">              &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">              &quot;intervalFactor&quot;: 1,</span><br><span class="line">              &quot;legendFormat&quot;: &quot;Read Bytes - &#123;&#123; pool &#125;&#125;&quot;,</span><br><span class="line">              &quot;refId&quot;: &quot;A&quot;,</span><br><span class="line">              &quot;step&quot;: 60</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;expr&quot;: &quot;irate(ceph_pool_write_bytes_total&#123;pool=\&quot;$pool\&quot;, job=\&quot;$export\&quot;&#125;[3m])&quot;,</span><br><span class="line">              &quot;interval&quot;: &quot;$interval&quot;,</span><br><span class="line">              &quot;intervalFactor&quot;: 1,</span><br><span class="line">              &quot;legendFormat&quot;: &quot;Written Bytes - &#123;&#123; pool &#125;&#125;&quot;,</span><br><span class="line">              &quot;refId&quot;: &quot;B&quot;,</span><br><span class="line">              &quot;step&quot;: 60</span><br><span class="line">            &#125;</span><br><span class="line">          ],</span><br><span class="line">          &quot;thresholds&quot;: [],</span><br><span class="line">          &quot;timeFrom&quot;: null,</span><br><span class="line">          &quot;timeShift&quot;: null,</span><br><span class="line">          &quot;title&quot;: &quot;Throughput&quot;,</span><br><span class="line">          &quot;tooltip&quot;: &#123;</span><br><span class="line">            &quot;msResolution&quot;: false,</span><br><span class="line">            &quot;shared&quot;: true,</span><br><span class="line">            &quot;sort&quot;: 0,</span><br><span class="line">            &quot;value_type&quot;: &quot;individual&quot;</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;type&quot;: &quot;graph&quot;,</span><br><span class="line">          &quot;xaxis&quot;: &#123;</span><br><span class="line">            &quot;mode&quot;: &quot;time&quot;,</span><br><span class="line">            &quot;name&quot;: null,</span><br><span class="line">            &quot;show&quot;: true,</span><br><span class="line">            &quot;values&quot;: []</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;yaxes&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;format&quot;: &quot;Bps&quot;,</span><br><span class="line">              &quot;label&quot;: null,</span><br><span class="line">              &quot;logBase&quot;: 1,</span><br><span class="line">              &quot;max&quot;: null,</span><br><span class="line">              &quot;min&quot;: 0,</span><br><span class="line">              &quot;show&quot;: true</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              &quot;format&quot;: &quot;Bps&quot;,</span><br><span class="line">              &quot;label&quot;: null,</span><br><span class="line">              &quot;logBase&quot;: 1,</span><br><span class="line">              &quot;max&quot;: null,</span><br><span class="line">              &quot;min&quot;: 0,</span><br><span class="line">              &quot;show&quot;: true</span><br><span class="line">            &#125;</span><br><span class="line">          ]</span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      &quot;repeat&quot;: null,</span><br><span class="line">      &quot;repeatIteration&quot;: null,</span><br><span class="line">      &quot;repeatRowId&quot;: null,</span><br><span class="line">      &quot;showTitle&quot;: false,</span><br><span class="line">      &quot;title&quot;: &quot;New row&quot;,</span><br><span class="line">      &quot;titleSize&quot;: &quot;h6&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  &quot;schemaVersion&quot;: 14,</span><br><span class="line">  &quot;style&quot;: &quot;dark&quot;,</span><br><span class="line">  &quot;tags&quot;: [</span><br><span class="line">    &quot;ceph&quot;,</span><br><span class="line">    &quot;pools&quot;</span><br><span class="line">  ],</span><br><span class="line">  &quot;templating&quot;: &#123;</span><br><span class="line">    &quot;list&quot;: [</span><br><span class="line">      &#123;</span><br><span class="line">        &quot;auto&quot;: true,</span><br><span class="line">        &quot;auto_count&quot;: 10,</span><br><span class="line">        &quot;auto_min&quot;: &quot;1m&quot;,</span><br><span class="line">        &quot;current&quot;: &#123;</span><br><span class="line">          &quot;text&quot;: &quot;1m&quot;,</span><br><span class="line">          &quot;value&quot;: &quot;1m&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;datasource&quot;: null,</span><br><span class="line">        &quot;hide&quot;: 0,</span><br><span class="line">        &quot;includeAll&quot;: false,</span><br><span class="line">        &quot;label&quot;: &quot;Interval&quot;,</span><br><span class="line">        &quot;multi&quot;: false,</span><br><span class="line">        &quot;name&quot;: &quot;interval&quot;,</span><br><span class="line">        &quot;options&quot;: [</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;selected&quot;: false,</span><br><span class="line">            &quot;text&quot;: &quot;auto&quot;,</span><br><span class="line">            &quot;value&quot;: &quot;$__auto_interval&quot;</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;selected&quot;: true,</span><br><span class="line">            &quot;text&quot;: &quot;1m&quot;,</span><br><span class="line">            &quot;value&quot;: &quot;1m&quot;</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;selected&quot;: false,</span><br><span class="line">            &quot;text&quot;: &quot;10m&quot;,</span><br><span class="line">            &quot;value&quot;: &quot;10m&quot;</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;selected&quot;: false,</span><br><span class="line">            &quot;text&quot;: &quot;30m&quot;,</span><br><span class="line">            &quot;value&quot;: &quot;30m&quot;</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;selected&quot;: false,</span><br><span class="line">            &quot;text&quot;: &quot;1h&quot;,</span><br><span class="line">            &quot;value&quot;: &quot;1h&quot;</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;selected&quot;: false,</span><br><span class="line">            &quot;text&quot;: &quot;6h&quot;,</span><br><span class="line">            &quot;value&quot;: &quot;6h&quot;</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;selected&quot;: false,</span><br><span class="line">            &quot;text&quot;: &quot;12h&quot;,</span><br><span class="line">            &quot;value&quot;: &quot;12h&quot;</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;selected&quot;: false,</span><br><span class="line">            &quot;text&quot;: &quot;1d&quot;,</span><br><span class="line">            &quot;value&quot;: &quot;1d&quot;</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;selected&quot;: false,</span><br><span class="line">            &quot;text&quot;: &quot;7d&quot;,</span><br><span class="line">            &quot;value&quot;: &quot;7d&quot;</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;selected&quot;: false,</span><br><span class="line">            &quot;text&quot;: &quot;14d&quot;,</span><br><span class="line">            &quot;value&quot;: &quot;14d&quot;</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;selected&quot;: false,</span><br><span class="line">            &quot;text&quot;: &quot;30d&quot;,</span><br><span class="line">            &quot;value&quot;: &quot;30d&quot;</span><br><span class="line">          &#125;</span><br><span class="line">        ],</span><br><span class="line">        &quot;query&quot;: &quot;1m,10m,30m,1h,6h,12h,1d,7d,14d,30d&quot;,</span><br><span class="line">        &quot;refresh&quot;: 2,</span><br><span class="line">        &quot;type&quot;: &quot;interval&quot;</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        &quot;allValue&quot;: null,</span><br><span class="line">        &quot;current&quot;: &#123;</span><br><span class="line">          &quot;text&quot;: &quot;ocata-ceph&quot;,</span><br><span class="line">          &quot;value&quot;: &quot;ocata-ceph&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;datasource&quot;: &quot;prometheus&quot;,</span><br><span class="line">        &quot;hide&quot;: 0,</span><br><span class="line">        &quot;includeAll&quot;: false,</span><br><span class="line">        &quot;label&quot;: &quot;exporter&quot;,</span><br><span class="line">        &quot;multi&quot;: false,</span><br><span class="line">        &quot;name&quot;: &quot;export&quot;,</span><br><span class="line">        &quot;options&quot;: [],</span><br><span class="line">        &quot;query&quot;: &quot;label_values(ceph_health_status, job)&quot;,</span><br><span class="line">        &quot;refresh&quot;: 1,</span><br><span class="line">        &quot;regex&quot;: &quot;&quot;,</span><br><span class="line">        &quot;sort&quot;: 0,</span><br><span class="line">        &quot;tagValuesQuery&quot;: &quot;&quot;,</span><br><span class="line">        &quot;tags&quot;: [],</span><br><span class="line">        &quot;tagsQuery&quot;: &quot;&quot;,</span><br><span class="line">        &quot;type&quot;: &quot;query&quot;,</span><br><span class="line">        &quot;useTags&quot;: false</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        &quot;allValue&quot;: null,</span><br><span class="line">        &quot;current&quot;: &#123;</span><br><span class="line">          &quot;text&quot;: &quot;instances&quot;,</span><br><span class="line">          &quot;value&quot;: &quot;instances&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;datasource&quot;: &quot;prometheus&quot;,</span><br><span class="line">        &quot;hide&quot;: 0,</span><br><span class="line">        &quot;includeAll&quot;: false,</span><br><span class="line">        &quot;label&quot;: &quot;Pool&quot;,</span><br><span class="line">        &quot;multi&quot;: false,</span><br><span class="line">        &quot;name&quot;: &quot;pool&quot;,</span><br><span class="line">        &quot;options&quot;: [],</span><br><span class="line">        &quot;query&quot;: &quot;label_values(ceph_pool_objects_total&#123;job=\&quot;$export\&quot;&#125;, pool)&quot;,</span><br><span class="line">        &quot;refresh&quot;: 1,</span><br><span class="line">        &quot;regex&quot;: &quot;&quot;,</span><br><span class="line">        &quot;sort&quot;: 0,</span><br><span class="line">        &quot;tagValuesQuery&quot;: &quot;&quot;,</span><br><span class="line">        &quot;tags&quot;: [],</span><br><span class="line">        &quot;tagsQuery&quot;: &quot;&quot;,</span><br><span class="line">        &quot;type&quot;: &quot;query&quot;,</span><br><span class="line">        &quot;useTags&quot;: false</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;time&quot;: &#123;</span><br><span class="line">    &quot;from&quot;: &quot;now-1h&quot;,</span><br><span class="line">    &quot;to&quot;: &quot;now&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;timepicker&quot;: &#123;</span><br><span class="line">    &quot;refresh_intervals&quot;: [</span><br><span class="line">      &quot;5s&quot;,</span><br><span class="line">      &quot;10s&quot;,</span><br><span class="line">      &quot;30s&quot;,</span><br><span class="line">      &quot;1m&quot;,</span><br><span class="line">      &quot;5m&quot;,</span><br><span class="line">      &quot;15m&quot;,</span><br><span class="line">      &quot;30m&quot;,</span><br><span class="line">      &quot;1h&quot;,</span><br><span class="line">      &quot;2h&quot;,</span><br><span class="line">      &quot;1d&quot;</span><br><span class="line">    ],</span><br><span class="line">    &quot;time_options&quot;: [</span><br><span class="line">      &quot;5m&quot;,</span><br><span class="line">      &quot;15m&quot;,</span><br><span class="line">      &quot;1h&quot;,</span><br><span class="line">      &quot;6h&quot;,</span><br><span class="line">      &quot;12h&quot;,</span><br><span class="line">      &quot;24h&quot;,</span><br><span class="line">      &quot;2d&quot;,</span><br><span class="line">      &quot;7d&quot;,</span><br><span class="line">      &quot;30d&quot;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;timezone&quot;: &quot;browser&quot;,</span><br><span class="line">  &quot;title&quot;: &quot;Ceph - Pools&quot;,</span><br><span class="line">  &quot;version&quot;: 8</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;安装ceph-exporter&quot;&gt;&lt;a href=&quot;#安装ceph-exporter&quot; class=&quot;headerlink&quot; title=&quot;安装ceph_exporter&quot;&gt;&lt;/a&gt;安装ceph_exporter&lt;/h1&gt;&lt;figure class=&quot;highli
      
    
    </summary>
    
      <category term="k8s" scheme="https://shenshengkun.github.io/categories/k8s/"/>
    
    
  </entry>
  
  <entry>
    <title>k8s上用ceph-rbd存储</title>
    <link href="https://shenshengkun.github.io/posts/0ijfj445.html"/>
    <id>https://shenshengkun.github.io/posts/0ijfj445.html</id>
    <published>2019-07-19T02:10:01.000Z</published>
    <updated>2019-07-19T03:29:49.676Z</updated>
    
    <content type="html"><![CDATA[<p>k8s默认使用的本地存储，集群容灾性差，ceph作为开源的分布式存储系统，与openstack环境搭配使用，已经很多云计算公司运用于生产环境，可靠性得到验证。这里介绍一下在k8s环境下ceph如何使用. </p><p>Kubernetes支持后两种存储接口,支持的接入模式如下图: </p><p><img src="https://shenshengkun.github.io/images/k8s-ceph1.png" alt=""></p><h1 id="ceph端"><a href="#ceph端" class="headerlink" title="ceph端"></a>ceph端</h1><h2 id="新建pool"><a href="#新建pool" class="headerlink" title="新建pool"></a>新建pool</h2><p>新建一个pool pool_1包含90个pg </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ceph osd pool create pool_1 90</span><br></pre></td></tr></table></figure><h2 id="RBD块设备"><a href="#RBD块设备" class="headerlink" title="RBD块设备"></a>RBD块设备</h2><p>在ceph集群中新建1个rbd块设备，lun1 </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rbd create pool_1/lun1 --size 10G</span><br></pre></td></tr></table></figure><h2 id="ceph权限控制"><a href="#ceph权限控制" class="headerlink" title="ceph权限控制"></a>ceph权限控制</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">使用ceph-deploy --overwrite-conf admin部署的keyring权限太大，可以自己创建一个keyring client.rdb给块设备客户端node用</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># ceph auth get-or-create client.rbd mon &apos;allow r&apos; osd &apos;allow class-read object_prefix rbd_children, allow rwx pool=pool_1&apos;  &gt; ceph.client.rbd.keyring</span><br><span class="line"></span><br><span class="line">k8s节点需要安装ceph</span><br><span class="line">yum install ceph-common</span><br><span class="line">echo &apos;rbd&apos; &gt; /etc/modules-load.d/rbd.conf</span><br><span class="line">modprobe rbd</span><br><span class="line">lsmod | grep rbd</span><br><span class="line">rbd                    83640  0 </span><br><span class="line">libceph               306625  1 rbd</span><br><span class="line"></span><br><span class="line">配置文件秘钥传到k8s上</span><br><span class="line">[root@ceph ceph]# scp ceph.client.rbd.keyring 192.168.6.102:/etc/ceph/</span><br><span class="line">root@192.168.6.102&apos;s password: </span><br><span class="line">ceph.client.rdb.keyring                                                                                                       100%   63     8.5KB/s   00:00    </span><br><span class="line">[root@ceph ceph]# scp ceph.conf 192.168.6.102:/etc/ceph/                </span><br><span class="line">root@192.168.6.102&apos;s password: </span><br><span class="line">ceph.conf                                                                                                                       100%  310    25.1KB/s   00:00    </span><br><span class="line">[root@ceph ceph]#</span><br></pre></td></tr></table></figure><h1 id="k8s的node上操作"><a href="#k8s的node上操作" class="headerlink" title="k8s的node上操作"></a>k8s的node上操作</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">[root@node1 ceph]# ceph -s --name client.rdb</span><br><span class="line">  cluster:</span><br><span class="line">    id:     cbc04385-1cdf-4512-a3f5-a5b3e8686a05</span><br><span class="line">    health: HEALTH_WARN</span><br><span class="line">            application not enabled on 1 pool(s)</span><br><span class="line"> </span><br><span class="line">  services:</span><br><span class="line">    mon: 1 daemons, quorum ceph</span><br><span class="line">    mgr: ceph(active)</span><br><span class="line">    osd: 1 osds: 1 up, 1 in</span><br><span class="line"> </span><br><span class="line">  data:</span><br><span class="line">    pools:   1 pools, 90 pgs</span><br><span class="line">    objects: 5 objects, 709B</span><br><span class="line">    usage:   1.00GiB used, 19.0GiB / 20.0GiB avail</span><br><span class="line">    pgs:     90 active+clean</span><br><span class="line">    </span><br><span class="line">警告解决办法：</span><br><span class="line">ceph health detail</span><br><span class="line">ceph osd pool application enable pool_1 rbd</span><br></pre></td></tr></table></figure><h2 id="map设备"><a href="#map设备" class="headerlink" title="map设备"></a>map设备</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># rbd map pool_1/lun1 --name client.rbd</span><br><span class="line">rbd: sysfs write failed</span><br><span class="line">RBD image feature set mismatch. Try disabling features unsupported by the kernel with &quot;rbd feature disable&quot;.</span><br><span class="line">In some cases useful info is found in syslog - try &quot;dmesg | tail&quot;.</span><br><span class="line">rbd: map failed: (6) No such device or address</span><br><span class="line"></span><br><span class="line">解决办法：</span><br><span class="line">在ceph节点上</span><br><span class="line">rbd feature disable pool_1/lun1 exclusive-lock, object-map, fast-diff, deep-flatten</span><br></pre></td></tr></table></figure><h2 id="将块设备挂载在操作系统中进行格式化"><a href="#将块设备挂载在操作系统中进行格式化" class="headerlink" title="将块设备挂载在操作系统中进行格式化"></a>将块设备挂载在操作系统中进行格式化</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rbd map pool_1/lun1 --name client.rbd</span><br><span class="line">mkfs.ext4 /dev/rbd0</span><br></pre></td></tr></table></figure><h2 id="创建pv、pvc"><a href="#创建pv、pvc" class="headerlink" title="创建pv、pvc"></a>创建pv、pvc</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">对ceph.client.admin.keyring 的内容进行base64编码</span><br><span class="line">[root@node1 ceph]# ceph auth get-key client.rbd | base64</span><br><span class="line">QVFCTktERmRzeXpKQUJBQVVvVGVvWVYyamxhRi8zNU1hZ2R2dFE9PQ==</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">根据上面的输出，创建secret ceph-client-rbd</span><br><span class="line">[root@node1 ceph]# cat ceph-secret.yml </span><br><span class="line">apiVersion: v1</span><br><span class="line">kind: Secret</span><br><span class="line">metadata:</span><br><span class="line">  name: ceph-client-rbd</span><br><span class="line">type: &quot;kubernetes.io/rbd&quot;  </span><br><span class="line">data:</span><br><span class="line">  key: QVFCTktERmRzeXpKQUJBQVVvVGVvWVYyamxhRi8zNU1hZ2R2dFE9PQ==</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">kubectl apply -f ceph-secret.yml</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">创建pv，注意： 这里是user：rbd 而不是user: client.rbd</span><br><span class="line"></span><br><span class="line">[root@node1 ceph]# cat pv.yml </span><br><span class="line">kind: PersistentVolume</span><br><span class="line">apiVersion: v1</span><br><span class="line">metadata:</span><br><span class="line">  name: ceph-pool1-lun1</span><br><span class="line">spec:</span><br><span class="line">  storageClassName: manual</span><br><span class="line">  capacity:</span><br><span class="line">    storage: 10Gi</span><br><span class="line">  accessModes:</span><br><span class="line">    - ReadWriteOnce          </span><br><span class="line">  rbd:</span><br><span class="line">    fsType: ext4</span><br><span class="line">    image: lun1</span><br><span class="line">    monitors:</span><br><span class="line">      - &apos;192.168.6.101:6789&apos;</span><br><span class="line">    pool: pool_1</span><br><span class="line">    readOnly: false</span><br><span class="line">    secretRef:</span><br><span class="line">      name: ceph-client-rbd</span><br><span class="line">      namespace: default</span><br><span class="line">    user: rbd</span><br><span class="line">    </span><br><span class="line">[root@node1 ceph]# kubectl apply -f pv.yml </span><br><span class="line">persistentvolume/ceph-pool1-lun1 created</span><br><span class="line">[root@node1 ceph]# kubectl get pv</span><br><span class="line">NAME              CAPACITY   ACCESS MODES   RECLAIM POLICY   STATUS      CLAIM   STORAGECLASS   REASON   AGE</span><br><span class="line">ceph-pool1-lun1   10Gi       RWO            Retain           Available           manual                  4s</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">创建pvc</span><br><span class="line"></span><br><span class="line">[root@node1 ceph]# cat pvc.yml </span><br><span class="line">kind: PersistentVolumeClaim</span><br><span class="line">apiVersion: v1</span><br><span class="line">metadata:</span><br><span class="line">  name: pvc1</span><br><span class="line">spec:</span><br><span class="line">  storageClassName: manual</span><br><span class="line">  accessModes:</span><br><span class="line">    - ReadWriteOnce</span><br><span class="line">  resources:</span><br><span class="line">    requests:</span><br><span class="line">      storage: 10Gi</span><br><span class="line">      </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">[root@node1 ceph]# kubectl apply -f pvc.yml </span><br><span class="line">persistentvolumeclaim/pvc1 created</span><br><span class="line">[root@node1 ceph]# kubectl get pvc</span><br><span class="line">NAME   STATUS   VOLUME            CAPACITY   ACCESS MODES   STORAGECLASS   AGE</span><br><span class="line">pvc1   Bound    ceph-pool1-lun1   10Gi       RWO            manual         7s</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;k8s默认使用的本地存储，集群容灾性差，ceph作为开源的分布式存储系统，与openstack环境搭配使用，已经很多云计算公司运用于生产环境，可靠性得到验证。这里介绍一下在k8s环境下ceph如何使用. &lt;/p&gt;
&lt;p&gt;Kubernetes支持后两种存储接口,支持的接入模式
      
    
    </summary>
    
      <category term="ceph" scheme="https://shenshengkun.github.io/categories/ceph/"/>
    
    
  </entry>
  
  <entry>
    <title>ceph对象存储集群部署</title>
    <link href="https://shenshengkun.github.io/posts/ouy564tra.html"/>
    <id>https://shenshengkun.github.io/posts/ouy564tra.html</id>
    <published>2019-07-17T07:17:01.000Z</published>
    <updated>2019-07-17T07:38:00.175Z</updated>
    
    <content type="html"><![CDATA[<h1 id="集群架构"><a href="#集群架构" class="headerlink" title="集群架构"></a>集群架构</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">192.168.10.186   ceph1          admin、mon、mgr、osd、rgw</span><br><span class="line"></span><br><span class="line">192.168.10.187   ceph2          mon、mgr、osd、rgw </span><br><span class="line"></span><br><span class="line">192.168.10.188   ceph3          mon、mgr、osd、rgw</span><br></pre></td></tr></table></figure><h1 id="部署"><a href="#部署" class="headerlink" title="部署"></a>部署</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">[root@10dot186 ~]# vim /etc/hosts</span><br><span class="line">192.168.10.186   ceph1</span><br><span class="line">192.168.10.187   ceph2</span><br><span class="line">192.168.10.188   ceph3</span><br><span class="line"></span><br><span class="line">hostnamectl set-hostname ceph1</span><br><span class="line">hostnamectl set-hostname ceph2</span><br><span class="line">hostnamectl set-hostname ceph3</span><br><span class="line"></span><br><span class="line">ntpdate ntp1.aliyun.com</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ssh-keygen</span><br><span class="line">ssh-copy-id ceph1</span><br><span class="line">ssh-copy-id ceph2</span><br><span class="line">ssh-copy-id ceph3</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@ceph1 ~]# vim /etc/yum.repos.d/ceph.repo</span><br><span class="line">[ceph]</span><br><span class="line">name=Ceph packages for $basearch</span><br><span class="line">baseurl=http://mirrors.aliyun.com/ceph/rpm-luminous/el7/$basearch</span><br><span class="line">enabled=1</span><br><span class="line">gpgcheck=1</span><br><span class="line">priority=1</span><br><span class="line">type=rpm-md</span><br><span class="line">gpgkey=https://mirrors.aliyun.com/ceph/keys/release.asc</span><br><span class="line"></span><br><span class="line">[ceph-noarch]</span><br><span class="line">name=Ceph noarch packages</span><br><span class="line">baseurl=http://mirrors.aliyun.com/ceph/rpm-luminous/el7/noarch</span><br><span class="line">enabled=1</span><br><span class="line">gpgcheck=1</span><br><span class="line">priority=1</span><br><span class="line">type=rpm-md</span><br><span class="line">gpgkey=https://mirrors.aliyun.com/ceph/keys/release.asc</span><br><span class="line"></span><br><span class="line">[ceph-source]</span><br><span class="line">name=Ceph source packages</span><br><span class="line">baseurl=http://mirrors.aliyun.com/ceph/rpm-luminous/el7/SRPMS</span><br><span class="line">enabled=0</span><br><span class="line">gpgcheck=1</span><br><span class="line">type=rpm-md</span><br><span class="line">gpgkey=https://mirrors.aliyun.com/ceph/keys/release.asc</span><br><span class="line">priority=1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">yum install -y https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm</span><br><span class="line">yum makecache</span><br><span class="line">yum update -y</span><br><span class="line">yum install -y ceph-deploy</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mkdir /etc/ceph &amp;&amp; cd /etc/ceph</span><br><span class="line">ceph-deploy new ceph1  ceph2 ceph3</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">yum install -y python-setuptools</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">在配置文件中增加：</span><br><span class="line">osd_pool_default_size = 3</span><br><span class="line">[mgr]</span><br><span class="line">mgr modules = dashboard</span><br><span class="line">[mon]</span><br><span class="line">mon allow pool delete = true</span><br></pre></td></tr></table></figure><h2 id="mon"><a href="#mon" class="headerlink" title="mon"></a>mon</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">ceph-deploy install ceph1 ceph2 ceph3</span><br><span class="line"></span><br><span class="line">ceph-deploy mon create-initial</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@ceph1 ceph]# ceph -s</span><br><span class="line">  cluster:</span><br><span class="line">    id:     fcb2fa5e-481a-4494-9a27-374048f37113</span><br><span class="line">    health: HEALTH_OK</span><br><span class="line"> </span><br><span class="line">  services:</span><br><span class="line">    mon: 3 daemons, quorum ceph1,ceph2,ceph3</span><br><span class="line">    mgr: no daemons active</span><br><span class="line">    osd: 0 osds: 0 up, 0 in</span><br><span class="line"> </span><br><span class="line">  data:</span><br><span class="line">    pools:   0 pools, 0 pgs</span><br><span class="line">    objects: 0 objects, 0B</span><br><span class="line">    usage:   0B used, 0B / 0B avail</span><br><span class="line">    pgs:</span><br></pre></td></tr></table></figure><h2 id="mgr"><a href="#mgr" class="headerlink" title="mgr"></a>mgr</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br></pre></td><td class="code"><pre><span class="line">ceph-deploy mgr create ceph1 ceph2 ceph3</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@ceph1 ceph]# ceph -s</span><br><span class="line">  cluster:</span><br><span class="line">    id:     fcb2fa5e-481a-4494-9a27-374048f37113</span><br><span class="line">    health: HEALTH_OK</span><br><span class="line"> </span><br><span class="line">  services:</span><br><span class="line">    mon: 3 daemons, quorum ceph1,ceph2,ceph3</span><br><span class="line">    mgr: ceph1(active), standbys: ceph2, ceph3</span><br><span class="line">    osd: 0 osds: 0 up, 0 in</span><br><span class="line"> </span><br><span class="line">  data:</span><br><span class="line">    pools:   0 pools, 0 pgs</span><br><span class="line">    objects: 0 objects, 0B</span><br><span class="line">    usage:   0B used, 0B / 0B avail</span><br><span class="line">    pgs: </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@ceph1 ceph]# ceph mgr dump</span><br><span class="line">&#123;</span><br><span class="line">    &quot;epoch&quot;: 4,</span><br><span class="line">    &quot;active_gid&quot;: 4122,</span><br><span class="line">    &quot;active_name&quot;: &quot;ceph1&quot;,</span><br><span class="line">    &quot;active_addr&quot;: &quot;192.168.10.186:6800/22316&quot;,</span><br><span class="line">    &quot;available&quot;: true,</span><br><span class="line">    &quot;standbys&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;gid&quot;: 4129,</span><br><span class="line">            &quot;name&quot;: &quot;ceph2&quot;,</span><br><span class="line">            &quot;available_modules&quot;: [</span><br><span class="line">                &quot;balancer&quot;,</span><br><span class="line">                &quot;dashboard&quot;,</span><br><span class="line">                &quot;influx&quot;,</span><br><span class="line">                &quot;localpool&quot;,</span><br><span class="line">                &quot;prometheus&quot;,</span><br><span class="line">                &quot;restful&quot;,</span><br><span class="line">                &quot;selftest&quot;,</span><br><span class="line">                &quot;status&quot;,</span><br><span class="line">                &quot;zabbix&quot;</span><br><span class="line">            ]</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;gid&quot;: 4132,</span><br><span class="line">            &quot;name&quot;: &quot;ceph3&quot;,</span><br><span class="line">            &quot;available_modules&quot;: [</span><br><span class="line">                &quot;balancer&quot;,</span><br><span class="line">                &quot;dashboard&quot;,</span><br><span class="line">                &quot;influx&quot;,</span><br><span class="line">                &quot;localpool&quot;,</span><br><span class="line">                &quot;prometheus&quot;,</span><br><span class="line">                &quot;restful&quot;,</span><br><span class="line">                &quot;selftest&quot;,</span><br><span class="line">                &quot;status&quot;,</span><br><span class="line">                &quot;zabbix&quot;</span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line">    ],</span><br><span class="line">    &quot;modules&quot;: [</span><br><span class="line">        &quot;balancer&quot;,</span><br><span class="line">        &quot;restful&quot;,</span><br><span class="line">        &quot;status&quot;</span><br><span class="line">    ],</span><br><span class="line">    &quot;available_modules&quot;: [</span><br><span class="line">        &quot;balancer&quot;,</span><br><span class="line">        &quot;dashboard&quot;,</span><br><span class="line">        &quot;influx&quot;,</span><br><span class="line">        &quot;localpool&quot;,</span><br><span class="line">        &quot;prometheus&quot;,</span><br><span class="line">        &quot;restful&quot;,</span><br><span class="line">        &quot;selftest&quot;,</span><br><span class="line">        &quot;status&quot;,</span><br><span class="line">        &quot;zabbix&quot;</span><br><span class="line">    ],</span><br><span class="line">    &quot;services&quot;: &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line">[root@ceph1 ceph]# ceph mgr module enable dashboard</span><br><span class="line">[root@ceph1 ceph]# ceph mgr dump</span><br><span class="line">&#123;</span><br><span class="line">    &quot;epoch&quot;: 7,</span><br><span class="line">    &quot;active_gid&quot;: 4139,</span><br><span class="line">    &quot;active_name&quot;: &quot;ceph1&quot;,</span><br><span class="line">    &quot;active_addr&quot;: &quot;192.168.10.186:6800/22316&quot;,</span><br><span class="line">    &quot;available&quot;: true,</span><br><span class="line">    &quot;standbys&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;gid&quot;: 4136,</span><br><span class="line">            &quot;name&quot;: &quot;ceph3&quot;,</span><br><span class="line">            &quot;available_modules&quot;: [</span><br><span class="line">                &quot;balancer&quot;,</span><br><span class="line">                &quot;dashboard&quot;,</span><br><span class="line">                &quot;influx&quot;,</span><br><span class="line">                &quot;localpool&quot;,</span><br><span class="line">                &quot;prometheus&quot;,</span><br><span class="line">                &quot;restful&quot;,</span><br><span class="line">                &quot;selftest&quot;,</span><br><span class="line">                &quot;status&quot;,</span><br><span class="line">                &quot;zabbix&quot;</span><br><span class="line">            ]</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;gid&quot;: 4141,</span><br><span class="line">            &quot;name&quot;: &quot;ceph2&quot;,</span><br><span class="line">            &quot;available_modules&quot;: [</span><br><span class="line">                &quot;balancer&quot;,</span><br><span class="line">                &quot;dashboard&quot;,</span><br><span class="line">                &quot;influx&quot;,</span><br><span class="line">                &quot;localpool&quot;,</span><br><span class="line">                &quot;prometheus&quot;,</span><br><span class="line">                &quot;restful&quot;,</span><br><span class="line">                &quot;selftest&quot;,</span><br><span class="line">                &quot;status&quot;,</span><br><span class="line">                &quot;zabbix&quot;</span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line">    ],</span><br><span class="line">    &quot;modules&quot;: [</span><br><span class="line">        &quot;balancer&quot;,</span><br><span class="line">        &quot;dashboard&quot;,</span><br><span class="line">        &quot;restful&quot;,</span><br><span class="line">        &quot;status&quot;</span><br><span class="line">    ],</span><br><span class="line">    &quot;available_modules&quot;: [</span><br><span class="line">        &quot;balancer&quot;,</span><br><span class="line">        &quot;dashboard&quot;,</span><br><span class="line">        &quot;influx&quot;,</span><br><span class="line">        &quot;localpool&quot;,</span><br><span class="line">        &quot;prometheus&quot;,</span><br><span class="line">        &quot;restful&quot;,</span><br><span class="line">        &quot;selftest&quot;,</span><br><span class="line">        &quot;status&quot;,</span><br><span class="line">        &quot;zabbix&quot;</span><br><span class="line">    ],</span><br><span class="line">    &quot;services&quot;: &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@ceph1 ceph]# ceph config-key put mgr/dashboard/server_addr 192.168.6.101</span><br><span class="line">set mgr/dashboard/server_addr</span><br><span class="line">[root@ceph1 ceph]# ceph config-key put mgr/dashboard/server_port 7000</span><br><span class="line">set mgr/dashboard/server_port</span><br><span class="line">[root@ceph1 ~]# netstat -tulnp |grep 7000</span><br><span class="line">tcp        0      0 192.168.6.101:7000      0.0.0.0:*               LISTEN      19836/ceph-mgr</span><br></pre></td></tr></table></figure><p>这时看下danshboard图：</p><p><img src="https://shenshengkun.github.io/images/dash_cluster1.png" alt=""></p><h2 id="osd"><a href="#osd" class="headerlink" title="osd"></a>osd</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">每台机器做逻辑卷</span><br><span class="line">[root@ceph1 ceph]# pvcreate /dev/sdb</span><br><span class="line">  Physical volume &quot;/dev/sdb&quot; successfully created.</span><br><span class="line"></span><br><span class="line">[root@ceph1 ceph]# vgcreate data_vg1 /dev/sdb</span><br><span class="line">  Volume group &quot;data_vg1&quot; successfully created</span><br><span class="line">  </span><br><span class="line">[root@ceph1 ceph]# lvcreate -n data_lv1 -L 99g data_vg1   </span><br><span class="line">  Logical volume &quot;data_lv1&quot; created.</span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ceph-deploy osd create ceph1 --data data_vg1/data_lv1</span><br><span class="line">ceph-deploy osd create ceph2 --data data_vg1/data_lv1</span><br><span class="line">ceph-deploy osd create ceph3 --data data_vg1/data_lv1</span><br><span class="line"></span><br><span class="line">[root@ceph1 ceph]# ceph -s</span><br><span class="line">  cluster:</span><br><span class="line">    id:     fcb2fa5e-481a-4494-9a27-374048f37113</span><br><span class="line">    health: HEALTH_OK</span><br><span class="line"> </span><br><span class="line">  services:</span><br><span class="line">    mon: 3 daemons, quorum ceph1,ceph2,ceph3</span><br><span class="line">    mgr: ceph1(active), standbys: ceph3, ceph2</span><br><span class="line">    osd: 3 osds: 3 up, 3 in</span><br><span class="line"> </span><br><span class="line">  data:</span><br><span class="line">    pools:   0 pools, 0 pgs</span><br><span class="line">    objects: 0 objects, 0B</span><br><span class="line">    usage:   3.01GiB used, 294GiB / 297GiB avail</span><br><span class="line">    pgs:</span><br></pre></td></tr></table></figure><p>这时看下danshboard图：</p><p><img src="https://shenshengkun.github.io/images/dash_cluster2.png" alt=""></p><h2 id="rgw集群"><a href="#rgw集群" class="headerlink" title="rgw集群"></a>rgw集群</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">ceph-deploy install --rgw ceph1 ceph2 ceph3</span><br><span class="line"></span><br><span class="line">ceph-deploy admin ceph1 ceph2 ceph3</span><br><span class="line"></span><br><span class="line">ceph-deploy rgw create ceph1 ceph2 ceph3</span><br><span class="line"></span><br><span class="line">[root@ceph1 ceph]# ceph -s</span><br><span class="line">  cluster:</span><br><span class="line">    id:     fcb2fa5e-481a-4494-9a27-374048f37113</span><br><span class="line">    health: HEALTH_OK</span><br><span class="line"> </span><br><span class="line">  services:</span><br><span class="line">    mon: 3 daemons, quorum ceph1,ceph2,ceph3</span><br><span class="line">    mgr: ceph1(active), standbys: ceph3, ceph2</span><br><span class="line">    osd: 3 osds: 3 up, 3 in</span><br><span class="line">    rgw: 3 daemons active</span><br><span class="line"> </span><br><span class="line">  data:</span><br><span class="line">    pools:   4 pools, 32 pgs</span><br><span class="line">    objects: 191 objects, 3.08KiB</span><br><span class="line">    usage:   3.01GiB used, 294GiB / 297GiB avail</span><br><span class="line">    pgs:     32 active+clean</span><br></pre></td></tr></table></figure><p>这时看下danshboard图：</p><p><img src="https://shenshengkun.github.io/images/dash_cluster3.png" alt=""></p><h2 id="NGINX代理"><a href="#NGINX代理" class="headerlink" title="NGINX代理"></a>NGINX代理</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">安装这里就不介绍了</span><br><span class="line"></span><br><span class="line">[root@ceph1 conf.d]# cat cephcloud.dev.goago.cn.conf </span><br><span class="line">        upstream cephcloud.dev.goago.cn  &#123;</span><br><span class="line">        server  192.168.10.186:7480;</span><br><span class="line">        server  192.168.10.187:7480;</span><br><span class="line">        server  192.168.10.188:7480;        </span><br><span class="line">        &#125;</span><br><span class="line">        server &#123;</span><br><span class="line">        listen       80;</span><br><span class="line">        server_name  cephcloud.dev.goago.cn;</span><br><span class="line">        location / &#123;</span><br><span class="line">                        proxy_intercept_errors on;</span><br><span class="line">                        access_log /var/log/nginx/cephcloud_log;</span><br><span class="line">                        proxy_pass http://cephcloud.dev.goago.cn;</span><br><span class="line">                        proxy_set_header X-Real-IP $remote_addr;</span><br><span class="line">                        proxy_set_header Host $host;</span><br><span class="line">                        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class="line">                        proxy_set_header Request_Uri $request_uri;</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure><h2 id="s3和swift"><a href="#s3和swift" class="headerlink" title="s3和swift"></a>s3和swift</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">具体安装这里不叙述了，可以看我上篇文章</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">New settings:</span><br><span class="line">  Access Key: M954JYYAOBES65B7UNEZ</span><br><span class="line">  Secret Key: 11MZu3N9vB4S4C4N8U2Ywgkhxro3Xi6K9HPyRQ9v</span><br><span class="line">  Default Region: US</span><br><span class="line">  S3 Endpoint: cephcloud.dev.goago.cn</span><br><span class="line">  DNS-style bucket+hostname:port template for accessing a bucket: %(bucket)s.cephcloud.dev.goago.cn bucket</span><br><span class="line">  Encryption password: 123456</span><br><span class="line">  Path to GPG program: /usr/bin/gpg</span><br><span class="line">  Use HTTPS protocol: False</span><br><span class="line">  HTTP Proxy server name: </span><br><span class="line">  HTTP Proxy server port: 0</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;集群架构&quot;&gt;&lt;a href=&quot;#集群架构&quot; class=&quot;headerlink&quot; title=&quot;集群架构&quot;&gt;&lt;/a&gt;集群架构&lt;/h1&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pr
      
    
    </summary>
    
      <category term="ceph" scheme="https://shenshengkun.github.io/categories/ceph/"/>
    
    
  </entry>
  
  <entry>
    <title>ceph-luminous-bluestore</title>
    <link href="https://shenshengkun.github.io/posts/78fhjj54.html"/>
    <id>https://shenshengkun.github.io/posts/78fhjj54.html</id>
    <published>2019-07-16T09:10:01.000Z</published>
    <updated>2019-07-16T06:04:17.585Z</updated>
    
    <content type="html"><![CDATA[<h1 id="对比"><a href="#对比" class="headerlink" title="对比"></a>对比</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">ceph后端支持多种存储引擎，以插件化的形式来进行管理使用，目前支持filestore，kvstore，memstore以及bluestore</span><br><span class="line"></span><br><span class="line">1）Firestore存在的问题是：</span><br><span class="line">在写数据前需要先写journal，会有一倍的写放大；</span><br><span class="line">若是另外配备SSD盘给journal使用又增加额外的成本；</span><br><span class="line">filestore一开始只是对于SATA/SAS这一类机械盘进行设计的，没有专门针对SSD这一类的Flash介质盘做考虑。</span><br><span class="line"></span><br><span class="line">2）而Bluestore的优势在于：</span><br><span class="line">减少写放大；</span><br><span class="line">针对FLASH介质盘做优化；</span><br><span class="line">直接管理裸盘，进一步减少文件系统部分的开销。</span><br></pre></td></tr></table></figure><h1 id="Bluestore原理说明"><a href="#Bluestore原理说明" class="headerlink" title="Bluestore原理说明"></a>Bluestore原理说明</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">对象可以直接存放在裸盘上，不需要任何文件系统接口。</span><br><span class="line">BlueStore 直接使用一个原始分区，ceph对象将直接写在块设备上，不再需要任何的文件系统；</span><br><span class="line">和osd一起进来的元数据将存储在 一个 名为 RocksDB 的键值对 数据库；</span><br></pre></td></tr></table></figure><h2 id="各层意义"><a href="#各层意义" class="headerlink" title="各层意义"></a>各层意义</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">RocksDB ：存储 WAL 日志和元数据（omap）</span><br><span class="line">BlueRocksEnv: 与RocksDB 交互的接口</span><br><span class="line">BlueFS： 一个类似文件系统的 mini C++，使 rocksdb 生效，ENv 接口（存储 RocksDB 日志和 sst 文件）；</span><br><span class="line">因为rocksdb 一般跑在一个文件系统的上层，所以创建了 BlueFS。</span><br></pre></td></tr></table></figure><h2 id="RocksDB-存放的数据类型"><a href="#RocksDB-存放的数据类型" class="headerlink" title="RocksDB 存放的数据类型"></a>RocksDB 存放的数据类型</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">对象的元数据</span><br><span class="line">write-ahead 日志</span><br><span class="line">ceph omap  数据</span><br><span class="line">allocator metadata(元数据分配器)：决定数据存放位置；此功能可插拔</span><br></pre></td></tr></table></figure><h2 id="默认BlueStore模型"><a href="#默认BlueStore模型" class="headerlink" title="默认BlueStore模型"></a>默认BlueStore模型</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">第一个小分区（XFS或者ext4）,包括ceph files </span><br><span class="line">（init system descriptor,status,id,fsid,keyring 等）和RocksDB 文件</span><br><span class="line">第二个分区是一个原始分区</span><br></pre></td></tr></table></figure><h2 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">每一部分都可以存放在不同的磁盘中，RocksDB WAL 和 DB 可以存放在不同的磁盘或者小分区中</span><br></pre></td></tr></table></figure><h1 id="添加osd"><a href="#添加osd" class="headerlink" title="添加osd"></a>添加osd</h1><h2 id="案例1"><a href="#案例1" class="headerlink" title="案例1"></a>案例1</h2><p>由于Luminous里默认使用Bluestore，可以直接操作裸盘,data和block-db会使用lv。综合成本及性能，我们把block.db使用ssd的分区，osd仍然使用sas，block.wal不指定. 这里vdb作为osd盘，vdc作为block-db盘</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">首先ssh到各个存储节点，block.db使用的ssd分区,这里node1举例：</span><br><span class="line"># ssh node1</span><br><span class="line"># pvcreate /dev/vdb  # 创建pv, 这里使用的整块磁盘(与后面的分区对比),  pvs 查看pv列表</span><br><span class="line">Physical volume &quot;/dev/vdb&quot; successfully created.</span><br><span class="line"># vgcreate data_vg1 /dev/vdb  # 创建vg,  vgs查看vg列表</span><br><span class="line">Volume group &quot;data_vg1&quot; successfully created</span><br><span class="line"># lvcreate -n data_lv1 -L 1020.00m data_vg1 #创建lv,lvs查看lv列表, -n指定lv名称, -L指定lv的大小,需要小于或者等于vg的VSize</span><br><span class="line">Logical volume &quot;data_lv1&quot; created.</span><br><span class="line"></span><br><span class="line">---------------------------------------------</span><br><span class="line">生产环境一块ssd磁盘会对应多块osd，所以这里也需要把ssd多个分区</span><br><span class="line"># parted /dev/vdc </span><br><span class="line">(parted) mklabel gpt                                                      </span><br><span class="line">(parted) mkpart primary 0% 25%   #因为测试，这里只做了一个占据磁盘25%容量的分区，实际情况根据osd数目划分相应的分区数</span><br><span class="line">(parted) quit</span><br><span class="line"># pvcreate /dev/vdc1  # 创建pv, 这里使用的是磁盘分区, pvs 查看pv列表</span><br><span class="line">Physical volume &quot;/dev/vdc1&quot; successfully created.</span><br><span class="line"># vgcreate block_db_vg1 /dev/vdc1  # 创建vg,  vgs查看vg列表</span><br><span class="line">Volume group &quot;block_db_vg1&quot; successfully created</span><br><span class="line"># lvcreate -n block_db_lv1 -L 1020.00m block_db_vg1  # 创建lv, lvs查看lv列表, -L指定lv的大小，需要小于或者等于 vg的VSize</span><br><span class="line">Logical volume &quot;block_db_lv1&quot; created.</span><br><span class="line"></span><br><span class="line">---------------------------------------------</span><br><span class="line"># 不需要加--bluestore 参数，默认就是使用bluestore方式，data_vg1/data_lv1 是数据盘，block_db_vg1/block_db_lv1是block-db</span><br><span class="line">管理节点执行：</span><br><span class="line">ceph-deploy --overwrite-conf osd create node1 --data data_vg1/data_lv1 --block-db block_db_vg1/block_db_lv1</span><br><span class="line">ceph-deploy --overwrite-conf osd create node2 --data data_vg1/data_lv1 --block-db block_db_vg1/block_db_lv1</span><br></pre></td></tr></table></figure><h2 id="案例2"><a href="#案例2" class="headerlink" title="案例2"></a>案例2</h2><p>创建具有3个逻辑卷的OSD（模拟不同类型的存储介质） </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">#pvcreate /dev/sdb</span><br><span class="line">  Physical volume &quot;/dev/sdb&quot; successfully created.</span><br><span class="line">#vgcreate  ceph-pool /dev/sdb</span><br><span class="line">  Volume group &quot;ceph-pool&quot; successfully created</span><br><span class="line">#lvcreate -n osd0.wal -L 1G ceph-pool</span><br><span class="line">  Logical volume &quot;osd0.wal&quot; created.</span><br><span class="line"># lvcreate -n osd0.db -L 1G ceph-pool</span><br><span class="line">  Logical volume &quot;osd0.db&quot; created.</span><br><span class="line"># lvcreate -n osd0 -l 100%FREE ceph-pool</span><br><span class="line">  Logical volume &quot;osd0&quot; created.</span><br></pre></td></tr></table></figure><p>完成逻辑卷的创建后我们就可以创建 OSD 了。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ceph-deploy osd create \</span><br><span class="line">    --data ceph-pool/osd0 \</span><br><span class="line">    --block-db ceph-pool/osd0.db \</span><br><span class="line">    --block-wal ceph-pool/osd0.wal \</span><br><span class="line">    --bluestore node1</span><br></pre></td></tr></table></figure><h2 id="wal-amp-db-的大小问题"><a href="#wal-amp-db-的大小问题" class="headerlink" title="wal&amp; db 的大小问题"></a>wal&amp; db 的大小问题</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">在 ceph bluestore 的情况下，wal 是 RocksDB 的write-ahead log, 相当于之前的 journal 数据，db 是 RocksDB 的metadata 信息。在磁盘选择原则是 block.wal &gt; block.db &gt; block。当然所有的数据也可以放到同一块盘上。</span><br><span class="line">默认情况下， wal 和 db 的大小分别是 512 MB 和 1GB，现在没有一个好的理论值，好像和 ceph 本身承载的数据类型有关系。</span><br><span class="line">值得注意的是，如果所有的数据都在单块盘上，那是没有必要指定 wal &amp;db 的大小的。如果 wal &amp; db 是在不同的盘上，由于 wal/db 一般都会分的比较小，是有满的可能性的。如果满了，这些数据会迁移到下一个快的盘上(wal - db - main)。所以最少不会因为数据满了，而造成无法写入。</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;对比&quot;&gt;&lt;a href=&quot;#对比&quot; class=&quot;headerlink&quot; title=&quot;对比&quot;&gt;&lt;/a&gt;对比&lt;/h1&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span 
      
    
    </summary>
    
      <category term="ceph" scheme="https://shenshengkun.github.io/categories/ceph/"/>
    
    
  </entry>
  
  <entry>
    <title>ceph的pg算法</title>
    <link href="https://shenshengkun.github.io/posts/fd22jkk6.html"/>
    <id>https://shenshengkun.github.io/posts/fd22jkk6.html</id>
    <published>2019-07-11T09:10:01.000Z</published>
    <updated>2019-07-12T09:49:15.127Z</updated>
    
    <content type="html"><![CDATA[<h1 id="PG介绍"><a href="#PG介绍" class="headerlink" title="PG介绍"></a>PG介绍</h1><p>PG, Placement Groups。CRUSH先将数据分解成一组对象，然后根据对象名称、复制级别和系统中的PG数等信息执行散列操作，再将结果生成PG ID。可以将PG看做一个逻辑容器，这个容器包含多个对象，同时这个逻辑对象映射之多个OSD上。<br>如果没有PG，在成千上万个OSD上管理和跟踪数百万计的对象的复制和传播是相当困难的。没有PG这一层，管理海量的对象所消耗的计算资源也是不可想象的。建议每个OSD上配置50~100个PG。</p><h1 id="计算PG数"><a href="#计算PG数" class="headerlink" title="计算PG数"></a>计算PG数</h1><p>官方推荐如下：</p><p><img src="https://shenshengkun.github.io/images/pg1.png" alt=""></p><p>Ceph集群中的PG总数：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PG总数 = (OSD总数 * 100) / 最大副本数</span><br></pre></td></tr></table></figure><p>结果必须舍入到最接近的2的N次方幂的值。</p><p>Ceph集群中每个pool中的PG总数：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">存储池PG总数 = (OSD总数 * 100 / 最大副本数) / 池数</span><br></pre></td></tr></table></figure><p>平衡每个存储池中的PG数和每个OSD中的PG数对于降低OSD的方差、避免速度缓慢的恢复再平衡进程是相当重要的。</p><h1 id="修改PG和PGP"><a href="#修改PG和PGP" class="headerlink" title="修改PG和PGP"></a>修改PG和PGP</h1><p>PGP是为了实现定位而设置的PG，它的值应该和PG的总数(即pg_num)保持一致。对于Ceph的一个pool而言，如果增加pg_num，还应该调整pgp_num为同样的值，这样集群才可以开始再平衡。<br>参数pg_num定义了PG的数量，PG映射至OSD。当任意pool的PG数增加时，PG依然保持和源OSD的映射。直至目前，Ceph还未开始再平衡。此时，增加pgp_num的值，PG才开始从源OSD迁移至其他的OSD，正式开始再平衡。PGP，Placement Groups of Placement。</p><p>获取现有的PG数和PGP数值：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ceph osd pool get data pg_num</span><br><span class="line"></span><br><span class="line">ceph osd pool get data pgp_num</span><br></pre></td></tr></table></figure><p>检查存储池的副本数</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ceph osd dump|grep -i size</span><br></pre></td></tr></table></figure><p>计算pg_num和pgp_num</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># pg_num calculation</span><br><span class="line">pg_num = (num_osds * 100) / num_copies</span><br><span class="line">num_up = pow(2, int(log(pg_num,2) + 0.5))</span><br><span class="line">num_down = pow(2, int(log(pg_num,2)))</span><br><span class="line">if abs(pg_num - num_up) &lt;= abs(pg_num - num_down):</span><br><span class="line">    pg_num = num_up</span><br><span class="line">else:</span><br><span class="line">    pg_num = num_down</span><br><span class="line">pgp_num = pg_num</span><br></pre></td></tr></table></figure><p>修改存储池的PG和PGP</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ceph osd pool set data pg_num </span><br><span class="line"></span><br><span class="line">ceph osd pool set data pgp_num</span><br></pre></td></tr></table></figure><p>例子：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ceph osd pool ls</span><br><span class="line">ceph osd pool set .rgw.root pg_num 16</span><br><span class="line">ceph osd pool set .rgw.root pgp_num 16</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;PG介绍&quot;&gt;&lt;a href=&quot;#PG介绍&quot; class=&quot;headerlink&quot; title=&quot;PG介绍&quot;&gt;&lt;/a&gt;PG介绍&lt;/h1&gt;&lt;p&gt;PG, Placement Groups。CRUSH先将数据分解成一组对象，然后根据对象名称、复制级别和系统中的PG数等信息
      
    
    </summary>
    
      <category term="ceph" scheme="https://shenshengkun.github.io/categories/ceph/"/>
    
    
  </entry>
  
  <entry>
    <title>ceph组件的状态</title>
    <link href="https://shenshengkun.github.io/posts/dsl5646k.html"/>
    <id>https://shenshengkun.github.io/posts/dsl5646k.html</id>
    <published>2019-07-11T05:10:01.000Z</published>
    <updated>2019-07-19T06:11:06.640Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Ceph-整体状态查看"><a href="#Ceph-整体状态查看" class="headerlink" title="Ceph 整体状态查看"></a>Ceph 整体状态查看</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ceph -s  #ceph状态是否正常，及配置运行状态</span><br><span class="line">ceph -w  #实时查看数据写入情况</span><br><span class="line">ceph health detail #如果集群有问题，会详细列出具体的pg或者osd</span><br></pre></td></tr></table></figure><h1 id="mon"><a href="#mon" class="headerlink" title="mon"></a>mon</h1><h2 id="mon相关状态"><a href="#mon相关状态" class="headerlink" title="mon相关状态"></a>mon相关状态</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ceph quorum_status -f json-pretty</span><br></pre></td></tr></table></figure><h2 id="client-无法链接mon的可能原因"><a href="#client-无法链接mon的可能原因" class="headerlink" title="client 无法链接mon的可能原因"></a>client 无法链接mon的可能原因</h2><ol><li>连通性和防火墙规则。在MON主机上修改允许TCP 端口6789的访问。</li><li>磁盘空间。每个MON主机上必须有超过5%的空闲磁盘空间使MON和levelDB数据库正常工作。</li><li>MON没有工作或者离开选举，检查如上命令输出结果中的quorum_status和mon_status或者ceph -s 的输出来确定失败的MON进程，尝试重启或者部署一个新的来替代它。</li></ol><h2 id="MON-状态表"><a href="#MON-状态表" class="headerlink" title="MON 状态表"></a>MON 状态表</h2><table><thead><tr><th>状态</th><th>说明</th></tr></thead><tbody><tr><td>probing</td><td>正在探测态。这意味着MON正在寻找其他的MON。当MON启动时， MON尝试找在monmap定义的其他剩余的MON。在多MON的集群中，直到MON找到足够多的MON构建法定选举人数之前，它一直在这个状态。这意味着如果3个MON中的2个挂掉，剩余的1个MON将一直在probing状态，直到启动其他的MON中的1个为止。</td></tr><tr><td>electing</td><td>正在选举态。这意味着MON正在选举中。这应该很快完成，但有时也会卡在正这，这通常是因为MON主机节点间的时钟偏移导致的.</td></tr><tr><td>synchronizing</td><td>正在同步态。这意味着MON为了加入到法定人数中和集群中其他的MON正在同步.</td></tr><tr><td>leader或peon</td><td>领导态或员工态。这不应该出现。然而有机会出现，一般和时钟偏移有很大关系</td></tr></tbody></table><h3 id="时钟偏移警告"><a href="#时钟偏移警告" class="headerlink" title="时钟偏移警告"></a>时钟偏移警告</h3><p>MON可能被MON节点之间的重要的时钟偏移激烈的影响。这经常会转变为没有明显原因的诡异的行为。为了避免这种问题，应该在MON节点上运行一个时间同步的工具。默认最大容忍的时钟偏移为0.05s，虽然可以修改，但不建议修改，这是官方开发和QA认可的值。私自未经测试修改虽然无数据丢失风险，可能会对MON集群和总体集群健康导致意外的作用。 如果遇到这个告警，同步时钟，在MON上运行NTP的客户端会有帮助。如果经常遇到这个问题，可能是因为使用了远端的NTP服务器，请考虑在内网部署NTP服务器。</p><h1 id="OSD"><a href="#OSD" class="headerlink" title="OSD"></a>OSD</h1><h2 id="OSD-状态表"><a href="#OSD-状态表" class="headerlink" title="OSD 状态表"></a>OSD 状态表</h2><table><thead><tr><th>状态</th><th>说明</th></tr></thead><tbody><tr><td>up</td><td>osd启动</td></tr><tr><td>down</td><td>osd停止</td></tr><tr><td>in</td><td>osd在集群中</td></tr><tr><td>out</td><td>osd不在集群中，默认OSD down 超过300s,Ceph会标记为out，会触发重新平衡操作</td></tr><tr><td>up &amp; in</td><td>说明该OSD正常运行，且已经承载至少一个PG的数据。这是一个OSD的标准工作状态</td></tr><tr><td>up &amp; out</td><td>说明该OSD正常运行，但并未承载任何PG，其中也没有数据。一个新的OSD刚刚被加入Ceph集群后，便会处于这一状态。而一个出现故障的OSD被修复后，重新加入Ceph集群时，也是处于这一状态</td></tr><tr><td>down &amp; in</td><td>说明该OSD发生异常，但仍然承载着至少一个PG，其中仍然存储着数据。这种状态下的OSD刚刚被发现存在异常，可能仍能恢复正常，也可能会彻底无法工作</td></tr><tr><td>down &amp; out</td><td>说明该OSD已经彻底发生故障，且已经不再承载任何PG</td></tr></tbody></table><h2 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h2><ol><li>硬盘失败。可以通过系统日志或SMART活动确认。有些有缺陷的硬盘因为密集的有时限的错误修复活动变的很慢。</li><li>网络连接问题。可以使用ping、iperf等普通网络工具进行调试。</li><li>OSD文件存储的磁盘空间不足。 磁盘到85%将会触发HEALTH_WARN告警。磁盘到95%会触发HEALTH_ERR告警，OSD为了避免填满磁盘会停止。</li><li>超过系统资源限制。系统内存应该足够主机上所有的OSD进程，打开文件句柄数和最大线程数也应该是足够的。<br>OSD进程处理心跳的限制导致进程自杀。默认的处理和通信超时不足以执行IO饥饿型的操作，尤其是失败后的恢复。这经常会导致OSD闪断的现象出现。</li></ol><h2 id="暂时关闭pg重新平衡"><a href="#暂时关闭pg重新平衡" class="headerlink" title="暂时关闭pg重新平衡"></a>暂时关闭pg重新平衡</h2><p>在维护操作或解决问题时，不希望在停止一些OSD后，超时的OSD被标记为out后，CRUSH算法自动进行重新平衡操作。需要执行集群关闭out检测命令：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ceph osd set noout</span><br></pre></td></tr></table></figure><p>这样在停止的OSD中的PG会变为降级态。当维护操作完成后，需要先启动停止的OSD，再恢复默认设置：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ceph osd unset noout</span><br></pre></td></tr></table></figure><h2 id="老-慢-请求"><a href="#老-慢-请求" class="headerlink" title="老/慢 请求"></a>老/慢 请求</h2><p>如果一个OSD服务进程很慢地响应请求。它会产生一个请求耗时过久超过30秒的警告提示信息。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;date&#125; &#123;osd.num&#125; [WRN] 1 slow requests, 1 included below; oldest blocked for &gt; 30.005692 secs</span><br><span class="line">&#123;date&#125; &#123;osd.num&#125;  [WRN] slow request 30.005692 seconds old, received at &#123;date-time&#125;: osd_op(client.4240.0:8 benchmark_data_ceph-1_39426_object7 [write 0~4194304] 0.69848840) v4 currently waiting for subops from [610]</span><br></pre></td></tr></table></figure><ol><li>可能的原因和修复方法包括：</li><li>硬盘故障（检查dmesg的输出信息）；替换为正常的硬盘</li><li>内核文件系统bug（检查dmesg的输出信息确）；升级内核</li><li>集群负载过高（检查系统负载、iostat等）；机器扩容，尝试降低系统负载</li><li>ceph-osd服务进程的的bug；升级ceph或重启OSD</li></ol><h2 id="OSD-闪断"><a href="#OSD-闪断" class="headerlink" title="OSD 闪断"></a>OSD 闪断</h2><p>OSD重启或恢复中后，OSD在peering状态一直闪断。因为IO密集型的任务导致影响心跳检测异常，你可以暂时为集群通过打开nodown noup选项。执行命令：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ceph osd set nodown </span><br><span class="line">ceph osd set noup  </span><br><span class="line">ceph osd set noout</span><br></pre></td></tr></table></figure><p>当集群健康稳定后，执行如下命令恢复默认值：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ceph osd unset nodown  </span><br><span class="line">ceph osd unset noup  </span><br><span class="line">ceph osd unset noout</span><br></pre></td></tr></table></figure><h2 id="确认磁盘损坏"><a href="#确认磁盘损坏" class="headerlink" title="确认磁盘损坏"></a>确认磁盘损坏</h2><p>检查日志，执行如下命令：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">dmesg | egrep sd[a­]</span><br><span class="line">eg:</span><br><span class="line">dmesg |egrep sda</span><br><span class="line"></span><br><span class="line">通过smartctl提取信息和执行测试检查可疑的设备:</span><br><span class="line">smartctl a /dev/sda</span><br><span class="line"></span><br><span class="line">通过观察响应时间确认。任何磁盘持续显示不常见的值可能会失败：</span><br><span class="line">iostat x /dev/sda</span><br></pre></td></tr></table></figure><p>###替换osd数据磁盘<br>当集群规模比较大，磁盘出硬件故障是一个常态。为了维持集群规模稳定，必须及时的修复因硬盘故障停止的OSD。 因为Ceph采用了多个副本的策略，一般情况下，不需要恢复坏掉硬盘的数据。用一个新硬盘初始化一个OSD即可。操作步骤如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">两种情况：</span><br><span class="line">a. 如果磁盘坏掉osd会标记为down，默认300秒osd会被标记为out，数据会开始迁移。所以我们替换osd数据磁盘，确保数据迁移完成，集群状态是ok。</span><br><span class="line">b. 如果磁盘将要损坏，但还没有坏，仍然是up&amp;in的，则需要先把该osd 设置为out: ceph osd out osd.0,这样集群会把osd.0的数据 rebalancing and copying到其他机器上去。直到整个集群编程active+clean，再进行后续操作</span><br><span class="line"></span><br><span class="line">1. 关闭 osd.0的进程</span><br><span class="line">systemctl stop ceph-osd@0</span><br><span class="line"></span><br><span class="line">2. 删除旧osd信息(osd.0为例)：</span><br><span class="line">ceph osd crush remove osd.0</span><br><span class="line">ceph auth del osd.0</span><br><span class="line">ceph osd rm 0</span><br><span class="line"></span><br><span class="line">3. 创建新osd</span><br><span class="line">a. ceph osd create #会自动生成uuid和osd-number</span><br><span class="line">b. ssh &#123;new_osd_host&#125;</span><br><span class="line">c. sudo mkdir /var/lib/ceph/osd/ceph-&#123;osd-number&#125;  #上一步生成的osd-number</span><br><span class="line">d. 分区 通过parted把osd的磁盘分区为一个分区</span><br><span class="line">e. sudo mkfs -t xfs /dev/&#123;drive&#125; # 上一步分区</span><br><span class="line">f. sudo mount /dev/&#123;sdx&#125; /var/lib/ceph/osd/ceph-&#123;osd-number&#125;</span><br><span class="line">g. ceph-osd -i &#123;osd-number&#125; --mkfs --mkkey   # 初始化osd数据目录</span><br><span class="line">目录必须为空</span><br><span class="line">h. ceph auth add osd.&#123;osd-number&#125; osd &apos;allow *&apos; mon &apos;allow rwx&apos; -i /var/lib/ceph/osd/ceph-&#123;osd-number&#125;/keyring #注册认证key</span><br><span class="line">i. ceph osd crush add osd.&#123;osd-number&#125;# 添加osd到crush map，则该osd可以接受数据了，这个时候osd的状态为 down &amp; in。ceph osd crush add osd.0 1.0 host=bj-yh-ceph-node2</span><br><span class="line">j. systemctl start ceph-osd@&#123;osd-number&#125; # 启动osd进程，数据会rebalancing and migrating 到新的osd上</span><br></pre></td></tr></table></figure><h2 id="替换ssd日志磁盘"><a href="#替换ssd日志磁盘" class="headerlink" title="替换ssd日志磁盘"></a>替换ssd日志磁盘</h2><p>由于我们使用过程中，一块ssd分4个区，给4个osd使用，所以如果ssd日志磁盘坏掉，需要给对应的osd都要操作</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">1. 设置OSD状态为noout，防止数据重新平衡</span><br><span class="line">ceph osd set noout</span><br><span class="line"></span><br><span class="line">2. 停止osd进程</span><br><span class="line">ssh &#123;ssd所在节点&#125;</span><br><span class="line">systemctl stop ceph-osd@x  #ssd所对应的osds</span><br><span class="line"></span><br><span class="line">3. 日志数据落盘到数据盘</span><br><span class="line">ceph-osd -i &#123;osd-number&#125; --flush-journal #该ssd日志分区所对应的所有osd-number</span><br><span class="line"></span><br><span class="line">4. 删除日志链接</span><br><span class="line">rm -rf /var/lib/ceph/osd/&#123;osd-number&#125;/journal # #该ssd日志分区所对应的所有osd-number</span><br><span class="line"></span><br><span class="line">5. 创建日志链接</span><br><span class="line">ln -s /dev/disk/by-partuuid/&#123;uuid&#125; /var/lib/ceph/osd/ceph-&#123;osd-number&#125;/journal # 注意别把使用中的分区给绑定错了</span><br><span class="line">chown ceph:ceph /var/lib/ceph/osd/ceph-&#123;osd-number&#125;/journal</span><br><span class="line">echo &#123;uuid&#125; &gt; /var/lib/ceph/osd/ceph-&#123;osd-number&#125;/journal_uuid  #前面/dev/disk/by-partuuid/&#123;uuid&#125; uuid</span><br><span class="line"></span><br><span class="line">6. 创建日志</span><br><span class="line">ceph-osd -i &#123;osd-number&#125; --mkjournal</span><br><span class="line"></span><br><span class="line">7. 启动osd进程</span><br><span class="line">systemctl start ceph-osd@&#123;osd-number&#125;</span><br><span class="line"></span><br><span class="line">如果所有osd进程都起来了</span><br><span class="line"></span><br><span class="line">8. 去除noout的标记</span><br><span class="line">ceph osd set noout</span><br></pre></td></tr></table></figure><h1 id="PG"><a href="#PG" class="headerlink" title="PG"></a>PG</h1><p>ceph health detail #正常会返回 ok</p><h2 id="PG-状态表"><a href="#PG-状态表" class="headerlink" title="PG 状态表"></a>PG 状态表</h2><p>正常是active+clean</p><table><thead><tr><th>状态</th><th>描述</th></tr></thead><tbody><tr><td>active</td><td>活跃状态。ceph将处理到达这个PG的读写请求</td></tr><tr><td>unactive</td><td>非活跃状态。该PG不能处理读写请求</td></tr><tr><td>clean</td><td>干净状态。Ceph复制PG内所有对象到设定正确的数目</td></tr><tr><td>unclean</td><td>非干净状态。PG不能从上一个失败中恢复</td></tr><tr><td>down</td><td>离线状态。有必需数据的副本挂掉，比如对象所在的3个副本的OSD挂掉，所以PG离线</td></tr><tr><td>degraded</td><td>降级状态。ceph有些对象的副本数目没有达到系统设置，一般是因为有OSD挂掉</td></tr><tr><td>inconsistent</td><td>不一致态。Ceph 清理和深度清理后检测到PG中的对象在副本存在不一致，例如对象的文件大小不一致或recovery结束后一个对象的副本丢失</td></tr><tr><td>peering</td><td>正在同步状态。PG正在执行同步处理</td></tr><tr><td>recovering</td><td>正在恢复状态。Ceph正在执行迁移或同步对象和他们的副本</td></tr><tr><td>incomplete</td><td>未完成状态。实际的副本数少于min_size。Ceph检测到PG正在丢失关于已经写操作的信息，或者没有任何健康的副本。如果遇到这种状态，尝试启动失败的OSD，这些OSD中可能包含需要的信息或者临时调整副本min_size的值到允许恢复。</td></tr><tr><td>stale</td><td>未刷新状态。PG状态没有被任何OSD更新，这说明所有存储这个PG的OSD可能down</td></tr><tr><td>backfilling</td><td>正在后台填充状态。 当一个新的OSD加入集群后，Ceph通过移动一些其他OSD上的PG到新的OSD来达到新的平衡；这个过程完成后，这个OSD可以处理客户端的IO请求。</td></tr><tr><td>remapped</td><td>重新映射状态。PG活动集任何的一个改变，数据发生从老活动集到新活动集的迁移。在迁移期间还是用老的活动集中的主OSD处理客户端请求，一旦迁移完成新活动集中的主OSD开始处理。</td></tr></tbody></table><h2 id="PG-长时间卡在一些状态"><a href="#PG-长时间卡在一些状态" class="headerlink" title="PG 长时间卡在一些状态"></a>PG 长时间卡在一些状态</h2><p>遇到失败后PG进入如 “degraded” 或 “peering”的状态是正常的。通常这些状态指示失败恢复处理过程中的正常继续。然而，一个PG长时间保持在其中一些状态可能是一个更大问题的提示。因此，MON当PG卡在一个非正常态时会警告。 我们特别地检查：</p><ol><li>inactive : PG太长时间不在active态，例如PG长时间不能处理读写请求，通常是peering的问题。</li><li>unclean : PG太长时间不在clean态，例如PG不能完成从上一个失败的恢复，通常是unfound objects导致。</li><li>stale : PG状态未被OSD更新，表示所有存储PG的OSD可能挂掉，一般启动相应的OSD进程即可。</li></ol><p>在MON节点执行如下命令，可以明确列出卡住的PG：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ceph pg dump_stuck stale</span><br><span class="line">ceph pg dump_stuck inactive</span><br><span class="line">ceph pg dump_stuck unclean</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Ceph清理和深度清理后到PG处于inconsistent态：</span><br><span class="line"></span><br><span class="line">清理操作被用来检查对象的可用性和健康状态。当集群没有IO密集型（例如恢复）的操作时PG被清理，已经执行清理操作再执行IO密集操作，然而清理操作继续。如果清理任务发现任何对象有损坏或者不匹配的数据（校验和检测），它将标记这个对象为不能使用并且需要手动介入和恢复。OSD执行写操作时计算校验和，Ceph并不能武断地决定副本中的哪个校验和是正确的。例如有3个副本的校验和，有1个不同，很容易猜出应该修复的错误副本（从其他副本恢复），但是当有3个不同的校验和或者一些比特错误，我们不能武断的说哪个是好的。这不是一个端到端的数据修正检查。</span><br><span class="line"></span><br><span class="line">手动修复损坏的pg</span><br><span class="line"></span><br><span class="line">1. 找到有不一致对象的PG， 执行如下命令 ceph pg dump | grep inconsistent 或者 ceph health detail</span><br><span class="line">2. 当主副本是正确数据时，执行修复命令。或者通过在OSD的硬盘上手动复制正确的文件覆盖掉错误的文件。 ceph pg repair &#123;pgnum&#125;</span><br><span class="line">   注意：如果主副本错误，应该使用手动修复，如果通过命令修复则会把主副本的错误数据复制到其他副本。</span><br></pre></td></tr></table></figure><h3 id="incomplete-PG"><a href="#incomplete-PG" class="headerlink" title="incomplete PG"></a>incomplete PG</h3><p>这个告警是因为实际副本数少于min_size。可能是由于PG对应的OSD挂掉导致。尝试启动挂掉的OSD。</p><h3 id="stale-PG"><a href="#stale-PG" class="headerlink" title="stale PG"></a>stale PG</h3><p>简单地重启受影响的OSD。当一个OSD不能映射它持有所有的对象时这个问题发生,执行如下操作：</p><ol><li><p>找到PG</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ceph pg dump_stuck stale</span><br></pre></td></tr></table></figure></li><li><p>映射pg，找到osd：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ceph pg map &#123;pgname&#125;</span><br></pre></td></tr></table></figure></li><li><p>重启上面的osd</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh &#123;osd-node&#125;</span><br><span class="line">systemctl restart ceph-osd@&#123;osd-number&#125;</span><br></pre></td></tr></table></figure></li></ol><h3 id="peering-和-down-PG"><a href="#peering-和-down-PG" class="headerlink" title="peering 和 down PG"></a>peering 和 down PG</h3><ol><li><p>找到受影响的pg</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ceph health detail</span><br></pre></td></tr></table></figure></li><li><p>下面命令响应结果中的 [“recovery_state”][“blocked”]部分显示peering被停止 的原因,大多数的情况都是一些OSD挂掉。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ceph pg &#123;pgname&#125; query</span><br></pre></td></tr></table></figure></li><li><p>尝试重启上面挂掉的OSD，如果无法启动，应该为执行如下命令标记为lost，让恢复操作开始。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ceph osd lost &#123;osd-number&#125;</span><br></pre></td></tr></table></figure></li></ol><h3 id="unfound-objects"><a href="#unfound-objects" class="headerlink" title="unfound objects"></a>unfound objects</h3><p>在特殊的失败组合下Ceph会警告unfound objects。这意味着存储集群知道有些对象存在，但是却无法找到它的副本。下面的例子说明这是怎么发生的，有1个PG他映射的的OSD是 1和2：</p><ol><li><p>OSD 1挂掉</p></li><li><p>OSD 2单独处理一些请求</p></li><li><p>OSD 1运行</p></li><li><p>OSD 1和2重新peering，1上丢失的对象在队列中等待恢复</p></li><li><p>在新对象之前被复制之前，OSD2挂掉<br>现在OSD 1知道一些对象存在，但是没有这个副本活的OSD。 这种情况下，到这些对象的IO将被阻塞，集群希望失败的OSD快速地回来。这时假设返回一个IO错误给用户是适当的。<br>修复建议：</p></li><li><p>启动停止的osd</p></li><li><p>如果还无法恢复，你可能只有放弃丢失的对象。执行如下命令回滚或删除对象：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ceph pg  &#123;pgname&#125;  mark_unfound_lost revert|delete</span><br><span class="line">revert选项：回滚到对象的前一个版本</span><br><span class="line">delete选项：完全删除这个对象</span><br><span class="line">使用这个操作时注意，因为它可能是使预期存在这个对象的程序混乱。</span><br><span class="line">列出带有丢失对象的PG的名字：</span><br><span class="line">ceph pg &#123;pgname&#125; list_missing</span><br></pre></td></tr></table></figure></li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Ceph-整体状态查看&quot;&gt;&lt;a href=&quot;#Ceph-整体状态查看&quot; class=&quot;headerlink&quot; title=&quot;Ceph 整体状态查看&quot;&gt;&lt;/a&gt;Ceph 整体状态查看&lt;/h1&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;tabl
      
    
    </summary>
    
      <category term="ceph" scheme="https://shenshengkun.github.io/categories/ceph/"/>
    
    
  </entry>
  
  <entry>
    <title>ceph对象存储</title>
    <link href="https://shenshengkun.github.io/posts/dld987c6.html"/>
    <id>https://shenshengkun.github.io/posts/dld987c6.html</id>
    <published>2019-07-11T04:10:01.000Z</published>
    <updated>2019-07-12T08:50:59.533Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Ceph-RGW简介"><a href="#Ceph-RGW简介" class="headerlink" title="Ceph RGW简介"></a>Ceph RGW简介</h1><p>Ceph RGW(即RADOS Gateway)是Ceph对象存储网关服务，是基于LIBRADOS接口封装实现的FastCGI服务，对外提供存储和管理对象数据的Restful API。 对象存储适用于图片、视频等各类文件的上传下载，可以设置相应的访问权限。目前Ceph RGW兼容常见的对象存储API，例如兼容绝大部分Amazon S3 API，兼容OpenStack Swift API。</p><h1 id="部署-RGW-服务"><a href="#部署-RGW-服务" class="headerlink" title="部署 RGW 服务"></a>部署 RGW 服务</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">[root@ceph1 ceph]# ceph-deploy install --rgw ceph1</span><br><span class="line">[ceph_deploy.conf][DEBUG ] found configuration file at: /root/.cephdeploy.conf</span><br><span class="line">[ceph_deploy.cli][INFO  ] Invoked (2.0.1): /usr/bin/ceph-deploy install --rgw ceph1</span><br><span class="line">[ceph_deploy.cli][INFO  ] ceph-deploy options:</span><br><span class="line">[ceph_deploy.cli][INFO  ]  verbose                       : False</span><br><span class="line">[ceph_deploy.cli][INFO  ]  testing                       : None</span><br><span class="line">[ceph_deploy.cli][INFO  ]  cd_conf                       : &lt;ceph_deploy.conf.cephdeploy.Conf instance at 0x7fa3faca5e60&gt;</span><br><span class="line">[ceph_deploy.cli][INFO  ]  cluster                       : ceph</span><br><span class="line">[ceph_deploy.cli][INFO  ]  dev_commit                    : None</span><br><span class="line">[ceph_deploy.cli][INFO  ]  install_mds                   : False</span><br><span class="line">[ceph_deploy.cli][INFO  ]  stable                        : None</span><br><span class="line">[ceph_deploy.cli][INFO  ]  default_release               : False</span><br><span class="line">[ceph_deploy.cli][INFO  ]  username                      : None</span><br><span class="line">[ceph_deploy.cli][INFO  ]  adjust_repos                  : True</span><br><span class="line">[ceph_deploy.cli][INFO  ]  func                          : &lt;function install at 0x7fa3fbb955f0&gt;</span><br><span class="line">[ceph_deploy.cli][INFO  ]  install_mgr                   : False</span><br><span class="line">[ceph_deploy.cli][INFO  ]  install_all                   : False</span><br><span class="line">[ceph_deploy.cli][INFO  ]  repo                          : False</span><br><span class="line">[ceph_deploy.cli][INFO  ]  host                          : [&apos;ceph1&apos;]</span><br><span class="line">[ceph_deploy.cli][INFO  ]  install_rgw                   : True</span><br></pre></td></tr></table></figure><p>将配置文件、密钥文件同步到 ceph1：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[root@ceph1 ceph]# ceph-deploy admin ceph1</span><br><span class="line">[ceph_deploy.conf][DEBUG ] found configuration file at: /root/.cephdeploy.conf</span><br><span class="line">[ceph_deploy.cli][INFO  ] Invoked (2.0.1): /usr/bin/ceph-deploy admin ceph1</span><br><span class="line">[ceph_deploy.cli][INFO  ] ceph-deploy options:</span><br><span class="line">[ceph_deploy.cli][INFO  ]  username                      : None</span><br><span class="line">[ceph_deploy.cli][INFO  ]  verbose                       : False</span><br><span class="line">[ceph_deploy.cli][INFO  ]  overwrite_conf                : False</span><br><span class="line">[ceph_deploy.cli][INFO  ]  quiet                         : False</span><br><span class="line">[ceph_deploy.cli][INFO  ]  cd_conf                       : &lt;ceph_deploy.conf.cephdeploy.Conf instance at 0x7fe0e152d3b0&gt;</span><br><span class="line">[ceph_deploy.cli][INFO  ]  cluster                       : ceph</span><br><span class="line">[ceph_deploy.cli][INFO  ]  client                        : [&apos;ceph1&apos;]</span><br><span class="line">[ceph_deploy.cli][INFO  ]  func                          : &lt;function admin at 0x7fe0e1dc0230&gt;</span><br><span class="line">[ceph_deploy.cli][INFO  ]  ceph_conf                     : None</span><br><span class="line">[ceph_deploy.cli][INFO  ]  default_release               : False</span><br><span class="line">[ceph_deploy.admin][DEBUG ] Pushing admin keys and conf to ceph1</span><br><span class="line">[ceph1][DEBUG ] connected to host: ceph1 </span><br><span class="line">[ceph1][DEBUG ] detect platform information from remote host</span><br><span class="line">[ceph1][DEBUG ] detect machine type</span><br><span class="line">[ceph1][DEBUG ] write cluster configuration to /etc/ceph/&#123;cluster&#125;.conf</span><br></pre></td></tr></table></figure><p>启动一个RGW服务 ：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">先将ceph.conf加一个参数配置</span><br><span class="line">[root@ceph1 ceph]# vim ceph.conf </span><br><span class="line">[global]</span><br><span class="line">fsid = cde3244e-89e0-4630-84d5-bf08c0e33b24</span><br><span class="line">mon_initial_members = ceph1</span><br><span class="line">mon_host = 192.168.6.101</span><br><span class="line">auth_cluster_required = cephx</span><br><span class="line">auth_service_required = cephx</span><br><span class="line">auth_client_required = cephx</span><br><span class="line">osd_pool_default_size = 2</span><br><span class="line">[mgr]</span><br><span class="line">mgr modules = dashboard</span><br><span class="line">[mon]</span><br><span class="line">mon allow pool delete = true   ####有这个配置，生成的pool才可以被删除</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@ceph1 ceph]#  ceph-deploy rgw create ceph1</span><br><span class="line">[ceph_deploy.conf][DEBUG ] found configuration file at: /root/.cephdeploy.conf</span><br><span class="line">[ceph_deploy.cli][INFO  ] Invoked (2.0.1): /usr/bin/ceph-deploy rgw create ceph1</span><br><span class="line">[ceph_deploy.cli][INFO  ] ceph-deploy options:</span><br><span class="line">[ceph_deploy.cli][INFO  ]  username                      : None</span><br><span class="line">[ceph_deploy.cli][INFO  ]  verbose                       : False</span><br><span class="line">[ceph_deploy.cli][INFO  ]  rgw                           : [(&apos;ceph1&apos;, &apos;rgw.ceph1&apos;)]</span><br><span class="line">[ceph_deploy.cli][INFO  ]  overwrite_conf                : False</span><br><span class="line">[ceph_deploy.cli][INFO  ]  subcommand                    : create</span><br><span class="line">[ceph_deploy.cli][INFO  ]  quiet                         : False</span><br><span class="line">[ceph_deploy.cli][INFO  ]  cd_conf                       : &lt;ceph_deploy.conf.cephdeploy.Conf instance at 0x7fda85404ab8&gt;</span><br><span class="line">[ceph_deploy.cli][INFO  ]  cluster                       : ceph</span><br><span class="line">[ceph_deploy.cli][INFO  ]  func                          : &lt;function rgw at 0x7fda85a53050&gt;</span><br><span class="line">[ceph_deploy.cli][INFO  ]  ceph_conf                     : None</span><br><span class="line">[ceph_deploy.cli][INFO  ]  default_release               : False</span><br><span class="line">[ceph_deploy.rgw][DEBUG ] Deploying rgw, cluster ceph hosts ceph1:rgw.ceph1</span><br><span class="line">[ceph1][DEBUG ] connected to host: ceph1 </span><br><span class="line">[ceph1][DEBUG ] detect platform information from remote host</span><br><span class="line">[ceph1][DEBUG ] detect machine type</span><br><span class="line">[ceph_deploy.rgw][INFO  ] Distro info: CentOS Linux 7.6.1810 Core</span><br><span class="line">[ceph_deploy.rgw][DEBUG ] remote host will use systemd</span><br><span class="line">[ceph_deploy.rgw][DEBUG ] deploying rgw bootstrap to ceph1</span><br><span class="line">[ceph1][DEBUG ] write cluster configuration to /etc/ceph/&#123;cluster&#125;.conf</span><br><span class="line">[ceph1][DEBUG ] create path recursively if it doesn&apos;t exist</span><br><span class="line">[ceph1][INFO  ] Running command: ceph --cluster ceph --name client.bootstrap-rgw --keyring /var/lib/ceph/bootstrap-rgw/ceph.keyring auth get-or-create client.rgw.ceph1 osd allow rwx mon allow rw -o /var/lib/ceph/radosgw/ceph-rgw.ceph1/keyring</span><br><span class="line">[ceph1][INFO  ] Running command: systemctl enable ceph-radosgw@rgw.ceph1</span><br><span class="line">[ceph1][INFO  ] Running command: systemctl start ceph-radosgw@rgw.ceph1</span><br><span class="line">[ceph1][INFO  ] Running command: systemctl enable ceph.target</span><br><span class="line">[ceph_deploy.rgw][INFO  ] The Ceph Object Gateway (RGW) is now running on host ceph1 and default port 7480</span><br><span class="line"></span><br><span class="line">验证：</span><br><span class="line">[root@ceph1 ceph]# systemctl status ceph-radosgw@rgw.ceph1</span><br><span class="line">● ceph-radosgw@rgw.ceph1.service - Ceph rados gateway</span><br><span class="line">   Loaded: loaded (/usr/lib/systemd/system/ceph-radosgw@.service; enabled; vendor preset: disabled)</span><br><span class="line">   Active: active (running) since Thu 2019-07-11 15:03:24 CST; 9s ago</span><br><span class="line"> Main PID: 21057 (radosgw)</span><br><span class="line">   CGroup: /system.slice/system-ceph\x2dradosgw.slice/ceph-radosgw@rgw.ceph1.service</span><br><span class="line">           └─21057 /usr/bin/radosgw -f --cluster ceph --name client.rgw.ceph1 --setuser ceph --setgroup ceph</span><br><span class="line"></span><br><span class="line">Jul 11 15:03:24 ceph1 systemd[1]: Started Ceph rados gateway.</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@ceph1 ceph]# ceph -s</span><br><span class="line">  cluster:</span><br><span class="line">    id:     cde3244e-89e0-4630-84d5-bf08c0e33b24</span><br><span class="line">    health: HEALTH_OK</span><br><span class="line"> </span><br><span class="line">  services:</span><br><span class="line">    mon: 1 daemons, quorum ceph1</span><br><span class="line">    mgr: ceph1(active)</span><br><span class="line">    osd: 2 osds: 2 up, 2 in</span><br><span class="line">    rgw: 1 daemon active</span><br><span class="line"> </span><br><span class="line">  data:</span><br><span class="line">    pools:   4 pools, 32 pgs</span><br><span class="line">    objects: 187 objects, 1.09KiB</span><br><span class="line">    usage:   2.01GiB used, 30.0GiB / 32.0GiB avail</span><br><span class="line">    pgs:     32 active+clean</span><br></pre></td></tr></table></figure><p>这时看下danshboard图：</p><p><img src="https://shenshengkun.github.io/images/ceph_dash2.png" alt=""></p><h1 id="使用亚马逊-s3-客户端进行访问"><a href="#使用亚马逊-s3-客户端进行访问" class="headerlink" title="使用亚马逊 s3 客户端进行访问"></a>使用亚马逊 s3 客户端进行访问</h1><h2 id="用户"><a href="#用户" class="headerlink" title="用户"></a>用户</h2><p>创建用户 ：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">[root@ceph1 ceph]# radosgw-admin user create --uid=&quot;radosgw&quot; --display-name=&quot;First User&quot;</span><br><span class="line">&#123;</span><br><span class="line">    &quot;user_id&quot;: &quot;radosgw&quot;,</span><br><span class="line">    &quot;display_name&quot;: &quot;First User&quot;,</span><br><span class="line">    &quot;email&quot;: &quot;&quot;,</span><br><span class="line">    &quot;suspended&quot;: 0,</span><br><span class="line">    &quot;max_buckets&quot;: 1000,</span><br><span class="line">    &quot;auid&quot;: 0,</span><br><span class="line">    &quot;subusers&quot;: [],</span><br><span class="line">    &quot;keys&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;user&quot;: &quot;radosgw&quot;,</span><br><span class="line">            &quot;access_key&quot;: &quot;CQE7E6ZDVA74KVJ0077A&quot;,</span><br><span class="line">            &quot;secret_key&quot;: &quot;wnRy76RM2s85ozWvKwTBezrBU0RwcCTQJf1HFAM8&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    ],</span><br><span class="line">    &quot;swift_keys&quot;: [],</span><br><span class="line">    &quot;caps&quot;: [],</span><br><span class="line">    &quot;op_mask&quot;: &quot;read, write, delete&quot;,</span><br><span class="line">    &quot;default_placement&quot;: &quot;&quot;,</span><br><span class="line">    &quot;placement_tags&quot;: [],</span><br><span class="line">    &quot;bucket_quota&quot;: &#123;</span><br><span class="line">        &quot;enabled&quot;: false,</span><br><span class="line">        &quot;check_on_raw&quot;: false,</span><br><span class="line">        &quot;max_size&quot;: -1,</span><br><span class="line">        &quot;max_size_kb&quot;: 0,</span><br><span class="line">        &quot;max_objects&quot;: -1</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;user_quota&quot;: &#123;</span><br><span class="line">        &quot;enabled&quot;: false,</span><br><span class="line">        &quot;check_on_raw&quot;: false,</span><br><span class="line">        &quot;max_size&quot;: -1,</span><br><span class="line">        &quot;max_size_kb&quot;: 0,</span><br><span class="line">        &quot;max_objects&quot;: -1</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;temp_url_keys&quot;: [],</span><br><span class="line">    &quot;type&quot;: &quot;rgw&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这个是后续需要的账户信息</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&quot;user&quot;: &quot;radosgw&quot;,</span><br><span class="line">            &quot;access_key&quot;: &quot;CQE7E6ZDVA74KVJ0077A&quot;,</span><br><span class="line">            &quot;secret_key&quot;: &quot;wnRy76RM2s85ozWvKwTBezrBU0RwcCTQJf1HFAM8&quot;</span><br></pre></td></tr></table></figure><p>授权用户，允许 radosgw 读写 users 信息： </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">[root@ceph1 ceph]# radosgw-admin caps add --uid=radosgw --caps=&quot;users=*&quot;</span><br><span class="line">&#123;</span><br><span class="line">    &quot;user_id&quot;: &quot;radosgw&quot;,</span><br><span class="line">    &quot;display_name&quot;: &quot;First User&quot;,</span><br><span class="line">    &quot;email&quot;: &quot;&quot;,</span><br><span class="line">    &quot;suspended&quot;: 0,</span><br><span class="line">    &quot;max_buckets&quot;: 1000,</span><br><span class="line">    &quot;auid&quot;: 0,</span><br><span class="line">    &quot;subusers&quot;: [],</span><br><span class="line">    &quot;keys&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;user&quot;: &quot;radosgw&quot;,</span><br><span class="line">            &quot;access_key&quot;: &quot;CQE7E6ZDVA74KVJ0077A&quot;,</span><br><span class="line">            &quot;secret_key&quot;: &quot;wnRy76RM2s85ozWvKwTBezrBU0RwcCTQJf1HFAM8&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    ],</span><br><span class="line">    &quot;swift_keys&quot;: [],</span><br><span class="line">    &quot;caps&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;type&quot;: &quot;users&quot;,</span><br><span class="line">            &quot;perm&quot;: &quot;*&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    ],</span><br><span class="line">    &quot;op_mask&quot;: &quot;read, write, delete&quot;,</span><br><span class="line">    &quot;default_placement&quot;: &quot;&quot;,</span><br><span class="line">    &quot;placement_tags&quot;: [],</span><br><span class="line">    &quot;bucket_quota&quot;: &#123;</span><br><span class="line">        &quot;enabled&quot;: false,</span><br><span class="line">        &quot;check_on_raw&quot;: false,</span><br><span class="line">        &quot;max_size&quot;: -1,</span><br><span class="line">        &quot;max_size_kb&quot;: 0,</span><br><span class="line">        &quot;max_objects&quot;: -1</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;user_quota&quot;: &#123;</span><br><span class="line">        &quot;enabled&quot;: false,</span><br><span class="line">        &quot;check_on_raw&quot;: false,</span><br><span class="line">        &quot;max_size&quot;: -1,</span><br><span class="line">        &quot;max_size_kb&quot;: 0,</span><br><span class="line">        &quot;max_objects&quot;: -1</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;temp_url_keys&quot;: [],</span><br><span class="line">    &quot;type&quot;: &quot;rgw&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>允许 radosgw 读写所有的usage信息： </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">[root@ceph1 ceph]#  radosgw-admin caps add --uid=radosgw --caps=&quot;usage=read,write&quot;</span><br><span class="line">&#123;</span><br><span class="line">    &quot;user_id&quot;: &quot;radosgw&quot;,</span><br><span class="line">    &quot;display_name&quot;: &quot;First User&quot;,</span><br><span class="line">    &quot;email&quot;: &quot;&quot;,</span><br><span class="line">    &quot;suspended&quot;: 0,</span><br><span class="line">    &quot;max_buckets&quot;: 1000,</span><br><span class="line">    &quot;auid&quot;: 0,</span><br><span class="line">    &quot;subusers&quot;: [],</span><br><span class="line">    &quot;keys&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;user&quot;: &quot;radosgw&quot;,</span><br><span class="line">            &quot;access_key&quot;: &quot;CQE7E6ZDVA74KVJ0077A&quot;,</span><br><span class="line">            &quot;secret_key&quot;: &quot;wnRy76RM2s85ozWvKwTBezrBU0RwcCTQJf1HFAM8&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    ],</span><br><span class="line">    &quot;swift_keys&quot;: [],</span><br><span class="line">    &quot;caps&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;type&quot;: &quot;usage&quot;,</span><br><span class="line">            &quot;perm&quot;: &quot;*&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;type&quot;: &quot;users&quot;,</span><br><span class="line">            &quot;perm&quot;: &quot;*&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    ],</span><br><span class="line">    &quot;op_mask&quot;: &quot;read, write, delete&quot;,</span><br><span class="line">    &quot;default_placement&quot;: &quot;&quot;,</span><br><span class="line">    &quot;placement_tags&quot;: [],</span><br><span class="line">    &quot;bucket_quota&quot;: &#123;</span><br><span class="line">        &quot;enabled&quot;: false,</span><br><span class="line">        &quot;check_on_raw&quot;: false,</span><br><span class="line">        &quot;max_size&quot;: -1,</span><br><span class="line">        &quot;max_size_kb&quot;: 0,</span><br><span class="line">        &quot;max_objects&quot;: -1</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;user_quota&quot;: &#123;</span><br><span class="line">        &quot;enabled&quot;: false,</span><br><span class="line">        &quot;check_on_raw&quot;: false,</span><br><span class="line">        &quot;max_size&quot;: -1,</span><br><span class="line">        &quot;max_size_kb&quot;: 0,</span><br><span class="line">        &quot;max_objects&quot;: -1</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;temp_url_keys&quot;: [],</span><br><span class="line">    &quot;type&quot;: &quot;rgw&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>创建子用户，做为后面 swift 客户端访问时使用：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">[root@ceph1 ceph]#  radosgw-admin subuser create --uid=radosgw --subuser=radosgw:swift --access=full</span><br><span class="line">&#123;</span><br><span class="line">    &quot;user_id&quot;: &quot;radosgw&quot;,</span><br><span class="line">    &quot;display_name&quot;: &quot;First User&quot;,</span><br><span class="line">    &quot;email&quot;: &quot;&quot;,</span><br><span class="line">    &quot;suspended&quot;: 0,</span><br><span class="line">    &quot;max_buckets&quot;: 1000,</span><br><span class="line">    &quot;auid&quot;: 0,</span><br><span class="line">    &quot;subusers&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;id&quot;: &quot;radosgw:swift&quot;,</span><br><span class="line">            &quot;permissions&quot;: &quot;full-control&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    ],</span><br><span class="line">    &quot;keys&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;user&quot;: &quot;radosgw&quot;,</span><br><span class="line">            &quot;access_key&quot;: &quot;CQE7E6ZDVA74KVJ0077A&quot;,</span><br><span class="line">            &quot;secret_key&quot;: &quot;wnRy76RM2s85ozWvKwTBezrBU0RwcCTQJf1HFAM8&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    ],</span><br><span class="line">    &quot;swift_keys&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;user&quot;: &quot;radosgw:swift&quot;,</span><br><span class="line">            &quot;secret_key&quot;: &quot;A3GDj2yjkGJahkCM6YJS4QKQlGz2zd65GXvCkiwV&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    ],</span><br><span class="line">    &quot;caps&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;type&quot;: &quot;usage&quot;,</span><br><span class="line">            &quot;perm&quot;: &quot;*&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;type&quot;: &quot;users&quot;,</span><br><span class="line">            &quot;perm&quot;: &quot;*&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    ],</span><br><span class="line">    &quot;op_mask&quot;: &quot;read, write, delete&quot;,</span><br><span class="line">    &quot;default_placement&quot;: &quot;&quot;,</span><br><span class="line">    &quot;placement_tags&quot;: [],</span><br><span class="line">    &quot;bucket_quota&quot;: &#123;</span><br><span class="line">        &quot;enabled&quot;: false,</span><br><span class="line">        &quot;check_on_raw&quot;: false,</span><br><span class="line">        &quot;max_size&quot;: -1,</span><br><span class="line">        &quot;max_size_kb&quot;: 0,</span><br><span class="line">        &quot;max_objects&quot;: -1</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;user_quota&quot;: &#123;</span><br><span class="line">        &quot;enabled&quot;: false,</span><br><span class="line">        &quot;check_on_raw&quot;: false,</span><br><span class="line">        &quot;max_size&quot;: -1,</span><br><span class="line">        &quot;max_size_kb&quot;: 0,</span><br><span class="line">        &quot;max_objects&quot;: -1</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;temp_url_keys&quot;: [],</span><br><span class="line">    &quot;type&quot;: &quot;rgw&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>创建密钥 ：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">[root@ceph1 ceph]# radosgw-admin key create --subuser=radosgw:swift --key-type=swift --gen-secret</span><br><span class="line">&#123;</span><br><span class="line">    &quot;user_id&quot;: &quot;radosgw&quot;,</span><br><span class="line">    &quot;display_name&quot;: &quot;First User&quot;,</span><br><span class="line">    &quot;email&quot;: &quot;&quot;,</span><br><span class="line">    &quot;suspended&quot;: 0,</span><br><span class="line">    &quot;max_buckets&quot;: 1000,</span><br><span class="line">    &quot;auid&quot;: 0,</span><br><span class="line">    &quot;subusers&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;id&quot;: &quot;radosgw:swift&quot;,</span><br><span class="line">            &quot;permissions&quot;: &quot;full-control&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    ],</span><br><span class="line">    &quot;keys&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;user&quot;: &quot;radosgw&quot;,</span><br><span class="line">            &quot;access_key&quot;: &quot;CQE7E6ZDVA74KVJ0077A&quot;,</span><br><span class="line">            &quot;secret_key&quot;: &quot;wnRy76RM2s85ozWvKwTBezrBU0RwcCTQJf1HFAM8&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    ],</span><br><span class="line">    &quot;swift_keys&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;user&quot;: &quot;radosgw:swift&quot;,</span><br><span class="line">            &quot;secret_key&quot;: &quot;CZ2F5lqOfdmTCLSPyzqcw5pPNeetruAL4HjHkiAh&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    ],</span><br><span class="line">    &quot;caps&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;type&quot;: &quot;usage&quot;,</span><br><span class="line">            &quot;perm&quot;: &quot;*&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;type&quot;: &quot;users&quot;,</span><br><span class="line">            &quot;perm&quot;: &quot;*&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    ],</span><br><span class="line">    &quot;op_mask&quot;: &quot;read, write, delete&quot;,</span><br><span class="line">    &quot;default_placement&quot;: &quot;&quot;,</span><br><span class="line">    &quot;placement_tags&quot;: [],</span><br><span class="line">    &quot;bucket_quota&quot;: &#123;</span><br><span class="line">        &quot;enabled&quot;: false,</span><br><span class="line">        &quot;check_on_raw&quot;: false,</span><br><span class="line">        &quot;max_size&quot;: -1,</span><br><span class="line">        &quot;max_size_kb&quot;: 0,</span><br><span class="line">        &quot;max_objects&quot;: -1</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;user_quota&quot;: &#123;</span><br><span class="line">        &quot;enabled&quot;: false,</span><br><span class="line">        &quot;check_on_raw&quot;: false,</span><br><span class="line">        &quot;max_size&quot;: -1,</span><br><span class="line">        &quot;max_size_kb&quot;: 0,</span><br><span class="line">        &quot;max_objects&quot;: -1</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;temp_url_keys&quot;: [],</span><br><span class="line">    &quot;type&quot;: &quot;rgw&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="安装-s3-客户端软件"><a href="#安装-s3-客户端软件" class="headerlink" title="安装 s3 客户端软件"></a>安装 s3 客户端软件</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@ceph1 ceph]# yum -y install s3cmd.noarch</span><br></pre></td></tr></table></figure><h2 id="对-s3-进行配置"><a href="#对-s3-进行配置" class="headerlink" title="对 s3 进行配置"></a>对 s3 进行配置</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@ceph1 ceph]# s3cmd --configure</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">New settings:</span><br><span class="line">  Access Key: CQE7E6ZDVA74KVJ0077A</span><br><span class="line">  Secret Key: wnRy76RM2s85ozWvKwTBezrBU0RwcCTQJf1HFAM8</span><br><span class="line">  Default Region: US</span><br><span class="line">  S3 Endpoint: 192.168.6.101:7480</span><br><span class="line">  DNS-style bucket+hostname:port template for accessing a bucket: %(bucket)s.192.168.6.101:7480 bucket</span><br><span class="line">  Encryption password: 123456</span><br><span class="line">  Path to GPG program: /usr/bin/gpg</span><br><span class="line">  Use HTTPS protocol: False</span><br><span class="line">  HTTP Proxy server name: </span><br><span class="line">  HTTP Proxy server port: 0</span><br><span class="line"></span><br><span class="line">Test access with supplied credentials? [Y/n] y</span><br><span class="line">Please wait, attempting to list all buckets...</span><br><span class="line">Success. Your access key and secret key worked fine :-)</span><br><span class="line"></span><br><span class="line">Now verifying that encryption works...</span><br><span class="line">Success. Encryption and decryption worked fine :-)</span><br><span class="line"></span><br><span class="line">Save settings? [y/N] y</span><br><span class="line">Configuration saved to &apos;/root/.s3cfg&apos;</span><br></pre></td></tr></table></figure><p>格式是这样：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Default Region [US]:                        #这里一定不要修改，否则后面会报错</span><br><span class="line">S3 Endpoint [s3.amazonaws.com]: 192.168.6.101:7480</span><br><span class="line">DNS-style bucket+hostname:port template for accessing a bucket [%(bucket)s.s3.amazonaws.com]: %(bucket)s.192.168.20.148:7480 bucket     #相当于百度网盘的创建文件夹，这里是固定格式</span><br><span class="line">Path to GPG program [/usr/bin/gpg]:                 #保持默认</span><br><span class="line">Use HTTPS protocol [Yes]: no                    #这里写 no ，因为没有提供 https 端口</span><br><span class="line">HTTP Proxy server name:                       #这里不用写，因为没有代理</span><br><span class="line">Test access with supplied credentials? [Y/n] y</span><br><span class="line">Save settings? [y/N] y</span><br></pre></td></tr></table></figure><p>由于我没把端口改成80，所以需要带端口访问的，后续可以nginx代理</p><h2 id="创建存储数据的-bucket"><a href="#创建存储数据的-bucket" class="headerlink" title="创建存储数据的 bucket"></a>创建存储数据的 bucket</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@ceph1 ~]# s3cmd mb s3://cephdir</span><br><span class="line">[root@ceph1 ~]# s3cmd put /etc/hosts s3://ceph_dir</span><br><span class="line">upload: &apos;/etc/hosts&apos; -&gt; &apos;s3://ceph_dir/hosts&apos;  [1 of 1]</span><br><span class="line"> 200 of 200   100% in    1s   133.14 B/s  done</span><br><span class="line"> </span><br><span class="line"> [root@ceph1 ~]# s3cmd ls s3://ceph_dir</span><br><span class="line">2019-07-11 08:41       200   s3://ceph_dir/hosts</span><br></pre></td></tr></table></figure><p> s3 的测试脚本：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[root@ceph-f ~]# yum -y install python-boto</span><br><span class="line">[root@ceph-f ~]# vim s3test.py</span><br><span class="line">import boto.s3.connection</span><br><span class="line">access_key = &apos;N6ALEK0KS0ISYCIM5JBG&apos;</span><br><span class="line">secret_key = &apos;qK9hrpX2uwna4elPP1VsuErmAHBw3So40fE2K4yM&apos;</span><br><span class="line">conn = boto.connect_s3(</span><br><span class="line">         aws_access_key_id=access_key,         </span><br><span class="line">         aws_secret_access_key=secret_key,         </span><br><span class="line">         host=&apos;ceph1&apos;, port=7480,         </span><br><span class="line">         is_secure=False, calling_format=boto.s3.connection.OrdinaryCallingFormat(),        </span><br><span class="line">         )</span><br><span class="line">bucket = conn.create_bucket(&apos;xxx_yyy&apos;)</span><br><span class="line">for bucket in conn.get_all_buckets():</span><br><span class="line">     print &quot;&#123;name&#125; &#123;created&#125;&quot;.format(         </span><br><span class="line">     name=bucket.name,         </span><br><span class="line">     created=bucket.creation_date,     </span><br><span class="line">     )</span><br></pre></td></tr></table></figure><p>在使用时，请替换自己的 access_key、secret_key、主机名和端口</p><h1 id="swift-接口测试"><a href="#swift-接口测试" class="headerlink" title="swift 接口测试"></a>swift 接口测试</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">yum install python-setuptools</span><br><span class="line">easy_install pip</span><br><span class="line">pip install --upgrade setuptools</span><br><span class="line">pip install --upgrade python-swiftclient</span><br></pre></td></tr></table></figure><p>命令行访问 ：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[root@ceph1 ~]# swift -A http://192.168.6.101:7480/auth/v1.0 -U radosgw:swift -K CZ2F5lqOfdmTCLSPyzqcw5pPNeetruAL4HjHkiAh list</span><br><span class="line">ceph_dir</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">swift -A http://192.168.6.101:7480/auth/v1.0 -U radosgw:swift -K CZ2F5lqOfdmTCLSPyzqcw5pPNeetruAL4HjHkiAh post sy-yt</span><br><span class="line"></span><br><span class="line">swift -A http://192.168.6.101:7480/auth/v1.0 -U radosgw:swift -K CZ2F5lqOfdmTCLSPyzqcw5pPNeetruAL4HjHkiAh post sy_yt</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@ceph1 ~]# swift -A http://192.168.6.101:7480/auth/v1.0 -U radosgw:swift -K CZ2F5lqOfdmTCLSPyzqcw5pPNeetruAL4HjHkiAh list</span><br><span class="line">ceph_dir</span><br><span class="line">sy-yt</span><br><span class="line">sy_yt</span><br></pre></td></tr></table></figure><p>这里提供 swift 的测试脚本：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[root@ceph-f ~]# vim swift.py</span><br><span class="line">import swiftclient</span><br><span class="line">user = &apos;radosgw:swift&apos;</span><br><span class="line">key = &apos;CZ2F5lqOfdmTCLSPyzqcw5pPNeetruAL4HjHkiAh&apos;</span><br><span class="line"></span><br><span class="line">conn = swiftclient.Connection(</span><br><span class="line">         user=user,         </span><br><span class="line">         key=key,         </span><br><span class="line">         authurl=&apos;http://192.168.6.101:7480/auth/v1.0&apos;,</span><br><span class="line">         )</span><br><span class="line">for container in conn.get_account()[1]:</span><br><span class="line">         print container[&apos;name&apos;]</span><br></pre></td></tr></table></figure><p>在使用时，请替换自己的 access_key、secret_key、authurl</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Ceph-RGW简介&quot;&gt;&lt;a href=&quot;#Ceph-RGW简介&quot; class=&quot;headerlink&quot; title=&quot;Ceph RGW简介&quot;&gt;&lt;/a&gt;Ceph RGW简介&lt;/h1&gt;&lt;p&gt;Ceph RGW(即RADOS Gateway)是Ceph对象存储网关服务，
      
    
    </summary>
    
      <category term="ceph" scheme="https://shenshengkun.github.io/categories/ceph/"/>
    
    
  </entry>
  
  <entry>
    <title>ceph简单搭建</title>
    <link href="https://shenshengkun.github.io/posts/ldfl554c.html"/>
    <id>https://shenshengkun.github.io/posts/ldfl554c.html</id>
    <published>2019-07-11T03:10:01.000Z</published>
    <updated>2019-07-17T03:00:05.048Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ceph介绍"><a href="#ceph介绍" class="headerlink" title="ceph介绍"></a>ceph介绍</h1><h2 id="Ceph基础介绍"><a href="#Ceph基础介绍" class="headerlink" title="Ceph基础介绍"></a>Ceph基础介绍</h2><p>​    Ceph是一个可靠地、自动重均衡、自动恢复的分布式存储系统，根据场景划分可以将Ceph分为三大块，分别是对象存储、块设备存储和文件系统服务。在虚拟化领域里，比较常用到的是Ceph的块设备存储，比如在OpenStack项目里，Ceph的块设备存储可以对接OpenStack的cinder后端存储、Glance的镜像存储和虚拟机的数据存储，比较直观的是Ceph集群可以提供一个raw格式的块存储来作为虚拟机实例的硬盘。</p><p>​    Ceph相比其它存储的优势点在于它不单单是存储，同时还充分利用了存储节点上的计算能力，在存储每一个数据时，都会通过计算得出该数据存储的位置，尽量将数据分布均衡，同时由于Ceph的良好设计，采用了CRUSH算法、HASH环等方法，使得它不存在传统的单点故障的问题，且随着规模的扩大性能并不会受到影响。</p><h2 id="Ceph的核心组件"><a href="#Ceph的核心组件" class="headerlink" title="Ceph的核心组件"></a>Ceph的核心组件</h2><p>​    Ceph的核心组件包括Ceph OSD、Ceph Monitor和Ceph MDS。</p><p>  Ceph OSD：OSD的英文全称是Object Storage Device，它的主要功能是存储数据、复制数据、平衡数据、恢复数据等，与其它OSD间进行心跳检查等，并将一些变化情况上报给Ceph Monitor。一般情况下一块硬盘对应一个OSD，由OSD来对硬盘存储进行管理，当然一个分区也可以成为一个OSD。</p><p>  Ceph OSD的架构实现由物理磁盘驱动器、Linux文件系统和Ceph OSD服务组成，对于Ceph OSD Deamon而言，Linux文件系统显性的支持了其拓展性，一般Linux文件系统有好几种，比如有BTRFS、XFS、Ext4等，BTRFS虽然有很多优点特性，但现在还没达到生产环境所需的稳定性，一般比较推荐使用XFS。</p><p>  伴随OSD的还有一个概念叫做Journal盘，一般写数据到Ceph集群时，都是先将数据写入到Journal盘中，然后每隔一段时间比如5秒再将Journal盘中的数据刷新到文件系统中。一般为了使读写时延更小，Journal盘都是采用SSD，一般分配10G以上，当然分配多点那是更好，Ceph中引入Journal盘的概念是因为Journal允许Ceph OSD功能很快做小的写操作；一个随机写入首先写入在上一个连续类型的journal，然后刷新到文件系统，这给了文件系统足够的时间来合并写入磁盘，一般情况下使用SSD作为OSD的journal可以有效缓冲突发负载。</p><p>  Ceph Monitor：由该英文名字我们可以知道它是一个监视器，负责监视Ceph集群，维护Ceph集群的健康状态，同时维护着Ceph集群中的各种Map图，比如OSD Map、Monitor Map、PG Map和CRUSH Map，这些Map统称为Cluster Map，Cluster Map是RADOS的关键数据结构，管理集群中的所有成员、关系、属性等信息以及数据的分发，比如当用户需要存储数据到Ceph集群时，OSD需要先通过Monitor获取最新的Map图，然后根据Map图和object id等计算出数据最终存储的位置。</p><p>  Ceph MDS：全称是Ceph MetaData Server，主要保存的文件系统服务的元数据，但对象存储和块存储设备是不需要使用该服务的。</p><p>  查看各种Map的信息可以通过如下命令：ceph osd(mon、pg) dump</p><h1 id="ceph-deploy安装ceph"><a href="#ceph-deploy安装ceph" class="headerlink" title="ceph-deploy安装ceph"></a>ceph-deploy安装ceph</h1><h2 id="基本环境"><a href="#基本环境" class="headerlink" title="基本环境"></a>基本环境</h2><table><thead><tr><th><strong>192.168.6.101</strong></th><th><strong>ceph1</strong></th></tr></thead><tbody><tr><td><strong>192.168.6.102</strong></td><td><strong>ceph2</strong></td></tr></tbody></table><p>俩台机器都挂俩块盘，一块系统盘，一块osd</p><p>配hosts：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@ceph1 ~]# vim /etc/hosts</span><br><span class="line">192.168.6.101   ceph1</span><br><span class="line">192.168.6.102   ceph2</span><br></pre></td></tr></table></figure><p>时间同步：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ntpdate ntp1.aliyun.com</span><br></pre></td></tr></table></figure><p>允许无密码SSH登录：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">在ceph1上执行</span><br><span class="line">ssh-keygen</span><br><span class="line">ssh-copy-id ceph1</span><br><span class="line">ssh-copy-id ceph2</span><br></pre></td></tr></table></figure><p>配置主机名：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hostnamectl set-hostname ceph1</span><br><span class="line">hostnamectl set-hostname ceph2</span><br></pre></td></tr></table></figure><h2 id="配置ceph-repo"><a href="#配置ceph-repo" class="headerlink" title="配置ceph.repo"></a>配置ceph.repo</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">[root@ceph1 ~]# vim /etc/yum.repos.d/ceph.repo</span><br><span class="line">[ceph]</span><br><span class="line">name=Ceph packages for $basearch</span><br><span class="line">baseurl=http://mirrors.aliyun.com/ceph/rpm-luminous/el7/$basearch</span><br><span class="line">enabled=1</span><br><span class="line">gpgcheck=1</span><br><span class="line">priority=1</span><br><span class="line">type=rpm-md</span><br><span class="line">gpgkey=https://mirrors.aliyun.com/ceph/keys/release.asc</span><br><span class="line"></span><br><span class="line">[ceph-noarch]</span><br><span class="line">name=Ceph noarch packages</span><br><span class="line">baseurl=http://mirrors.aliyun.com/ceph/rpm-luminous/el7/noarch</span><br><span class="line">enabled=1</span><br><span class="line">gpgcheck=1</span><br><span class="line">priority=1</span><br><span class="line">type=rpm-md</span><br><span class="line">gpgkey=https://mirrors.aliyun.com/ceph/keys/release.asc</span><br><span class="line"></span><br><span class="line">[ceph-source]</span><br><span class="line">name=Ceph source packages</span><br><span class="line">baseurl=http://mirrors.aliyun.com/ceph/rpm-luminous/el7/SRPMS</span><br><span class="line">enabled=0</span><br><span class="line">gpgcheck=1</span><br><span class="line">type=rpm-md</span><br><span class="line">gpgkey=https://mirrors.aliyun.com/ceph/keys/release.asc</span><br><span class="line">priority=1</span><br></pre></td></tr></table></figure><p> 安装ceph-deploy：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">yum install -y https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm</span><br><span class="line">yum makecache</span><br><span class="line">yum update -y</span><br><span class="line">yum install -y ceph-deploy</span><br></pre></td></tr></table></figure><h1 id="创建一个-Ceph-存储集群，它有一个-Monitor-和两个-OSD-守护进程"><a href="#创建一个-Ceph-存储集群，它有一个-Monitor-和两个-OSD-守护进程" class="headerlink" title="创建一个 Ceph 存储集群，它有一个 Monitor 和两个 OSD 守护进程"></a>创建一个 Ceph 存储集群，它有一个 Monitor 和两个 OSD 守护进程</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">mkdir /etc/ceph &amp;&amp; cd /etc/ceph</span><br><span class="line">ceph-deploy new ceph1     ###配置</span><br><span class="line"></span><br><span class="line">一般会遇到个报错：</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File &quot;/usr/bin/ceph-deploy&quot;, line 18, in &lt;module&gt;</span><br><span class="line">    from ceph_deploy.cli import main</span><br><span class="line">  File &quot;/usr/lib/python2.7/site-packages/ceph_deploy/cli.py&quot;, line 1, in &lt;module&gt;</span><br><span class="line">    import pkg_resources</span><br><span class="line">ImportError: No module named pkg_resources</span><br><span class="line"></span><br><span class="line">解决：</span><br><span class="line">yum install -y python-setuptools</span><br></pre></td></tr></table></figure><p>在ceph.conf中追加以下内容</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># 存储集群副本个数</span><br><span class="line"></span><br><span class="line">osd_pool_default_size = 2</span><br></pre></td></tr></table></figure><p>管理节点和osd节点都需要安装ceph 集群：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ceph-deploy install ceph1 ceph2</span><br></pre></td></tr></table></figure><p>配置MON初始化:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ceph-deploy mon create-initial</span><br></pre></td></tr></table></figure><p>查看ceph集群状态：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[root@ceph1 ceph]# ceph -s</span><br><span class="line">  cluster:</span><br><span class="line">    id:     cde3244e-89e0-4630-84d5-bf08c0e33b24</span><br><span class="line">    health: HEALTH_OK</span><br><span class="line"> </span><br><span class="line">  services:</span><br><span class="line">    mon: 1 daemons, quorum ceph1</span><br><span class="line">    mgr: no daemons active</span><br><span class="line">    osd: 0 osds: 0 up, 0 in</span><br><span class="line"> </span><br><span class="line">  data:</span><br><span class="line">    pools:   0 pools, 0 pgs</span><br><span class="line">    objects: 0 objects, 0B</span><br><span class="line">    usage:   0B used, 0B / 0B avail</span><br><span class="line">    pgs:</span><br></pre></td></tr></table></figure><h2 id="开启监控模块"><a href="#开启监控模块" class="headerlink" title="开启监控模块"></a>开启监控模块</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ceph-deploy mgr create ceph1</span><br></pre></td></tr></table></figure><p>在<code>/etc/ceph/ceph.conf</code>中添加</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[mgr]</span><br><span class="line">mgr modules = dashboard</span><br></pre></td></tr></table></figure><p>查看集群支持的模块</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">[root@ceph1 ceph]# ceph mgr dump   </span><br><span class="line">[root@ceph1 ceph]# ceph mgr module enable dashboard   #启用dashboard模块</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@ceph1 ceph]# ceph mgr dump</span><br><span class="line">&#123;</span><br><span class="line">    &quot;epoch&quot;: 3,</span><br><span class="line">    &quot;active_gid&quot;: 4110,</span><br><span class="line">    &quot;active_name&quot;: &quot;ceph1&quot;,</span><br><span class="line">    &quot;active_addr&quot;: &quot;192.168.6.101:6800/6619&quot;,</span><br><span class="line">    &quot;available&quot;: true,</span><br><span class="line">    &quot;standbys&quot;: [],</span><br><span class="line">    &quot;modules&quot;: [        &quot;balancer&quot;,</span><br><span class="line">        &quot;restful&quot;,</span><br><span class="line">        &quot;status&quot;</span><br><span class="line">    ],</span><br><span class="line">    &quot;available_modules&quot;: [        &quot;balancer&quot;,</span><br><span class="line">        &quot;dashboard&quot;,</span><br><span class="line">        &quot;influx&quot;,</span><br><span class="line">        &quot;localpool&quot;,</span><br><span class="line">        &quot;prometheus&quot;,</span><br><span class="line">        &quot;restful&quot;,</span><br><span class="line">        &quot;selftest&quot;,</span><br><span class="line">        &quot;status&quot;,</span><br><span class="line">        &quot;zabbix&quot;</span><br><span class="line">    ],</span><br><span class="line">    &quot;services&quot;: &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line">[root@ceph1 ceph]# ceph mgr module enable dashboard</span><br><span class="line">[root@ceph1 ceph]# ceph mgr dump</span><br><span class="line">&#123;</span><br><span class="line">    &quot;epoch&quot;: 6,</span><br><span class="line">    &quot;active_gid&quot;: 4114,</span><br><span class="line">    &quot;active_name&quot;: &quot;ceph1&quot;,</span><br><span class="line">    &quot;active_addr&quot;: &quot;192.168.6.101:6800/6619&quot;,</span><br><span class="line">    &quot;available&quot;: true,</span><br><span class="line">    &quot;standbys&quot;: [],</span><br><span class="line">    &quot;modules&quot;: [        &quot;balancer&quot;,</span><br><span class="line">        &quot;dashboard&quot;,</span><br><span class="line">        &quot;restful&quot;,</span><br><span class="line">        &quot;status&quot;</span><br><span class="line">    ],</span><br><span class="line">    &quot;available_modules&quot;: [        &quot;balancer&quot;,</span><br><span class="line">        &quot;dashboard&quot;,</span><br><span class="line">        &quot;influx&quot;,</span><br><span class="line">        &quot;localpool&quot;,</span><br><span class="line">        &quot;prometheus&quot;,</span><br><span class="line">        &quot;restful&quot;,</span><br><span class="line">        &quot;selftest&quot;,</span><br><span class="line">        &quot;status&quot;,</span><br><span class="line">        &quot;zabbix&quot;</span><br><span class="line">    ],</span><br><span class="line">    &quot;services&quot;: &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">[root@ceph1 ceph]# ceph -s</span><br><span class="line">  cluster:</span><br><span class="line">    id:     cde3244e-89e0-4630-84d5-bf08c0e33b24</span><br><span class="line">    health: HEALTH_OK</span><br><span class="line"> </span><br><span class="line">  services:</span><br><span class="line">    mon: 1 daemons, quorum ceph1</span><br><span class="line">    mgr: ceph1(active)</span><br><span class="line">    osd: 2 osds: 2 up, 2 in</span><br><span class="line"> </span><br><span class="line">  data:</span><br><span class="line">    pools:   0 pools, 0 pgs</span><br><span class="line">    objects: 0 objects, 0B</span><br><span class="line">    usage:   2.00GiB used, 30.0GiB / 32.0GiB avail</span><br><span class="line">    pgs:</span><br></pre></td></tr></table></figure><p>设置<code>dashboard</code>的<code>ip</code>和端口</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@ceph-node1 ceph]# ceph config-key put mgr/dashboard/server_addr 192.168.6.101</span><br><span class="line">set mgr/dashboard/server_addr</span><br><span class="line">[root@ceph-node1 ceph]# ceph config-key put mgr/dashboard/server_port 7000</span><br><span class="line">set mgr/dashboard/server_port</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@ceph1 ~]# netstat -tulnp |grep 7000</span><br><span class="line">tcp        0      0 192.168.6.101:7000      0.0.0.0:*               LISTEN      19836/ceph-mgr</span><br></pre></td></tr></table></figure><h2 id="创建osd"><a href="#创建osd" class="headerlink" title="创建osd"></a>创建osd</h2><p>删除磁盘数据</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@ceph1 ceph]# ceph-deploy disk zap ceph1 /dev/sdb</span><br><span class="line">[root@ceph1 ceph]# ceph-deploy disk zap ceph2 /dev/sdb</span><br></pre></td></tr></table></figure><p>创建osd(一共俩个)</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@ceph1 ceph]# ceph-deploy osd create ceph1 --data /dev/sdb</span><br><span class="line">[root@ceph1 ceph]# ceph-deploy osd create ceph2 --data /dev/sdb</span><br></pre></td></tr></table></figure><p> ceph秘钥拷贝（主节点执行）及修改密钥权限<br> 用 ceph-deploy 把配置文件和 admin 密钥拷贝到管理节点和 Ceph 节点，这样你每次执行 Ceph 命令行时就无需指定 monitor 地址和 ceph.client.admin.keyring 了</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@ceph1 ceph]# ceph-deploy admin ceph1 ceph2</span><br></pre></td></tr></table></figure><p>修改密钥权限（所有节点上执行）</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@ceph1 ceph] # chmod +r /etc/ceph/ceph.client.admin.keyring</span><br><span class="line">[root@ceph2] # chmod +r /etc/ceph/ceph.client.admin.keyring</span><br></pre></td></tr></table></figure><p>这时看下danshboard图：</p><p><img src="https://shenshengkun.github.io/images/ceph_dash1.png" alt=""></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;ceph介绍&quot;&gt;&lt;a href=&quot;#ceph介绍&quot; class=&quot;headerlink&quot; title=&quot;ceph介绍&quot;&gt;&lt;/a&gt;ceph介绍&lt;/h1&gt;&lt;h2 id=&quot;Ceph基础介绍&quot;&gt;&lt;a href=&quot;#Ceph基础介绍&quot; class=&quot;headerlink&quot; 
      
    
    </summary>
    
      <category term="ceph" scheme="https://shenshengkun.github.io/categories/ceph/"/>
    
    
  </entry>
  
  <entry>
    <title>Kubernetes Pod无法删除</title>
    <link href="https://shenshengkun.github.io/posts/dk7569vg.html"/>
    <id>https://shenshengkun.github.io/posts/dk7569vg.html</id>
    <published>2019-07-04T05:53:01.000Z</published>
    <updated>2019-07-05T06:59:46.817Z</updated>
    
    <content type="html"><![CDATA[<h1 id="问题发现"><a href="#问题发现" class="headerlink" title="问题发现"></a>问题发现</h1><p>在node节点断电 重启后，发现有的pod节点状态不正常，之前的回收策略也都做了，就调研下是什么原因导致的</p><p>pod一直处于Terminated: ExitCode 状态</p><h1 id="解决"><a href="#解决" class="headerlink" title="解决"></a>解决</h1><h2 id="直接删除，无法飘移"><a href="#直接删除，无法飘移" class="headerlink" title="直接删除，无法飘移"></a>直接删除，无法飘移</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">kubectl delete pod &lt;podname&gt; --namespace=&lt;namspacer&gt; --grace-period=0 --force</span><br><span class="line">发现pod无法漂移</span><br><span class="line">docker ps -a查看对应docker容器的状态，发现这两个Pod的docker容器处于Dead状态。使用docker rm &lt;container id&gt;，提示Device is Busy，无法删除。</span><br></pre></td></tr></table></figure><h2 id="现象是由于systemd服务PrivateTmp-true引起"><a href="#现象是由于systemd服务PrivateTmp-true引起" class="headerlink" title="现象是由于systemd服务PrivateTmp=true引起"></a>现象是由于systemd服务<code>PrivateTmp=true</code>引起</h2><p>最根本的方法是，当机器加入时，在 <code>docker.service</code> 中加上：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[Service]</span><br><span class="line">MountFlags=slave</span><br></pre></td></tr></table></figure><h1 id="关于Systemd的MountFlags"><a href="#关于Systemd的MountFlags" class="headerlink" title="关于Systemd的MountFlags"></a>关于Systemd的MountFlags</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">MountFlags: 配置Systemd服务的Mount Namespace配置。会影响服务进程上下文中挂载点的信息，即服务是否会继承主机上已有的挂载点，以及如果服务运行时执行了挂载或卸载设备的操作，是否会真实地在主机上产生效果。可选值为shared、slave和private</span><br><span class="line"></span><br><span class="line">shared：服务与主机共用一个Mount Namespace，会继承主机挂载点，服务挂载或卸载设备时会真实地反映到主机上</span><br><span class="line"></span><br><span class="line">slave：服务使用独立的Mount Namespace，会继承主机挂载点，但服务对挂载点的操作只在自己的Namespace内生效，不会反映到主机上</span><br><span class="line"></span><br><span class="line">private: 服务使用独立的Mount Namespace，在启动时没有任何挂载点，服务对挂载点的操作也不会反映到主机上</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;问题发现&quot;&gt;&lt;a href=&quot;#问题发现&quot; class=&quot;headerlink&quot; title=&quot;问题发现&quot;&gt;&lt;/a&gt;问题发现&lt;/h1&gt;&lt;p&gt;在node节点断电 重启后，发现有的pod节点状态不正常，之前的回收策略也都做了，就调研下是什么原因导致的&lt;/p&gt;
&lt;p&gt;p
      
    
    </summary>
    
      <category term="k8s" scheme="https://shenshengkun.github.io/categories/k8s/"/>
    
    
  </entry>
  
  <entry>
    <title>tomcat8导致文件权限访问不到</title>
    <link href="https://shenshengkun.github.io/posts/kfkd454f.html"/>
    <id>https://shenshengkun.github.io/posts/kfkd454f.html</id>
    <published>2019-07-01T03:09:10.000Z</published>
    <updated>2019-07-01T03:19:37.390Z</updated>
    
    <content type="html"><![CDATA[<h1 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h1><p>之前在tomcat 7下文件上传后访问一直没问题，现在tomcat版本升到8.5，在测试文件http上传时，发现所传文件无法通过nginx访问了：报错 403 forbidden </p><h1 id="解决"><a href="#解决" class="headerlink" title="解决"></a>解决</h1><p>看下系统的umask</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">cat /etc/profile后发现</span><br><span class="line"></span><br><span class="line">if [ $UID -gt 199 ] &amp;&amp; [ &quot;`/usr/bin/id -gn`&quot; = &quot;`/usr/bin/id -un`&quot; ]; then</span><br><span class="line">    umask 002</span><br><span class="line">else</span><br><span class="line">    umask 022</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">022是没问题的</span><br></pre></td></tr></table></figure><p>看下tomcat的catlina.sh</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">if [ -z &quot;$UMASK&quot; ]; then</span><br><span class="line">UMASK=&quot;0027&quot;</span><br><span class="line">fi</span><br><span class="line">umask $UMASK</span><br><span class="line"></span><br><span class="line">tomcat8改成0027了，把这个改成0022就好了</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;问题&quot;&gt;&lt;a href=&quot;#问题&quot; class=&quot;headerlink&quot; title=&quot;问题&quot;&gt;&lt;/a&gt;问题&lt;/h1&gt;&lt;p&gt;之前在tomcat 7下文件上传后访问一直没问题，现在tomcat版本升到8.5，在测试文件http上传时，发现所传文件无法通过nginx访
      
    
    </summary>
    
      <category term="中间件" scheme="https://shenshengkun.github.io/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6/"/>
    
    
  </entry>
  
  <entry>
    <title>Kubelet状态更新机制</title>
    <link href="https://shenshengkun.github.io/posts/dfkdaa65.html"/>
    <id>https://shenshengkun.github.io/posts/dfkdaa65.html</id>
    <published>2019-06-18T06:14:01.000Z</published>
    <updated>2019-06-20T06:18:22.061Z</updated>
    
    <content type="html"><![CDATA[<h1 id="摘要"><a href="#摘要" class="headerlink" title="摘要"></a>摘要</h1><p>当 Kubernetes 中 Node 节点出现状态异常的情况下，节点上的 Pod 会被重新调度到其他节点上去，但是有的时候我们会发现节点 Down 掉以后，Pod 并不会立即触发重新调度，这实际上就是和 Kubelet 的状态更新机制密切相关的，Kubernetes 提供了一些参数配置来触发重新调度到嗯时间，下面我们来分析下 Kubelet 状态更新的基本流程。</p><ol><li>kubelet 自身会定期更新状态到 apiserver，通过参数<code>--node-status-update-frequency</code>指定上报频率，默认是 10s 上报一次。</li><li>kube-controller-manager 会每隔<code>--node-monitor-period</code>时间去检查 kubelet 的状态，默认是 5s。</li><li>当 node 失联一段时间后，kubernetes 判定 node 为 <code>notready</code> 状态，这段时长通过<code>--node-monitor-grace-period</code>参数配置，默认 40s。</li><li>当 node 失联一段时间后，kubernetes 判定 node 为 <code>unhealthy</code> 状态，这段时长通过<code>--node-startup-grace-period</code>参数配置，默认 1m0s。</li><li>当 node 失联一段时间后，kubernetes 开始删除原 node 上的 pod，这段时长是通过<code>--pod-eviction-timeout</code>参数配置，默认 5m0s。</li></ol><blockquote><p>kube-controller-manager 和 kubelet 是异步工作的，这意味着延迟可能包括任何的网络延迟、apiserver 的延迟、etcd 延迟，一个节点上的负载引起的延迟等等。因此，如果<code>--node-status-update-frequency</code>设置为5s，那么实际上 etcd 中的数据变化会需要 6-7s，甚至更长时间。</p></blockquote><p>Kubelet在更新状态失败时，会进行<code>nodeStatusUpdateRetry</code>次重试，默认为 5 次。</p><p>Kubelet 会在函数<code>tryUpdateNodeStatus</code>中尝试进行状态更新。Kubelet 使用了 Golang 中的<code>http.Client()</code>方法，但是没有指定超时时间，因此，如果 API Server 过载时，当建立 TCP 连接时可能会出现一些故障。</p><p>因此，在<code>nodeStatusUpdateRetry</code> * <code>--node-status-update-frequency</code>时间后才会更新一次节点状态。</p><p>同时，Kubernetes 的 controller manager 将尝试每<code>--node-monitor-period</code>时间周期内检查<code>nodeStatusUpdateRetry</code>次。在<code>--node-monitor-grace-period</code>之后，会认为节点 unhealthy，然后会在<code>--pod-eviction-timeout</code>后删除 Pod。</p><p>kube proxy 有一个 watcher API，一旦 Pod 被驱逐了，kube proxy 将会通知更新节点的 iptables 规则，将 Pod 从 Service 的 Endpoints 中移除，这样就不会访问到来自故障节点的 Pod 了。</p><h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><p>对于这些参数的配置，需要根据不通的集群规模场景来进行配置。</p><h3 id="社区默认的配置"><a href="#社区默认的配置" class="headerlink" title="社区默认的配置"></a>社区默认的配置</h3><table><thead><tr><th>参数</th><th>值</th></tr></thead><tbody><tr><td>–node-status-update-frequency</td><td>10s</td></tr><tr><td>–node-monitor-period</td><td>5s</td></tr><tr><td>–node-monitor-grace-period</td><td>40s</td></tr><tr><td>–pod-eviction-timeout</td><td>5m</td></tr></tbody></table><h3 id="快速更新和快速响应"><a href="#快速更新和快速响应" class="headerlink" title="快速更新和快速响应"></a>快速更新和快速响应</h3><table><thead><tr><th>参数</th><th>值</th></tr></thead><tbody><tr><td>–node-status-update-frequency</td><td>4s</td></tr><tr><td>–node-monitor-period</td><td>2s</td></tr><tr><td>–node-monitor-grace-period</td><td>20s</td></tr><tr><td>–pod-eviction-timeout</td><td>30s</td></tr></tbody></table><p>在这种情况下，Pod 将在 50s 被驱逐，因为该节点在 20s 后被视为Down掉了，<code>--pod-eviction-timeout</code>在 30s 之后发生，但是，这种情况会给 etcd 产生很大的开销，因为每个节点都会尝试每 2s 更新一次状态。</p><p>如果环境有1000个节点，那么每分钟将有15000次节点更新操作，这可能需要大型 etcd 容器甚至是 etcd 的专用节点。</p><blockquote><p>如果我们计算尝试次数，则除法将给出5，但实际上每次尝试的 nodeStatusUpdateRetry 尝试将从3到5。 由于所有组件的延迟，尝试总次数将在15到25之间变化。</p></blockquote><h3 id="中等更新和平均响应"><a href="#中等更新和平均响应" class="headerlink" title="中等更新和平均响应"></a>中等更新和平均响应</h3><table><thead><tr><th>参数</th><th>值</th></tr></thead><tbody><tr><td>–node-status-update-frequency</td><td>20s</td></tr><tr><td>–node-monitor-period</td><td>5s</td></tr><tr><td>–node-monitor-grace-period</td><td>2m</td></tr><tr><td>–pod-eviction-timeout</td><td>1m</td></tr></tbody></table><p>这种场景下会 20s 更新一次 node 状态，controller manager 认为 node 状态不正常之前，会有 2m<em>60⁄20</em>5=30 次的 node 状态更新，Node 状态为 down 之后 1m，就会触发驱逐操作。</p><p>如果有 1000 个节点，1分钟之内就会有 60s/20s*1000=3000 次的节点状态更新操作。</p><h3 id="低更新和慢响应"><a href="#低更新和慢响应" class="headerlink" title="低更新和慢响应"></a>低更新和慢响应</h3><table><thead><tr><th>参数</th><th>值</th></tr></thead><tbody><tr><td>–node-status-update-frequency</td><td>1m</td></tr><tr><td>–node-monitor-period</td><td>5s</td></tr><tr><td>–node-monitor-grace-period</td><td>5m</td></tr><tr><td>–pod-eviction-timeout</td><td>1m</td></tr></tbody></table><p>Kubelet 将会 1m 更新一次节点的状态，在认为不健康之后会有 5m/1m*5=25 次重试更新的机会。Node为不健康的时候，1m 之后 pod开始被驱逐。</p><p>可以有不同的组合，例如快速更新和慢反应以满足特定情况。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;摘要&quot;&gt;&lt;a href=&quot;#摘要&quot; class=&quot;headerlink&quot; title=&quot;摘要&quot;&gt;&lt;/a&gt;摘要&lt;/h1&gt;&lt;p&gt;当 Kubernetes 中 Node 节点出现状态异常的情况下，节点上的 Pod 会被重新调度到其他节点上去，但是有的时候我们会发现节点 
      
    
    </summary>
    
      <category term="k8s" scheme="https://shenshengkun.github.io/categories/k8s/"/>
    
    
  </entry>
  
</feed>
